ό
[C:\Users\robin\source\repos\WindowsTimeTracker\TimeTracker\Helper\GUI\CustomComboBoxItem.cs
	namespace 	
TimeTracker
 
. 
Helper 
{ 
public		 

class		 
CustomComboBoxItem		 #
{

 
public 
string 
Name 
{ 
get  
;  !
set" %
;% &
}' (
public 
bool 

Selectable 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 
Visible 
{ 
get  #
;# $
set% (
;( )
}* +
} 
} χ
OC:\Users\robin\source\repos\WindowsTimeTracker\TimeTracker\Helper\GUI\Helper.cs
	namespace 	
TimeTracker
 
. 
Helper 
{ 
public		 

class		 
Helper		 
{

 
public 
string 
Name 
{ 
get  
;  !
set" %
;% &
}' (
public 
DateTime 
From 
{ 
get "
;" #
set$ '
;' (
}) *
public 
DateTime 
To 
{ 
get  
;  !
set" %
;% &
}' (
public 
double 
Time 
{ 
get  
;  !
set" %
;% &
}' (
} 
} ην
YC:\Users\robin\source\repos\WindowsTimeTracker\TimeTracker\Helper\GUI\MyScriptingClass.cs
	namespace 	
TimeTracker
 
. 
Helper 
{ 
[ 

ComVisible 
( 
true 
) 
] 
public 

class 
MyScriptingClass !
{ 
private 
StorageHandler 
StorageHandler -
;- .
private 
AppStateTracker 
AppStateTracker  /
;/ 0
public 
MyScriptingClass 
(  
StorageHandler  .
storageHandler/ =
,= >
AppStateTracker? N
appStateTrackerO ^
)^ _
{ 	
StorageHandler 
= 
storageHandler +
;+ ,
AppStateTracker 
= 
appStateTracker -
;- .
} 	
private   
Thread   
GetDayDataThread   '
=  ( )
null  * .
;  . /
private!! 
async!! 
Task!! 
<!! 
string!! !
>!!! "
GetDayDataAsync!!# 2
(!!2 3
string!!3 9
date!!: >
,!!> ?
int!!@ C
counter!!D K
)!!K L
{"" 	 
TaskCompletionSource##  
<##  !
string##! '
>##' (
tcs##) ,
=##- .
new##/ 2 
TaskCompletionSource##3 G
<##G H
string##H N
>##N O
(##O P
)##P Q
;##Q R
string$$ 
Json$$ 
=$$ 
$str$$ 
;$$ 
await%% 
Task%% 
.%% 
Factory%% 
.%% 
StartNew%% '
(%%' (
(%%( )
)%%) *
=>%%+ -
{&& 
GetDayDataThread''  
=''! "
Thread''# )
.'') *
CurrentThread''* 7
;''7 8
DateTime)) 
DayInQuestion)) &
=))' (
DateTime))) 1
.))1 2
Parse))2 7
())7 8
date))8 <
)))< =
.))= >
Date))> B
;))B C
DateTime** 
DayInQuestionAfter** +
=**, -
DayInQuestion**. ;
.**; <
AddDays**< C
(**C D
$num**D E
)**E F
;**F G
List-- 
<-- 
Activity-- 
>-- 
TodayActivities-- .
=--/ 0
StorageHandler--1 ?
.--? @!
GetActivitiesByLambda--@ U
(--U V
r--V W
=>--X Z
r--[ \
.--\ ]
To--] _
>=--` b
DayInQuestion--c p
&&--q s
r--t u
.--u v
From--v z
<--{ |
DayInQuestionAfter	--} 
)
-- 
;
-- ‘
if00 
(00 
AppStateTracker00 #
.00# $
CurrentActivity00$ 3
!=004 6
null007 ;
&&00< >
(00? @
DayInQuestionAfter00@ R
>00S T
DateTime00U ]
.00] ^
Now00^ a
&&00b d
DayInQuestion00e r
<00s t
DateTime00u }
.00} ~
Now	00~ 
)
00 ‚
)
00‚ ƒ
TodayActivities11 #
.11# $
Add11$ '
(11' (
AppStateTracker11( 7
.117 8
CurrentActivity118 G
)11G H
;11H I
List33 
<33 
Timeline33 
>33 
	Timelines33 (
=33) *
TodayActivities33+ :
.44 
GroupBy44 
(44 
a44 
=>44 !
a44" #
.44# $
Name44$ (
.44( )
Split44) .
(44. /
new44/ 2
string443 9
[449 :
]44: ;
{44< =
$str44> C
}44D E
,44E F
StringSplitOptions44G Y
.44Y Z
None44Z ^
)44^ _
.44_ `
First44` e
(44e f
)44f g
)44g h
.55 
Select55 
(55 
g55 
=>55  
new55! $
Timeline55% -
{66 
Label77 
=77 
g77  !
.77! "
Key77" %
,77% &
Values88 
=88  
g88! "
.88" #
Select88# )
(88) *
a88* +
=>88, .
new88/ 2
TimelineValue883 @
{99 
Start:: !
=::" #
Math::$ (
.::( )
Round::) .
(::. /
a::/ 0
.::0 1
From::1 5
>=::6 8
DayInQuestion::9 F
?::G H
a::I J
.::J K
From::K O
.::O P
Subtract::P X
(::X Y
DayInQuestion::Y f
)::f g
.::g h
TotalMinutes::h t
:::u v
$num::w x
)::x y
,::y z
Length;; "
=;;# $
Math;;% )
.;;) *
Round;;* /
(;;/ 0
(;;0 1
a;;1 2
.;;2 3
To;;3 5
==;;6 8
null;;9 =
||;;> @
a;;A B
.;;B C
To;;C E
>=;;F H
DayInQuestionAfter;;I [
?;;\ ]
(;;^ _
DayInQuestion;;_ l
==;;m o
DateTime;;p x
.;;x y
Today;;y ~
?	;; €
DateTime
;; ‰
.
;;‰ 
Now
;; 
:
;;  
DayInQuestionAfter
;; Ά
)
;;Ά £
:
;;¤ ¥
(
;;¦ §
DateTime
;;§ ―
)
;;― °
a
;;° ±
.
;;± ²
To
;;² ΄
)
;;΄ µ
.
;;µ ¶
Subtract
;;¶ Ύ
(
;;Ύ Ώ
a
;;Ώ ΐ
.
;;ΐ Α
From
;;Α Ε
>=
;;Ζ Θ
DayInQuestion
;;Ι Φ
?
;;Χ Ψ
a
;;Ω Ϊ
.
;;Ϊ Ϋ
From
;;Ϋ ί
:
;;ΰ α
DayInQuestion
;;β ο
)
;;ο π
.
;;π ρ
TotalMinutes
;;ρ ύ
)
;;ύ ώ
,
;;ώ 
Title<< !
=<<" #
a<<$ %
.<<% &
Name<<& *
.<<* +
Split<<+ 0
(<<0 1
new<<1 4
string<<5 ;
[<<; <
]<<< =
{<<> ?
$str<<@ E
}<<F G
,<<G H
StringSplitOptions<<I [
.<<[ \
None<<\ `
)<<` a
.<<a b
Last<<b f
(<<f g
)<<g h
}== 
)== 
.== 
OrderBy== "
(==" #
tv==# %
=>==& (
tv==) +
.==+ ,
Start==, 1
)==1 2
.==2 3
ToList==3 9
(==9 :
)==: ;
,==; <
Colors>> 
=>>  
g>>! "
.>>" #
Select>># )
(>>) *
a>>* +
=>>>, .
new>>/ 2
TimelineValue>>3 @
{?? 
Start@@ !
=@@" #
Math@@$ (
.@@( )
Round@@) .
(@@. /
a@@/ 0
.@@0 1
From@@1 5
>=@@6 8
DayInQuestion@@9 F
?@@G H
a@@I J
.@@J K
From@@K O
.@@O P
Subtract@@P X
(@@X Y
DayInQuestion@@Y f
)@@f g
.@@g h
TotalMinutes@@h t
:@@u v
$num@@w x
)@@x y
,@@y z
TitleAA 
=AA 
aAA  !
.AA! "
NameAA" &
}BB 
)BB 
.BB 
OrderByBB "
(BB" #
tvBB# %
=>BB& (
tvBB) +
.BB+ ,
StartBB, 1
)BB1 2
.CC 
WhereCC 
(CC 
tCC  
=>CC! #
AppStateTrackerCC$ 3
.CC3 4
ColorAssingmentsCC4 D
.CCD E
ContainsKeyCCE P
(CCP Q
tCCQ R
.CCR S
TitleCCS X
)CCX Y
)CCY Z
.DD 
SelectDD 
(DD  
tDD  !
=>DD" $
AppStateTrackerDD% 4
.DD4 5
ColorAssingmentsDD5 E
[DDE F
tDDF G
.DDG H
TitleDDH M
]DDM N
)DDN O
.EE 
ToListEE 
(EE  
)EE  !
}FF 
)FF 
.GG 
OrderByGG 
(GG 
tGG 
=>GG !
tGG" #
.GG# $
LabelGG$ )
)GG) *
.HH 
ToListHH 
(HH 
)HH 
;HH 
JsonJJ 
=JJ 
JsonConvertJJ "
.JJ" #
SerializeObjectJJ# 2
(JJ2 3
newJJ3 6
{JJ7 8
valueJJ9 >
=JJ? @
	TimelinesJJA J
,JJJ K
counterJJL S
}JJT U
)JJU V
;JJV W
}KK 
)KK 
;KK 
GetDayDataThreadMM 
=MM 
nullMM #
;MM# $
tcsNN 
.NN 
	SetResultNN 
(NN 
JsonNN 
)NN 
;NN  
returnOO 
tcsOO 
.OO 
TaskOO 
.OO 
ResultOO "
;OO" #
}PP 	
publicRR 
stringRR 

GetDayDataRR  
(RR  !
stringRR! '
dateRR( ,
,RR, -
intRR. 1
counterRR2 9
)RR9 :
{SS 	
ifTT 
(TT 
GetDayDataThreadTT  
!=TT! #
nullTT$ (
)TT( )
{UU 
GetDayDataThreadVV  
.VV  !
AbortVV! &
(VV& '
)VV' (
;VV( )
GetDayDataThreadWW  
=WW! "
nullWW# '
;WW' (
}XX 
varZZ 
taskZZ 
=ZZ 
GetDayDataAsyncZZ &
(ZZ& '
dateZZ' +
,ZZ+ ,
counterZZ- 4
)ZZ4 5
;ZZ5 6
return\\ 
task\\ 
.\\ 
Result\\ 
;\\ 
}]] 	
private__ 
Thread__ &
GetWeekBreakdownDataThread__ 1
=__2 3
null__4 8
;__8 9
privateaa 
asyncaa 
Taskaa 
<aa 
stringaa !
>aa! "%
GetWeekBreakdownDataAsyncaa# <
(aa< =
stringaa= C
dateaaD H
,aaH I
intaaJ M
daysBackaaN V
,aaV W
intaaX [
counteraa\ c
)aac d
{bb 	 
TaskCompletionSourcecc  
<cc  !
stringcc! '
>cc' (
tcscc) ,
=cc- .
newcc/ 2 
TaskCompletionSourcecc3 G
<ccG H
stringccH N
>ccN O
(ccO P
)ccP Q
;ccQ R
stringdd 
Jsondd 
=dd 
$strdd 
;dd 
awaitee 
Taskee 
.ee 
Factoryee 
.ee 
StartNewee '
(ee' (
(ee( )
)ee) *
=>ee+ -
{ff &
GetWeekBreakdownDataThreadgg *
=gg+ ,
Threadgg- 3
.gg3 4
CurrentThreadgg4 A
;ggA B
DateTimeii 
	EndPeriodii "
=ii# $
DateTimeii% -
.ii- .
Parseii. 3
(ii3 4
dateii4 8
)ii8 9
.ii9 :
Dateii: >
;ii> ?
DateTimejj 
StartPeriodjj $
=jj% &
	EndPeriodjj' 0
.jj0 1
AddDaysjj1 8
(jj8 9
-jj9 :
daysBackjj: B
)jjB C
;jjC D
Listll 
<ll 
(ll 
stringll 
,ll 

Dictionaryll (
<ll( )
stringll) /
,ll/ 0
doublell1 7
>ll7 8
)ll8 9
>ll9 :
Daysll; ?
=ll@ A
newllB E
ListllF J
<llJ K
(llK L
stringllL R
,llR S

DictionaryllT ^
<ll^ _
stringll_ e
,lle f
doublellg m
>llm n
)lln o
>llo p
(llp q
)llq r
;llr s
foreachnn 
(nn 
DateTimenn !
Daynn" %
innn& (
EachDaynn) 0
(nn0 1
StartPeriodnn1 <
,nn< =
	EndPeriodnn> G
)nnG H
)nnH I
{oo 
DateTimepp 
Startpp "
=pp# $
Daypp% (
;pp( )
DateTimeqq 
Endqq  
=qq! "
Dayqq# &
.qq& '
AddDaysqq' .
(qq. /
$numqq/ 0
)qq0 1
;qq1 2
Listss 
<ss 
Helperss 
>ss  
ActivityHelperss! /
=ss0 1
StorageHandlerss2 @
.ss@ A!
GetActivitiesByLambdassA V
(ssV W
rssW X
=>ssY [
rss\ ]
.ss] ^
Toss^ `
>=ssa c
Startssd i
&&ssj l
rssm n
.ssn o
Fromsso s
<sst u
Endssv y
)ssy z
.ssz {
Select	ss{ 
(
ss ‚
aa
ss‚ „
=>
ss… ‡
new
ss ‹
Helper
ss ’
{tt 
Nameuu 
=uu 
aauu !
.uu! "
Nameuu" &
.uu& '
Splituu' ,
(uu, -
newuu- 0
stringuu1 7
[uu7 8
]uu8 9
{uu: ;
$struu< A
}uuB C
,uuC D
StringSplitOptionsuuE W
.uuW X
NoneuuX \
)uu\ ]
.uu] ^
Firstuu^ c
(uuc d
)uud e
,uue f
Fromvv 
=vv 
aavv !
.vv! "
Fromvv" &
>vv' (
Startvv) .
?vv/ 0
aavv1 3
.vv3 4
Fromvv4 8
:vv9 :
Startvv; @
,vv@ A
Toww 
=ww 
(ww 
DateTimeww &
)ww& '
aaww' )
.ww) *
Toww* ,
>ww- .
Endww/ 2
?ww3 4
Endww5 8
:ww9 :
(ww; <
DateTimeww< D
)wwD E
aawwE G
.wwG H
TowwH J
}xx 
)xx 
.xx 
ToListxx 
(xx 
)xx 
;xx  
if{{ 
({{ 
AppStateTracker{{ '
.{{' (
CurrentActivity{{( 7
!={{8 :
null{{; ?
&&{{@ B
StartPeriod{{C N
=={{O Q
DateTime{{R Z
.{{Z [
Today{{[ `
){{` a
ActivityHelper|| &
.||& '
Add||' *
(||* +
new||+ .
Helper||/ 5
{}} 
Name~~  
=~~! "
AppStateTracker~~# 2
.~~2 3
CurrentActivity~~3 B
.~~B C
Name~~C G
.~~G H
Split~~H M
(~~M N
new~~N Q
string~~R X
[~~X Y
]~~Y Z
{~~[ \
$str~~] b
}~~c d
,~~d e
StringSplitOptions~~f x
.~~x y
None~~y }
)~~} ~
.~~~ 
First	~~ „
(
~~„ …
)
~~… †
,
~~† ‡
From  
=! "
AppStateTracker# 2
.2 3
CurrentActivity3 B
.B C
FromC G
>H I
StartJ O
?P Q
AppStateTrackerR a
.a b
CurrentActivityb q
.q r
Fromr v
:w x
Starty ~
,~ 
To
€€ 
=
€€  
DateTime
€€! )
.
€€) *
Now
€€* -
}
 
)
 
;
 
foreach
„„ 
(
„„ 
Helper
„„ #
h
„„$ %
in
„„& (
ActivityHelper
„„) 7
)
„„7 8
{
…… 
h
†† 
.
†† 
Time
†† 
=
††  
Math
††! %
.
††% &
Max
††& )
(
††) *
Math
††* .
.
††. /
Round
††/ 4
(
††4 5
(
††5 6
h
††6 7
.
††7 8
To
††8 :
-
††; <
h
††= >
.
††> ?
From
††? C
)
††C D
.
††D E

TotalHours
††E O
,
††O P
$num
††Q R
)
††R S
,
††S T
$num
††U V
)
††V W
;
††W X
}
‡‡ 

Dictionary
‰‰ 
<
‰‰ 
string
‰‰ %
,
‰‰% &
double
‰‰' -
>
‰‰- .
ActivityDict
‰‰/ ;
=
‰‰< =
new
‰‰> A

Dictionary
‰‰B L
<
‰‰L M
string
‰‰M S
,
‰‰S T
double
‰‰U [
>
‰‰[ \
(
‰‰\ ]
)
‰‰] ^
;
‰‰^ _
ActivityHelper
‹‹ "
.
 
GroupBy
  
(
  !
ah
! #
=>
$ &
ah
' )
.
) *
Name
* .
)
. /
.
 
ToList
 
(
  
)
  !
.
 
ForEach
  
(
  !
g
! "
=>
# %
{
 
ActivityDict
 (
.
( )
Add
) ,
(
, -
g
- .
.
. /
Key
/ 2
,
2 3
g
4 5
.
5 6
Sum
6 9
(
9 :
h
: ;
=>
< >
h
? @
.
@ A
Time
A E
)
E F
)
F G
;
G H
}
‘‘ 
)
‘‘ 
;
‘‘ 
Days
““ 
.
““ 
Add
““ 
(
““ 
(
““ 
Day
““ !
.
““! "
	DayOfWeek
““" +
.
““+ ,
ToString
““, 4
(
““4 5
)
““5 6
.
““6 7
	Substring
““7 @
(
““@ A
$num
““A B
,
““B C
$num
““D E
)
““E F
,
““F G
ActivityDict
““H T
)
““T U
)
““U V
;
““V W
}
”” 
List
—— 
<
—— 
Bardata
—— 
>
—— 
Bardata
—— %
=
——& '
Days
——( ,
.
——, -
Select
——- 3
(
——3 4
d
——4 5
=>
——6 8
new
——9 <
Bardata
——= D
{
 
Label
™™ 
=
™™ 
d
™™ 
.
™™ 
Item1
™™ #
,
™™# $
Datasets
 
=
 
d
  
.
  !
Item2
! &
.
›› 
Where
›› 
(
›› 
h
›› 
=>
›› 
AppStateTracker
››  /
.
››/ 0
ColorAssingments
››0 @
.
››@ A
ContainsKey
››A L
(
››L M
h
››M N
.
››N O
Key
››O R
)
››R S
)
››S T
.
 
Select
 
(
 
h
 
=>
  
new
! $
Dataset
% ,
{
 
Title
 
=
 
h
  !
.
! "
Key
" %
,
% &
Value
 
=
 
h
  !
.
! "
Value
" '
,
' (
Color
   
=
   
AppStateTracker
    /
.
  / 0
ColorAssingments
  0 @
[
  @ A
h
  A B
.
  B C
Key
  C F
]
  F G
}
΅΅ 
)
΅΅ 
.
΅΅ 
OrderBy
΅΅ 
(
΅΅ 
dd
΅΅ !
=>
΅΅" $
dd
΅΅% '
.
΅΅' (
Title
΅΅( -
)
΅΅- .
.
΅΅. /
ToList
΅΅/ 5
(
΅΅5 6
)
΅΅6 7
}
ΆΆ 
)
ΆΆ 
.
ΆΆ 
ToList
ΆΆ 
(
ΆΆ 
)
ΆΆ 
;
ΆΆ 
Json
¤¤ 
=
¤¤ 
JsonConvert
¤¤ "
.
¤¤" #
SerializeObject
¤¤# 2
(
¤¤2 3
new
¤¤3 6
{
¤¤7 8
value
¤¤9 >
=
¤¤? @
Bardata
¤¤A H
,
¤¤H I
counter
¤¤J Q
}
¤¤R S
)
¤¤S T
;
¤¤T U
}
¥¥ 
)
¥¥ 
;
¥¥ (
GetWeekBreakdownDataThread
§§ &
=
§§' (
null
§§) -
;
§§- .
tcs
¨¨ 
.
¨¨ 
	SetResult
¨¨ 
(
¨¨ 
Json
¨¨ 
)
¨¨ 
;
¨¨  
return
©© 
tcs
©© 
.
©© 
Task
©© 
.
©© 
Result
©© "
;
©©" #
}
 	
public
¬¬ 
string
¬¬ "
GetWeekBreakdownData
¬¬ *
(
¬¬* +
string
¬¬+ 1
date
¬¬2 6
,
¬¬6 7
int
¬¬8 ;
daysBack
¬¬< D
,
¬¬D E
int
¬¬F I
counter
¬¬J Q
)
¬¬Q R
{
­­ 	
if
®® 
(
®® (
GetWeekBreakdownDataThread
®® *
!=
®®+ -
null
®®. 2
)
®®2 3
{
―― (
GetWeekBreakdownDataThread
°° *
.
°°* +
Abort
°°+ 0
(
°°0 1
)
°°1 2
;
°°2 3(
GetWeekBreakdownDataThread
±± *
=
±±+ ,
null
±±- 1
;
±±1 2
}
²² 
var
΄΄ 
task
΄΄ 
=
΄΄ '
GetWeekBreakdownDataAsync
΄΄ 0
(
΄΄0 1
date
΄΄1 5
,
΄΄5 6
daysBack
΄΄7 ?
,
΄΄? @
counter
΄΄A H
)
΄΄H I
;
΄΄I J
return
¶¶ 
task
¶¶ 
.
¶¶ 
Result
¶¶ 
;
¶¶ 
}
·· 	
private
ΉΉ 
Thread
ΉΉ "
GetWeekSumDataThread
ΉΉ +
=
ΉΉ, -
null
ΉΉ. 2
;
ΉΉ2 3
private
»» 
async
»» 
Task
»» 
<
»» 
string
»» !
>
»»! "!
GetWeekSumDataAsync
»»# 6
(
»»6 7
string
»»7 =
date
»»> B
,
»»B C
int
»»D G
daysBack
»»H P
,
»»P Q
int
»»R U
counter
»»V ]
)
»»] ^
{
ΌΌ 	"
TaskCompletionSource
½½  
<
½½  !
string
½½! '
>
½½' (
tcs
½½) ,
=
½½- .
new
½½/ 2"
TaskCompletionSource
½½3 G
<
½½G H
string
½½H N
>
½½N O
(
½½O P
)
½½P Q
;
½½Q R
string
ΎΎ 
Json
ΎΎ 
=
ΎΎ 
$str
ΎΎ 
;
ΎΎ 
await
ΏΏ 
Task
ΏΏ 
.
ΏΏ 
Factory
ΏΏ 
.
ΏΏ 
StartNew
ΏΏ '
(
ΏΏ' (
(
ΏΏ( )
)
ΏΏ) *
=>
ΏΏ+ -
{
ΐΐ "
GetWeekSumDataThread
ΑΑ $
=
ΑΑ% &
Thread
ΑΑ' -
.
ΑΑ- .
CurrentThread
ΑΑ. ;
;
ΑΑ; <
DateTime
ΒΒ 
Date
ΒΒ 
=
ΒΒ 
DateTime
ΒΒ  (
.
ΒΒ( )
Parse
ΒΒ) .
(
ΒΒ. /
date
ΒΒ/ 3
)
ΒΒ3 4
;
ΒΒ4 5
int
ΓΓ 
	DayOfWeek
ΓΓ 
=
ΓΓ 
(
ΓΓ  !
int
ΓΓ! $
)
ΓΓ$ %
Date
ΓΓ% )
.
ΓΓ) *
	DayOfWeek
ΓΓ* 3
;
ΓΓ3 4
List
ΔΔ 
<
ΔΔ 
int
ΔΔ 
>
ΔΔ 
Mapping
ΔΔ !
=
ΔΔ" #
new
ΔΔ$ '
List
ΔΔ( ,
<
ΔΔ, -
int
ΔΔ- 0
>
ΔΔ0 1
{
ΔΔ2 3
$num
ΔΔ4 5
,
ΔΔ5 6
$num
ΔΔ7 8
,
ΔΔ8 9
$num
ΔΔ: ;
,
ΔΔ; <
$num
ΔΔ= >
,
ΔΔ> ?
$num
ΔΔ@ A
,
ΔΔA B
$num
ΔΔC D
,
ΔΔD E
$num
ΔΔF G
}
ΔΔH I
;
ΔΔI J
DateTime
ΕΕ 
	EndPeriod
ΕΕ "
=
ΕΕ# $
Date
ΕΕ% )
.
ΕΕ) *
AddDays
ΕΕ* 1
(
ΕΕ1 2
$num
ΕΕ2 3
-
ΕΕ4 5
Mapping
ΕΕ6 =
[
ΕΕ= >
	DayOfWeek
ΕΕ> G
]
ΕΕG H
)
ΕΕH I
;
ΕΕI J
DateTime
ΖΖ 
StartPeriod
ΖΖ $
=
ΖΖ% &
Date
ΖΖ' +
.
ΖΖ+ ,
AddDays
ΖΖ, 3
(
ΖΖ3 4
-
ΖΖ4 5
Mapping
ΖΖ5 <
[
ΖΖ< =
	DayOfWeek
ΖΖ= F
]
ΖΖF G
)
ΖΖG H
;
ΖΖH I
List
ΘΘ 
<
ΘΘ 
Helper
ΘΘ 
>
ΘΘ 
ActivityHelper
ΘΘ +
=
ΘΘ, -
StorageHandler
ΘΘ. <
.
ΘΘ< =#
GetActivitiesByLambda
ΘΘ= R
(
ΘΘR S
r
ΘΘS T
=>
ΘΘU W
r
ΘΘX Y
.
ΘΘY Z
To
ΘΘZ \
>=
ΘΘ] _
StartPeriod
ΘΘ` k
&&
ΘΘl n
r
ΘΘo p
.
ΘΘp q
From
ΘΘq u
<=
ΘΘv x
	EndPeriodΘΘy ‚
)ΘΘ‚ ƒ
.ΘΘƒ „
SelectΘΘ„ 
(ΘΘ ‹
aaΘΘ‹ 
=>ΘΘ 
newΘΘ‘ ”
HelperΘΘ• ›
{
ΙΙ 
Name
ΚΚ 
=
ΚΚ 
aa
ΚΚ 
.
ΚΚ 
Name
ΚΚ "
,
ΚΚ" #
From
ΛΛ 
=
ΛΛ 
aa
ΛΛ 
.
ΛΛ 
From
ΛΛ "
>
ΛΛ# $
StartPeriod
ΛΛ% 0
?
ΛΛ1 2
aa
ΛΛ3 5
.
ΛΛ5 6
From
ΛΛ6 :
:
ΛΛ; <
StartPeriod
ΛΛ= H
,
ΛΛH I
To
ΜΜ 
=
ΜΜ 
(
ΜΜ 
DateTime
ΜΜ "
)
ΜΜ" #
aa
ΜΜ# %
.
ΜΜ% &
To
ΜΜ& (
>
ΜΜ) *
	EndPeriod
ΜΜ+ 4
?
ΜΜ5 6
	EndPeriod
ΜΜ7 @
:
ΜΜA B
(
ΜΜC D
DateTime
ΜΜD L
)
ΜΜL M
aa
ΜΜM O
.
ΜΜO P
To
ΜΜP R
}
ΝΝ 
)
ΝΝ 
.
ΝΝ 
ToList
ΝΝ 
(
ΝΝ 
)
ΝΝ 
;
ΝΝ 
if
ΠΠ 
(
ΠΠ 
AppStateTracker
ΠΠ #
.
ΠΠ# $
CurrentActivity
ΠΠ$ 3
!=
ΠΠ4 6
null
ΠΠ7 ;
&&
ΠΠ< >
	EndPeriod
ΠΠ? H
==
ΠΠI K
DateTime
ΠΠL T
.
ΠΠT U
Today
ΠΠU Z
)
ΠΠZ [
ActivityHelper
ΡΡ "
.
ΡΡ" #
Add
ΡΡ# &
(
ΡΡ& '
new
ΡΡ' *
Helper
ΡΡ+ 1
{
 
Name
ΣΣ 
=
ΣΣ 
AppStateTracker
ΣΣ .
.
ΣΣ. /
CurrentActivity
ΣΣ/ >
.
ΣΣ> ?
Name
ΣΣ? C
,
ΣΣC D
From
ΤΤ 
=
ΤΤ 
AppStateTracker
ΤΤ .
.
ΤΤ. /
CurrentActivity
ΤΤ/ >
.
ΤΤ> ?
From
ΤΤ? C
>
ΤΤD E
StartPeriod
ΤΤF Q
?
ΤΤR S
AppStateTracker
ΤΤT c
.
ΤΤc d
CurrentActivity
ΤΤd s
.
ΤΤs t
From
ΤΤt x
:
ΤΤy z
StartPeriodΤΤ{ †
,ΤΤ† ‡
To
ΥΥ 
=
ΥΥ 
DateTime
ΥΥ %
.
ΥΥ% &
Now
ΥΥ& )
}
ΦΦ 
)
ΦΦ 
;
ΦΦ 
foreach
ΩΩ 
(
ΩΩ 
Helper
ΩΩ 
h
ΩΩ  !
in
ΩΩ" $
ActivityHelper
ΩΩ% 3
)
ΩΩ3 4
{
ΪΪ 
h
ΫΫ 
.
ΫΫ 
Time
ΫΫ 
=
ΫΫ 
Math
ΫΫ !
.
ΫΫ! "
Max
ΫΫ" %
(
ΫΫ% &
Math
ΫΫ& *
.
ΫΫ* +
Round
ΫΫ+ 0
(
ΫΫ0 1
(
ΫΫ1 2
h
ΫΫ2 3
.
ΫΫ3 4
To
ΫΫ4 6
-
ΫΫ7 8
h
ΫΫ9 :
.
ΫΫ: ;
From
ΫΫ; ?
)
ΫΫ? @
.
ΫΫ@ A

TotalHours
ΫΫA K
,
ΫΫK L
$num
ΫΫM N
)
ΫΫN O
,
ΫΫO P
$num
ΫΫQ R
)
ΫΫR S
;
ΫΫS T
}
άά 

Dictionary
ήή 
<
ήή 
string
ήή !
,
ήή! "

Dictionary
ήή# -
<
ήή- .
string
ήή. 4
,
ήή4 5
double
ήή6 <
>
ήή< =
>
ήή= >
Grouping
ήή? G
=
ήήH I
ActivityHelper
ήήJ X
.
ίί 
GroupBy
ίί 
(
ίί 
ah
ίί 
=>
ίί  "
ah
ίί# %
.
ίί% &
Name
ίί& *
.
ίί* +
Split
ίί+ 0
(
ίί0 1
new
ίί1 4
string
ίί5 ;
[
ίί; <
]
ίί< =
{
ίί> ?
$str
ίί@ E
}
ίίF G
,
ίίG H 
StringSplitOptions
ίίI [
.
ίί[ \
None
ίί\ `
)
ίί` a
.
ίίa b
First
ίίb g
(
ίίg h
)
ίίh i
)
ίίi j
.
ΰΰ 
ToDictionary
ΰΰ !
(
ΰΰ! "
g
ΰΰ" #
=>
ΰΰ$ &
g
ΰΰ' (
.
ΰΰ( )
Key
ΰΰ) ,
,
ΰΰ, -
g
ΰΰ. /
=>
ΰΰ0 2
g
ΰΰ3 4
.
αα 
GroupBy
αα  
(
αα  !
a
αα! "
=>
αα# %
a
αα& '
.
αα' (
Name
αα( ,
.
αα, -
Split
αα- 2
(
αα2 3
new
αα3 6
string
αα7 =
[
αα= >
]
αα> ?
{
αα@ A
$str
ααB G
}
ααH I
,
ααI J 
StringSplitOptions
ααK ]
.
αα] ^
None
αα^ b
)
ααb c
.
ααc d
Last
ααd h
(
ααh i
)
ααi j
)
ααj k
.
ββ 
ToDictionary
ββ %
(
ββ% &
gg
ββ& (
=>
ββ) +
gg
ββ, .
.
ββ. /
Key
ββ/ 2
,
ββ2 3
gg
ββ4 6
=>
ββ7 9
gg
ββ: <
.
ββ< =
Sum
ββ= @
(
ββ@ A
h
ββA B
=>
ββC E
h
ββF G
.
ββG H
Time
ββH L
)
ββL M
)
ββM N
)
γγ 
;
γγ 
List
ζζ 
<
ζζ 
Bardata
ζζ 
>
ζζ 
Bardata
ζζ %
=
ζζ& '
Grouping
ζζ( 0
.
ηη 
OrderBy
ηη 
(
ηη 
g
ηη 
=>
ηη !
g
ηη" #
.
ηη# $
Key
ηη$ '
)
ηη' (
.
θθ 
Select
θθ 
(
θθ 
g
θθ 
=>
θθ  
new
θθ! $
Bardata
θθ% ,
{
ιι 
Label
κκ 
=
κκ 
g
κκ  !
.
κκ! "
Key
κκ" %
,
κκ% &
Datasets
λλ  
=
λλ! "
g
λλ# $
.
λλ$ %
Value
λλ% *
.
μμ 
Where
μμ 
(
μμ 
d
μμ  
=>
μμ! #
AppStateTracker
μμ$ 3
.
μμ3 4
ColorAssingments
μμ4 D
.
μμD E
ContainsKey
μμE P
(
μμP Q
g
μμQ R
.
μμR S
Key
μμS V
+
μμW X
$str
μμY ^
+
μμ_ `
d
μμa b
.
μμb c
Key
μμc f
)
μμf g
)
μμg h
.
νν 
Select
νν 
(
νν  
d
νν  !
=>
νν" $
new
νν% (
Dataset
νν) 0
{
ξξ 
Title
οο !
=
οο" #
d
οο$ %
.
οο% &
Key
οο& )
,
οο) *
Value
ππ !
=
ππ" #
d
ππ$ %
.
ππ% &
Value
ππ& +
,
ππ+ ,
Color
ρρ !
=
ρρ" #
AppStateTracker
ρρ$ 3
.
ρρ3 4
ColorAssingments
ρρ4 D
[
ρρD E
g
ρρE F
.
ρρF G
Key
ρρG J
+
ρρK L
$str
ρρM R
+
ρρS T
d
ρρU V
.
ρρV W
Key
ρρW Z
]
ρρZ [
}
ςς 
)
ςς 
.
ςς 
OrderBy
ςς "
(
ςς" #
d
ςς# $
=>
ςς% '
d
ςς( )
.
ςς) *
Title
ςς* /
)
ςς/ 0
.
ςς0 1
ToList
ςς1 7
(
ςς7 8
)
ςς8 9
}
σσ 
)
σσ 
.
σσ 
OrderBy
σσ 
(
σσ 
d
σσ  
=>
σσ! #
d
σσ$ %
.
σσ% &
Label
σσ& +
)
σσ+ ,
.
σσ, -
ToList
σσ- 3
(
σσ3 4
)
σσ4 5
;
σσ5 6
Json
υυ 
=
υυ 
JsonConvert
υυ "
.
υυ" #
SerializeObject
υυ# 2
(
υυ2 3
new
υυ3 6
{
υυ7 8
value
υυ9 >
=
υυ? @
Bardata
υυA H
,
υυH I
counter
υυJ Q
}
υυR S
)
υυS T
;
υυT U
}
φφ 
)
φφ 
;
φφ "
GetWeekSumDataThread
ψψ  
=
ψψ! "
null
ψψ# '
;
ψψ' (
tcs
ωω 
.
ωω 
	SetResult
ωω 
(
ωω 
Json
ωω 
)
ωω 
;
ωω  
return
ϊϊ 
tcs
ϊϊ 
.
ϊϊ 
Task
ϊϊ 
.
ϊϊ 
Result
ϊϊ "
;
ϊϊ" #
}
ϋϋ 	
public
ύύ 
string
ύύ 
GetWeekSumData
ύύ $
(
ύύ$ %
string
ύύ% +
date
ύύ, 0
,
ύύ0 1
int
ύύ2 5
daysBack
ύύ6 >
,
ύύ> ?
int
ύύ@ C
counter
ύύD K
)
ύύK L
{
ώώ 	
if
 
(
 "
GetWeekSumDataThread
 $
!=
% '
null
( ,
)
, -
{
€€ "
GetWeekSumDataThread
 $
.
$ %
Abort
% *
(
* +
)
+ ,
;
, -"
GetWeekSumDataThread
‚‚ $
=
‚‚% &
null
‚‚' +
;
‚‚+ ,
}
ƒƒ 
var
…… 
task
…… 
=
…… !
GetWeekSumDataAsync
…… *
(
……* +
date
……+ /
,
……/ 0
daysBack
……1 9
,
……9 :
counter
……; B
)
……B C
;
……C D
return
‡‡ 
task
‡‡ 
.
‡‡ 
Result
‡‡ 
;
‡‡ 
}
 	
public
 
string
 
GetSettings
 !
(
! "
)
" #
{
‹‹ 	
List
 
<
 
System
 
.
 
Windows
 
.
  
Input
  %
.
% &
Key
& )
>
) *
Hotkeys
+ 2
=
3 4

Properties
5 ?
.
? @
Settings
@ H
.
H I
Default
I P
.
P Q
Hotkeys
Q X
??
Y [
new
\ _
List
` d
<
d e
System
e k
.
k l
Windows
l s
.
s t
Input
t y
.
y z
Key
z }
>
} ~
(
~ 
) €
;€ 
Models
 
.
 
Settings
 
Settings
 $
=
% &
new
' *
Models
+ 1
.
1 2
Settings
2 :
{
 %
TimeNotificationVisible
 '
=
( )

Properties
* 4
.
4 5
Settings
5 =
.
= >
Default
> E
.
E F%
TimeNotificationVisible
F ]
,
] ^#
TimeBeforeAskingAgain
 %
=
& '

Properties
( 2
.
2 3
Settings
3 ;
.
; <
Default
< C
.
C D#
TimeBeforeAskingAgain
D Y
,
Y Z"
TimeSinceAppLastUsed
‘‘ $
=
‘‘% &

Properties
‘‘' 1
.
‘‘1 2
Settings
‘‘2 :
.
‘‘: ;
Default
‘‘; B
.
‘‘B C"
TimeSinceAppLastUsed
‘‘C W
,
‘‘W X
OfflineTracking
’’ 
=
’’  !

Properties
’’" ,
.
’’, -
Settings
’’- 5
.
’’5 6
Default
’’6 =
.
’’= >
OfflineTracking
’’> M
,
’’M N
HotkeyDisabled
““ 
=
““  

Properties
““! +
.
““+ ,
Settings
““, 4
.
““4 5
Default
““5 <
.
““< =
HotkeyDisabled
““= K
,
““K L
Hotkeys
”” 
=
”” 
Hotkeys
”” !
.
””! "
Select
””" (
(
””( )
k
””) *
=>
””+ -

KeyInterop
””. 8
.
””8 9
VirtualKeyFromKey
””9 J
(
””J K
k
””K L
)
””L M
)
””M N
.
””N O
ToList
””O U
(
””U V
)
””V W
,
””W X#
PlayNotificationSound
•• %
=
••& '

Properties
••( 2
.
••2 3
Settings
••3 ;
.
••; <
Default
••< C
.
••C D#
PlayNotificationSound
••D Y
}
–– 
;
–– 
string
 
Json
 
=
 
JsonConvert
 %
.
% &
SerializeObject
& 5
(
5 6
Settings
6 >
)
> ?
;
? @
return
›› 
Json
›› 
;
›› 
}
 	
public
 
string
 &
SetPlayNotificationSound
 .
(
. /
bool
/ 3#
playNotificationSound
4 I
)
I J
{
 	

Properties
   
.
   
Settings
   
.
    
Default
    '
.
  ' (#
PlayNotificationSound
  ( =
=
  > ?#
playNotificationSound
  @ U
;
  U V

Properties
΅΅ 
.
΅΅ 
Settings
΅΅ 
.
΅΅  
Default
΅΅  '
.
΅΅' (
Save
΅΅( ,
(
΅΅, -
)
΅΅- .
;
΅΅. /
return
££ 
JsonConvert
££ 
.
££ 
SerializeObject
££ .
(
££. /

Properties
££/ 9
.
££9 :
Settings
££: B
.
££B C
Default
££C J
.
££J K#
PlayNotificationSound
££K `
)
££` a
;
££a b
}
¤¤ 	
public
¦¦ 
string
¦¦ 
SetHotkeyDisabled
¦¦ '
(
¦¦' (
bool
¦¦( ,
hotkeyDisabled
¦¦- ;
)
¦¦; <
{
§§ 	

Properties
¨¨ 
.
¨¨ 
Settings
¨¨ 
.
¨¨  
Default
¨¨  '
.
¨¨' (
HotkeyDisabled
¨¨( 6
=
¨¨7 8
hotkeyDisabled
¨¨9 G
;
¨¨G H

Properties
©© 
.
©© 
Settings
©© 
.
©©  
Default
©©  '
.
©©' (
Save
©©( ,
(
©©, -
)
©©- .
;
©©. /
return
«« 
JsonConvert
«« 
.
«« 
SerializeObject
«« .
(
««. /

Properties
««/ 9
.
««9 :
Settings
««: B
.
««B C
Default
««C J
.
««J K
HotkeyDisabled
««K Y
)
««Y Z
;
««Z [
}
¬¬ 	
public
®® 
string
®®  
SetOfflineTracking
®® (
(
®®( )
bool
®®) -
offlineTracking
®®. =
)
®®= >
{
―― 	

Properties
°° 
.
°° 
Settings
°° 
.
°°  
Default
°°  '
.
°°' (
OfflineTracking
°°( 7
=
°°8 9
offlineTracking
°°: I
;
°°I J

Properties
±± 
.
±± 
Settings
±± 
.
±±  
Default
±±  '
.
±±' (
Save
±±( ,
(
±±, -
)
±±- .
;
±±. /
return
³³ 
JsonConvert
³³ 
.
³³ 
SerializeObject
³³ .
(
³³. /

Properties
³³/ 9
.
³³9 :
Settings
³³: B
.
³³B C
Default
³³C J
.
³³J K
OfflineTracking
³³K Z
)
³³Z [
;
³³[ \
}
΄΄ 	
public
¶¶ 
string
¶¶ (
SetTimeNotificationVisible
¶¶ 0
(
¶¶0 1
string
¶¶1 7%
timeNotificationVisible
¶¶8 O
)
¶¶O P
{
·· 	

Properties
ΈΈ 
.
ΈΈ 
Settings
ΈΈ 
.
ΈΈ  
Default
ΈΈ  '
.
ΈΈ' (%
TimeNotificationVisible
ΈΈ( ?
=
ΈΈ@ A
Int32
ΈΈB G
.
ΈΈG H
Parse
ΈΈH M
(
ΈΈM N%
timeNotificationVisible
ΈΈN e
)
ΈΈe f
;
ΈΈf g

Properties
ΉΉ 
.
ΉΉ 
Settings
ΉΉ 
.
ΉΉ  
Default
ΉΉ  '
.
ΉΉ' (
Save
ΉΉ( ,
(
ΉΉ, -
)
ΉΉ- .
;
ΉΉ. /
return
»» 
JsonConvert
»» 
.
»» 
SerializeObject
»» .
(
»». /

Properties
»»/ 9
.
»»9 :
Settings
»»: B
.
»»B C
Default
»»C J
.
»»J K%
TimeNotificationVisible
»»K b
)
»»b c
;
»»c d
}
ΌΌ 	
public
ΎΎ 
string
ΎΎ &
SetTimeBeforeAskingAgain
ΎΎ .
(
ΎΎ. /
string
ΎΎ/ 5#
timeBeforeAskingAgain
ΎΎ6 K
)
ΎΎK L
{
ΏΏ 	

Properties
ΐΐ 
.
ΐΐ 
Settings
ΐΐ 
.
ΐΐ  
Default
ΐΐ  '
.
ΐΐ' (#
TimeBeforeAskingAgain
ΐΐ( =
=
ΐΐ> ?
Int32
ΐΐ@ E
.
ΐΐE F
Parse
ΐΐF K
(
ΐΐK L#
timeBeforeAskingAgain
ΐΐL a
)
ΐΐa b
;
ΐΐb c

Properties
ΑΑ 
.
ΑΑ 
Settings
ΑΑ 
.
ΑΑ  
Default
ΑΑ  '
.
ΑΑ' (
Save
ΑΑ( ,
(
ΑΑ, -
)
ΑΑ- .
;
ΑΑ. /
return
ΓΓ 
JsonConvert
ΓΓ 
.
ΓΓ 
SerializeObject
ΓΓ .
(
ΓΓ. /

Properties
ΓΓ/ 9
.
ΓΓ9 :
Settings
ΓΓ: B
.
ΓΓB C
Default
ΓΓC J
.
ΓΓJ K#
TimeBeforeAskingAgain
ΓΓK `
)
ΓΓ` a
;
ΓΓa b
}
ΔΔ 	
public
ΖΖ 
string
ΖΖ %
SetTimeSinceAppLastUsed
ΖΖ -
(
ΖΖ- .
string
ΖΖ. 4"
timeSinceAppLastUsed
ΖΖ5 I
)
ΖΖI J
{
ΗΗ 	

Properties
ΘΘ 
.
ΘΘ 
Settings
ΘΘ 
.
ΘΘ  
Default
ΘΘ  '
.
ΘΘ' ("
TimeSinceAppLastUsed
ΘΘ( <
=
ΘΘ= >
Int32
ΘΘ? D
.
ΘΘD E
Parse
ΘΘE J
(
ΘΘJ K"
timeSinceAppLastUsed
ΘΘK _
)
ΘΘ_ `
;
ΘΘ` a

Properties
ΙΙ 
.
ΙΙ 
Settings
ΙΙ 
.
ΙΙ  
Default
ΙΙ  '
.
ΙΙ' (
Save
ΙΙ( ,
(
ΙΙ, -
)
ΙΙ- .
;
ΙΙ. /
return
ΛΛ 
JsonConvert
ΛΛ 
.
ΛΛ 
SerializeObject
ΛΛ .
(
ΛΛ. /

Properties
ΛΛ/ 9
.
ΛΛ9 :
Settings
ΛΛ: B
.
ΛΛB C
Default
ΛΛC J
.
ΛΛJ K"
TimeSinceAppLastUsed
ΛΛK _
)
ΛΛ_ `
;
ΛΛ` a
}
ΜΜ 	
public
ΞΞ 
string
ΞΞ 

SetHotkeys
ΞΞ  
(
ΞΞ  !
List
ΞΞ! %
<
ΞΞ% &
Object
ΞΞ& ,
>
ΞΞ, -
hotkeys
ΞΞ. 5
)
ΞΞ5 6
{
ΟΟ 	

Properties
ΠΠ 
.
ΠΠ 
Settings
ΠΠ 
.
ΠΠ  
Default
ΠΠ  '
.
ΠΠ' (
Hotkeys
ΠΠ( /
=
ΠΠ0 1
hotkeys
ΠΠ2 9
.
ΠΠ9 :
Cast
ΠΠ: >
<
ΠΠ> ?
int
ΠΠ? B
>
ΠΠB C
(
ΠΠC D
)
ΠΠD E
.
ΠΠE F
Select
ΠΠF L
(
ΠΠL M
k
ΠΠM N
=>
ΠΠO Q

KeyInterop
ΠΠR \
.
ΠΠ\ ]
KeyFromVirtualKey
ΠΠ] n
(
ΠΠn o
k
ΠΠo p
)
ΠΠp q
)
ΠΠq r
.
ΠΠr s
ToList
ΠΠs y
(
ΠΠy z
)
ΠΠz {
;
ΠΠ{ |

Properties
ΡΡ 
.
ΡΡ 
Settings
ΡΡ 
.
ΡΡ  
Default
ΡΡ  '
.
ΡΡ' (
Save
ΡΡ( ,
(
ΡΡ, -
)
ΡΡ- .
;
ΡΡ. /
return
ΣΣ 
JsonConvert
ΣΣ 
.
ΣΣ 
SerializeObject
ΣΣ .
(
ΣΣ. /

Properties
ΣΣ/ 9
.
ΣΣ9 :
Settings
ΣΣ: B
.
ΣΣB C
Default
ΣΣC J
.
ΣΣJ K
Hotkeys
ΣΣK R
.
ΣΣR S
Select
ΣΣS Y
(
ΣΣY Z
k
ΣΣZ [
=>
ΣΣ\ ^

KeyInterop
ΣΣ_ i
.
ΣΣi j
VirtualKeyFromKey
ΣΣj {
(
ΣΣ{ |
k
ΣΣ| }
)
ΣΣ} ~
)
ΣΣ~ 
.ΣΣ €
ToListΣΣ€ †
(ΣΣ† ‡
)ΣΣ‡ 
)ΣΣ ‰
;ΣΣ‰ 
}
ΤΤ 	
public
ΦΦ 
string
ΦΦ !
GetTrackingSettings
ΦΦ )
(
ΦΦ) *
)
ΦΦ* +
{
ΧΧ 	
Models
ΨΨ 
.
ΨΨ 
TrackingSettings
ΨΨ #
Settings
ΨΨ$ ,
=
ΨΨ- .
new
ΨΨ/ 2
TrackingSettings
ΨΨ3 C
{
ΩΩ 
	Blacklist
ΪΪ 
=
ΪΪ 

Properties
ΪΪ &
.
ΪΪ& '
Settings
ΪΪ' /
.
ΪΪ/ 0
Default
ΪΪ0 7
.
ΪΪ7 8
	Blacklist
ΪΪ8 A
.
ΪΪA B
Cast
ΪΪB F
<
ΪΪF G
string
ΪΪG M
>
ΪΪM N
(
ΪΪN O
)
ΪΪO P
.
ΪΪP Q
ToList
ΪΪQ W
(
ΪΪW X
)
ΪΪX Y
}
ΫΫ 
;
ΫΫ 
string
έέ 
Json
έέ 
=
έέ 
JsonConvert
έέ %
.
έέ% &
SerializeObject
έέ& 5
(
έέ5 6
Settings
έέ6 >
)
έέ> ?
;
έέ? @
return
ΰΰ 
Json
ΰΰ 
;
ΰΰ 
}
αα 	
public
γγ 
string
γγ 
SetBlacklist
γγ "
(
γγ" #
List
γγ# '
<
γγ' (
Object
γγ( .
>
γγ. /
	blacklist
γγ0 9
)
γγ9 :
{
δδ 	
StringCollection
εε 
stringCollection
εε -
=
εε. /
new
εε0 3
StringCollection
εε4 D
(
εεD E
)
εεE F
;
εεF G
foreach
ζζ 
(
ζζ 
string
ζζ 
item
ζζ  
in
ζζ! #
	blacklist
ζζ$ -
.
ζζ- .
Cast
ζζ. 2
<
ζζ2 3
string
ζζ3 9
>
ζζ9 :
(
ζζ: ;
)
ζζ; <
)
ζζ< =
{
ηη 
stringCollection
θθ  
.
θθ  !
Add
θθ! $
(
θθ$ %
item
θθ% )
)
θθ) *
;
θθ* +
}
ιι 

Properties
κκ 
.
κκ 
Settings
κκ 
.
κκ  
Default
κκ  '
.
κκ' (
	Blacklist
κκ( 1
=
κκ2 3
stringCollection
κκ4 D
;
κκD E

Properties
λλ 
.
λλ 
Settings
λλ 
.
λλ  
Default
λλ  '
.
λλ' (
Save
λλ( ,
(
λλ, -
)
λλ- .
;
λλ. /
return
νν 
JsonConvert
νν 
.
νν 
SerializeObject
νν .
(
νν. /

Properties
νν/ 9
.
νν9 :
Settings
νν: B
.
ννB C
Default
ννC J
.
ννJ K
	Blacklist
ννK T
.
ννT U
Cast
ννU Y
<
ννY Z
string
ννZ `
>
νν` a
(
ννa b
)
ννb c
.
ννc d
ToList
ννd j
(
ννj k
)
ννk l
)
ννl m
;
ννm n
}
ξξ 	
public
υυ 
void
υυ 
OpenUrl
υυ 
(
υυ 
string
υυ "
url
υυ# &
)
υυ& '
{
φφ 	
Process
χχ 
.
χχ 
Start
χχ 
(
χχ 
url
χχ 
)
χχ 
;
χχ 
}
ψψ 	
public
ϊϊ 
string
ϊϊ 
GetActivities
ϊϊ #
(
ϊϊ# $
)
ϊϊ$ %
{
ϋϋ 	
List
όό 
<
όό 
string
όό 
>
όό 

Activities
όό #
=
όό$ %
StorageHandler
όό& 4
.
όό4 5#
GetActivitiesByLambda
όό5 J
(
όόJ K
a
όόK L
=>
όόM O
true
όόP T
)
όόT U
.
όόU V
GroupBy
όόV ]
(
όό] ^
a
όό^ _
=>
όό` b
a
όόc d
.
όόd e
Name
όόe i
)
όόi j
.
όόj k
Select
όόk q
(
όόq r
g
όόr s
=>
όόt v
g
όόw x
.
όόx y
Key
όόy |
)
όό| }
.
όό} ~
ToListόό~ „
(όό„ …
)όό… †
;όό† ‡
return
ύύ 
JsonConvert
ύύ 
.
ύύ 
SerializeObject
ύύ .
(
ύύ. /

Activities
ύύ/ 9
)
ύύ9 :
;
ύύ: ;
}
ώώ 	
private
€€ 
Thread
€€ "
GetReportData1Thread
€€ +
=
€€, -
null
€€. 2
;
€€2 3
private
‚‚ 
async
‚‚ 
Task
‚‚ 
<
‚‚ 
string
‚‚ !
>
‚‚! "!
GetReportData1Async
‚‚# 6
(
‚‚6 7
List
‚‚7 ;
<
‚‚; <
Object
‚‚< B
>
‚‚B C

activities
‚‚D N
,
‚‚N O
string
‚‚P V
start
‚‚W \
,
‚‚\ ]
string
‚‚^ d
end
‚‚e h
,
‚‚h i
int
‚‚j m
zoom
‚‚n r
,
‚‚r s
int
‚‚t w
counter
‚‚x 
)‚‚ €
{
ƒƒ 	"
TaskCompletionSource
„„  
<
„„  !
string
„„! '
>
„„' (
tcs
„„) ,
=
„„- .
new
„„/ 2"
TaskCompletionSource
„„3 G
<
„„G H
string
„„H N
>
„„N O
(
„„O P
)
„„P Q
;
„„Q R
string
…… 
Json
…… 
=
…… 
$str
…… 
;
…… 
await
†† 
Task
†† 
.
†† 
Factory
†† 
.
†† 
StartNew
†† '
(
††' (
(
††( )
)
††) *
=>
††+ -
{
‡‡ "
GetReportData1Thread
 $
=
% &
Thread
' -
.
- .
CurrentThread
. ;
;
; <
List
 
<
 
string
 
>
 

Activities
 '
=
( )

activities
* 4
.
4 5
Cast
5 9
<
9 :
string
: @
>
@ A
(
A B
)
B C
.
C D
ToList
D J
(
J K
)
K L
;
L M
DateTime
‹‹ 
StartPeriod
‹‹ $
=
‹‹% &
DateTime
‹‹' /
.
‹‹/ 0
Parse
‹‹0 5
(
‹‹5 6
start
‹‹6 ;
)
‹‹; <
.
‹‹< =
Date
‹‹= A
;
‹‹A B
DateTime
 
	EndPeriod
 "
=
# $
DateTime
% -
.
- .
Parse
. 3
(
3 4
end
4 7
)
7 8
.
8 9
Date
9 =
;
= >
List
 
<
 
(
 
DateTime
 
,
 

Dictionary
  *
<
* +
string
+ 1
,
1 2
double
3 9
>
9 :
)
: ;
>
; <
Days
= A
=
B C
new
D G
List
H L
<
L M
(
M N
DateTime
N V
,
V W

Dictionary
X b
<
b c
string
c i
,
i j
double
k q
>
q r
)
r s
>
s t
(
t u
)
u v
;
v w
foreach
 
(
 
DateTime
 !
Day
" %
in
& (
EachDay
) 0
(
0 1
StartPeriod
1 <
,
< =
	EndPeriod
> G
)
G H
)
H I
{
‘‘ 
DateTime
’’ 
Start
’’ "
=
’’# $
Day
’’% (
;
’’( )
DateTime
““ 
End
““  
=
““! "
Day
““# &
.
““& '
AddDays
““' .
(
““. /
$num
““/ 0
)
““0 1
;
““1 2
List
•• 
<
•• 
Helper
•• 
>
••  
ActivityHelper
••! /
=
••0 1
StorageHandler
••2 @
.
••@ A#
GetActivitiesByLambda
••A V
(
••V W
r
••W X
=>
••Y [
r
••\ ]
.
••] ^
To
••^ `
>=
••a c
Start
••d i
&&
••j l
r
••m n
.
••n o
From
••o s
<
••t u
End
••v y
&&
••z |

Activities••} ‡
.••‡ 
Contains•• 
(•• ‘
r••‘ ’
.••’ “
Name••“ —
)••— 
)•• ™
.••™ 
Select••  
(••  ΅
aa••΅ £
=>••¤ ¦
new••§ 
Helper••« ±
{
–– 
Name
—— 
=
—— 
aa
—— !
.
——! "
Name
——" &
.
——& '
Split
——' ,
(
——, -
new
——- 0
string
——1 7
[
——7 8
]
——8 9
{
——: ;
$str
——< A
}
——B C
,
——C D 
StringSplitOptions
——E W
.
——W X
None
——X \
)
——\ ]
.
——] ^
First
——^ c
(
——c d
)
——d e
,
——e f
From
 
=
 
aa
 !
.
! "
From
" &
>
' (
Start
) .
?
/ 0
aa
1 3
.
3 4
From
4 8
:
9 :
Start
; @
,
@ A
To
™™ 
=
™™ 
(
™™ 
DateTime
™™ &
)
™™& '
aa
™™' )
.
™™) *
To
™™* ,
>
™™- .
End
™™/ 2
?
™™3 4
End
™™5 8
:
™™9 :
(
™™; <
DateTime
™™< D
)
™™D E
aa
™™E G
.
™™G H
To
™™H J
}
 
)
 
.
 
ToList
 
(
 
)
 
;
  
if
 
(
 
AppStateTracker
 '
.
' (
CurrentActivity
( 7
!=
8 :
null
; ?
&&
@ B
Start
C H
==
I K
DateTime
L T
.
T U
Today
U Z
&&
[ ]

Activities
^ h
.
h i
Contains
i q
(
q r
AppStateTrackerr 
. ‚
CurrentActivity‚ ‘
.‘ ’
Name’ –
)– —
)— 
ActivityHelper
 &
.
& '
Add
' *
(
* +
new
+ .
Helper
/ 5
{
 
Name
    
=
  ! "
AppStateTracker
  # 2
.
  2 3
CurrentActivity
  3 B
.
  B C
Name
  C G
.
  G H
Split
  H M
(
  M N
new
  N Q
string
  R X
[
  X Y
]
  Y Z
{
  [ \
$str
  ] b
}
  c d
,
  d e 
StringSplitOptions
  f x
.
  x y
None
  y }
)
  } ~
.
  ~ 
First   „
(  „ …
)  … †
,  † ‡
From
΅΅  
=
΅΅! "
AppStateTracker
΅΅# 2
.
΅΅2 3
CurrentActivity
΅΅3 B
.
΅΅B C
From
΅΅C G
>
΅΅H I
Start
΅΅J O
?
΅΅P Q
AppStateTracker
΅΅R a
.
΅΅a b
CurrentActivity
΅΅b q
.
΅΅q r
From
΅΅r v
:
΅΅w x
Start
΅΅y ~
,
΅΅~ 
To
ΆΆ 
=
ΆΆ  
DateTime
ΆΆ! )
.
ΆΆ) *
Now
ΆΆ* -
}
££ 
)
££ 
;
££ 
foreach
¦¦ 
(
¦¦ 
Helper
¦¦ #
h
¦¦$ %
in
¦¦& (
ActivityHelper
¦¦) 7
)
¦¦7 8
{
§§ 
h
¨¨ 
.
¨¨ 
Time
¨¨ 
=
¨¨  
Math
¨¨! %
.
¨¨% &
Max
¨¨& )
(
¨¨) *
Math
¨¨* .
.
¨¨. /
Round
¨¨/ 4
(
¨¨4 5
(
¨¨5 6
h
¨¨6 7
.
¨¨7 8
To
¨¨8 :
-
¨¨; <
h
¨¨= >
.
¨¨> ?
From
¨¨? C
)
¨¨C D
.
¨¨D E

TotalHours
¨¨E O
,
¨¨O P
$num
¨¨Q R
)
¨¨R S
,
¨¨S T
$num
¨¨U V
)
¨¨V W
;
¨¨W X
}
©© 

Dictionary
«« 
<
«« 
string
«« %
,
««% &
double
««' -
>
««- .
ActivityDict
««/ ;
=
««< =
new
««> A

Dictionary
««B L
<
««L M
string
««M S
,
««S T
double
««U [
>
««[ \
(
««\ ]
)
««] ^
;
««^ _
ActivityHelper
­­ "
.
®® 
GroupBy
®®  
(
®®  !
ah
®®! #
=>
®®$ &
ah
®®' )
.
®®) *
Name
®®* .
)
®®. /
.
―― 
ToList
―― 
(
――  
)
――  !
.
°° 
ForEach
°°  
(
°°  !
g
°°! "
=>
°°# %
{
±± 
ActivityDict
²² (
.
²²( )
Add
²²) ,
(
²², -
g
²²- .
.
²². /
Key
²²/ 2
,
²²2 3
g
²²4 5
.
²²5 6
Sum
²²6 9
(
²²9 :
h
²²: ;
=>
²²< >
h
²²? @
.
²²@ A
Time
²²A E
)
²²E F
)
²²F G
;
²²G H
}
³³ 
)
³³ 
;
³³ 
Days
µµ 
.
µµ 
Add
µµ 
(
µµ 
(
µµ 
Day
µµ !
.
µµ! "
Date
µµ" &
,
µµ& '
ActivityDict
µµ( 4
)
µµ4 5
)
µµ5 6
;
µµ6 7
}
¶¶ 
List
ΉΉ 
<
ΉΉ 
Bardata
ΉΉ 
>
ΉΉ 
Bardata
ΉΉ %
;
ΉΉ% &
if
ΊΊ 
(
ΊΊ 
zoom
ΊΊ 
==
ΊΊ 
$num
ΊΊ 
)
ΊΊ 
{
»» 
Bardata
ΌΌ 
=
ΌΌ 
Days
ΌΌ "
.
ΌΌ" #
OrderBy
ΌΌ# *
(
ΌΌ* +
d
ΌΌ+ ,
=>
ΌΌ- /
d
ΌΌ0 1
.
ΌΌ1 2
Item1
ΌΌ2 7
)
ΌΌ7 8
.
ΌΌ8 9
Select
ΌΌ9 ?
(
ΌΌ? @
d
ΌΌ@ A
=>
ΌΌB D
new
ΌΌE H
Bardata
ΌΌI P
{
½½ 
Label
ΎΎ 
=
ΎΎ 
d
ΎΎ  !
.
ΎΎ! "
Item1
ΎΎ" '
.
ΎΎ' (
ToString
ΎΎ( 0
(
ΎΎ0 1
$str
ΎΎ1 8
)
ΎΎ8 9
,
ΎΎ9 :
Datasets
ΏΏ  
=
ΏΏ! "
d
ΏΏ# $
.
ΏΏ$ %
Item2
ΏΏ% *
.
ΐΐ 
Where
ΐΐ 
(
ΐΐ 
h
ΐΐ  
=>
ΐΐ! #
AppStateTracker
ΐΐ$ 3
.
ΐΐ3 4
ColorAssingments
ΐΐ4 D
.
ΐΐD E
ContainsKey
ΐΐE P
(
ΐΐP Q
h
ΐΐQ R
.
ΐΐR S
Key
ΐΐS V
)
ΐΐV W
)
ΐΐW X
.
ΑΑ 
Select
ΑΑ 
(
ΑΑ  
h
ΑΑ  !
=>
ΑΑ" $
new
ΑΑ% (
Dataset
ΑΑ) 0
{
ΒΒ 
Title
ΓΓ !
=
ΓΓ" #
h
ΓΓ$ %
.
ΓΓ% &
Key
ΓΓ& )
,
ΓΓ) *
Value
ΔΔ !
=
ΔΔ" #
h
ΔΔ$ %
.
ΔΔ% &
Value
ΔΔ& +
,
ΔΔ+ ,
Color
ΕΕ !
=
ΕΕ" #
AppStateTracker
ΕΕ$ 3
.
ΕΕ3 4
ColorAssingments
ΕΕ4 D
[
ΕΕD E
h
ΕΕE F
.
ΕΕF G
Key
ΕΕG J
]
ΕΕJ K
}
ΖΖ 
)
ΖΖ 
.
ΖΖ 
OrderBy
ΖΖ "
(
ΖΖ" #
dd
ΖΖ# %
=>
ΖΖ& (
dd
ΖΖ) +
.
ΖΖ+ ,
Title
ΖΖ, 1
)
ΖΖ1 2
.
ΖΖ2 3
ToList
ΖΖ3 9
(
ΖΖ9 :
)
ΖΖ: ;
}
ΗΗ 
)
ΗΗ 
.
ΗΗ 
ToList
ΗΗ 
(
ΗΗ 
)
ΗΗ 
;
ΗΗ  
}
ΘΘ 
else
ΙΙ 
if
ΙΙ 
(
ΙΙ 
zoom
ΙΙ 
==
ΙΙ  
$num
ΙΙ! "
)
ΙΙ" #
{
ΚΚ 
Bardata
ΛΛ 
=
ΛΛ 
Days
ΛΛ "
.
ΜΜ 
GroupBy
ΜΜ  
(
ΜΜ  !
d
ΜΜ! "
=>
ΜΜ# %
new
ΜΜ& )
{
ΝΝ 
week
ΞΞ  
=
ΞΞ! "
CultureInfo
ΞΞ# .
.
ΞΞ. /
CurrentCulture
ΞΞ/ =
.
ΞΞ= >
Calendar
ΞΞ> F
.
ΞΞF G
GetWeekOfYear
ΞΞG T
(
ΞΞT U
d
ΞΞU V
.
ΞΞV W
Item1
ΞΞW \
,
ΞΞ\ ]
CalendarWeekRule
ΞΞ^ n
.
ΞΞn o
FirstDay
ΞΞo w
,
ΞΞw x
	DayOfWeekΞΞy ‚
.ΞΞ‚ ƒ
MondayΞΞƒ ‰
)ΞΞ‰ 
,ΞΞ ‹
year
ΟΟ  
=
ΟΟ! "
d
ΟΟ# $
.
ΟΟ$ %
Item1
ΟΟ% *
.
ΟΟ* +
Year
ΟΟ+ /
}
ΠΠ 
)
ΠΠ 
.
ΡΡ 
OrderBy
ΡΡ  
(
ΡΡ  !
g
ΡΡ! "
=>
ΡΡ# %
g
ΡΡ& '
.
ΡΡ' (
Key
ΡΡ( +
.
ΡΡ+ ,
year
ΡΡ, 0
)
ΡΡ0 1
.
 
ThenBy
 
(
  
g
  !
=>
" $
g
% &
.
& '
Key
' *
.
* +
week
+ /
)
/ 0
.
ΣΣ 
Select
ΣΣ 
(
ΣΣ  
g
ΣΣ  !
=>
ΣΣ" $
new
ΣΣ% (
Bardata
ΣΣ) 0
{
ΤΤ 
Label
ΥΥ !
=
ΥΥ" #
$str
ΥΥ$ +
+
ΥΥ, -
(
ΥΥ. /
g
ΥΥ/ 0
.
ΥΥ0 1
Key
ΥΥ1 4
.
ΥΥ4 5
week
ΥΥ5 9
+
ΥΥ: ;
$num
ΥΥ< =
)
ΥΥ= >
,
ΥΥ> ?
Datasets
ΦΦ $
=
ΦΦ% &
g
ΦΦ' (
.
ΦΦ( )

SelectMany
ΦΦ) 3
(
ΦΦ3 4
d
ΦΦ4 5
=>
ΦΦ6 8
d
ΦΦ9 :
.
ΦΦ: ;
Item2
ΦΦ; @
)
ΦΦ@ A
.
ΦΦA B
GroupBy
ΦΦB I
(
ΦΦI J
d
ΦΦJ K
=>
ΦΦL N
d
ΦΦO P
.
ΦΦP Q
Key
ΦΦQ T
)
ΦΦT U
.
ΧΧ 
Where
ΧΧ "
(
ΧΧ" #
gg
ΧΧ# %
=>
ΧΧ& (
AppStateTracker
ΧΧ) 8
.
ΧΧ8 9
ColorAssingments
ΧΧ9 I
.
ΧΧI J
ContainsKey
ΧΧJ U
(
ΧΧU V
gg
ΧΧV X
.
ΧΧX Y
Key
ΧΧY \
)
ΧΧ\ ]
)
ΧΧ] ^
.
ΨΨ 
Select
ΨΨ #
(
ΨΨ# $
gg
ΨΨ$ &
=>
ΨΨ' )
new
ΨΨ* -
Dataset
ΨΨ. 5
{
ΨΨ6 7
Title
ΨΨ8 =
=
ΨΨ> ?
gg
ΨΨ@ B
.
ΨΨB C
Key
ΨΨC F
,
ΨΨF G
Value
ΨΨH M
=
ΨΨN O
gg
ΨΨP R
.
ΨΨR S
Sum
ΨΨS V
(
ΨΨV W
d
ΨΨW X
=>
ΨΨY [
d
ΨΨ\ ]
.
ΨΨ] ^
Value
ΨΨ^ c
)
ΨΨc d
,
ΨΨd e
Color
ΨΨf k
=
ΨΨl m
AppStateTracker
ΨΨn }
.
ΨΨ} ~
ColorAssingmentsΨΨ~ 
[ΨΨ 
ggΨΨ ‘
.ΨΨ‘ ’
KeyΨΨ’ •
]ΨΨ• –
}ΨΨ— 
)ΨΨ ™
.ΨΨ™ 
OrderByΨΨ ΅
(ΨΨ΅ Ά
dΨΨΆ £
=>ΨΨ¤ ¦
dΨΨ§ ¨
.ΨΨ¨ ©
TitleΨΨ© ®
)ΨΨ® ―
.ΨΨ― °
ToListΨΨ° ¶
(ΨΨ¶ ·
)ΨΨ· Έ
}
ΩΩ 
)
ΩΩ 
.
ΩΩ 
ToList
ΩΩ !
(
ΩΩ! "
)
ΩΩ" #
;
ΩΩ# $
}
ΪΪ 
else
ΫΫ 
{
άά 
Bardata
έέ 
=
έέ 
Days
έέ "
.
ήή 
OrderBy
ήή  
(
ήή  !
d
ήή! "
=>
ήή# %
d
ήή& '
.
ήή' (
Item1
ήή( -
)
ήή- .
.
ίί 
GroupBy
ίί  
(
ίί  !
d
ίί! "
=>
ίί# %
new
ίί& )
{
ΰΰ 
month
αα !
=
αα" #
d
αα$ %
.
αα% &
Item1
αα& +
.
αα+ ,
ToString
αα, 4
(
αα4 5
$str
αα5 :
,
αα: ;
CultureInfo
αα< G
.
ααG H
InvariantCulture
ααH X
)
ααX Y
,
ααY Z
year
ββ  
=
ββ! "
d
ββ# $
.
ββ$ %
Item1
ββ% *
.
ββ* +
Year
ββ+ /
}
γγ 
)
γγ 
.
δδ 
Select
δδ 
(
δδ  
g
δδ  !
=>
δδ" $
new
δδ% (
Bardata
δδ) 0
{
εε 
Label
ζζ !
=
ζζ" #
g
ζζ$ %
.
ζζ% &
Key
ζζ& )
.
ζζ) *
month
ζζ* /
,
ζζ/ 0
Datasets
ηη $
=
ηη% &
g
ηη' (
.
ηη( )

SelectMany
ηη) 3
(
ηη3 4
d
ηη4 5
=>
ηη6 8
d
ηη9 :
.
ηη: ;
Item2
ηη; @
)
ηη@ A
.
ηηA B
GroupBy
ηηB I
(
ηηI J
d
ηηJ K
=>
ηηL N
d
ηηO P
.
ηηP Q
Key
ηηQ T
)
ηηT U
.
θθ 
Where
θθ "
(
θθ" #
gg
θθ# %
=>
θθ& (
AppStateTracker
θθ) 8
.
θθ8 9
ColorAssingments
θθ9 I
.
θθI J
ContainsKey
θθJ U
(
θθU V
gg
θθV X
.
θθX Y
Key
θθY \
)
θθ\ ]
)
θθ] ^
.
ιι 
Select
ιι #
(
ιι# $
gg
ιι$ &
=>
ιι' )
new
ιι* -
Dataset
ιι. 5
{
ιι6 7
Title
ιι8 =
=
ιι> ?
gg
ιι@ B
.
ιιB C
Key
ιιC F
,
ιιF G
Value
ιιH M
=
ιιN O
gg
ιιP R
.
ιιR S
Sum
ιιS V
(
ιιV W
d
ιιW X
=>
ιιY [
d
ιι\ ]
.
ιι] ^
Value
ιι^ c
)
ιιc d
,
ιιd e
Color
ιιf k
=
ιιl m
AppStateTracker
ιιn }
.
ιι} ~
ColorAssingmentsιι~ 
[ιι 
ggιι ‘
.ιι‘ ’
Keyιι’ •
]ιι• –
}ιι— 
)ιι ™
.ιι™ 
OrderByιι ΅
(ιι΅ Ά
dιιΆ £
=>ιι¤ ¦
dιι§ ¨
.ιι¨ ©
Titleιι© ®
)ιι® ―
.ιι― °
ToListιι° ¶
(ιι¶ ·
)ιι· Έ
}
κκ 
)
κκ 
.
κκ 
ToList
κκ !
(
κκ! "
)
κκ" #
;
κκ# $
}
λλ 
Json
νν 
=
νν 
JsonConvert
νν "
.
νν" #
SerializeObject
νν# 2
(
νν2 3
new
νν3 6
{
νν7 8
value
νν9 >
=
νν? @
Bardata
ννA H
,
ννH I
counter
ννJ Q
}
ννR S
)
ννS T
;
ννT U
}
ξξ 
)
ξξ 
;
ξξ "
GetReportData1Thread
ππ  
=
ππ! "
null
ππ# '
;
ππ' (
tcs
ρρ 
.
ρρ 
	SetResult
ρρ 
(
ρρ 
Json
ρρ 
)
ρρ 
;
ρρ  
return
ςς 
tcs
ςς 
.
ςς 
Task
ςς 
.
ςς 
Result
ςς "
;
ςς" #
}
σσ 	
public
υυ 
string
υυ 
GetReportData1
υυ $
(
υυ$ %
List
υυ% )
<
υυ) *
Object
υυ* 0
>
υυ0 1

activities
υυ2 <
,
υυ< =
string
υυ> D
start
υυE J
,
υυJ K
string
υυL R
end
υυS V
,
υυV W
int
υυX [
zoom
υυ\ `
,
υυ` a
int
υυb e
counter
υυf m
)
υυm n
{
φφ 	
if
χχ 
(
χχ "
GetReportData1Thread
χχ $
!=
χχ% '
null
χχ( ,
)
χχ, -
{
ψψ "
GetReportData1Thread
ωω $
.
ωω$ %
Abort
ωω% *
(
ωω* +
)
ωω+ ,
;
ωω, -"
GetReportData1Thread
ϊϊ $
=
ϊϊ% &
null
ϊϊ' +
;
ϊϊ+ ,
}
ϋϋ 
var
ύύ 
task
ύύ 
=
ύύ !
GetReportData1Async
ύύ *
(
ύύ* +

activities
ύύ+ 5
,
ύύ5 6
start
ύύ7 <
,
ύύ< =
end
ύύ> A
,
ύύA B
zoom
ύύC G
,
ύύG H
counter
ύύI P
)
ύύP Q
;
ύύQ R
return
 
task
 
.
 
Result
 
;
 
}
€€ 	
private
‚‚ 
Thread
‚‚ "
GetReportData2Thread
‚‚ +
=
‚‚, -
null
‚‚. 2
;
‚‚2 3
private
ƒƒ 
async
ƒƒ 
Task
ƒƒ 
<
ƒƒ 
string
ƒƒ !
>
ƒƒ! "!
GetReportData2Async
ƒƒ# 6
(
ƒƒ6 7
List
ƒƒ7 ;
<
ƒƒ; <
Object
ƒƒ< B
>
ƒƒB C

activities
ƒƒD N
,
ƒƒN O
string
ƒƒP V
start
ƒƒW \
,
ƒƒ\ ]
string
ƒƒ^ d
end
ƒƒe h
,
ƒƒh i
int
ƒƒj m
counter
ƒƒn u
)
ƒƒu v
{
„„ 	"
TaskCompletionSource
……  
<
……  !
string
……! '
>
……' (
tcs
……) ,
=
……- .
new
……/ 2"
TaskCompletionSource
……3 G
<
……G H
string
……H N
>
……N O
(
……O P
)
……P Q
;
……Q R
string
†† 
Json
†† 
=
†† 
$str
†† 
;
†† 
await
‡‡ 
Task
‡‡ 
.
‡‡ 
Factory
‡‡ 
.
‡‡ 
StartNew
‡‡ '
(
‡‡' (
(
‡‡( )
)
‡‡) *
=>
‡‡+ -
{
 "
GetReportData2Thread
‰‰ $
=
‰‰% &
Thread
‰‰' -
.
‰‰- .
CurrentThread
‰‰. ;
;
‰‰; <
List
‹‹ 
<
‹‹ 
string
‹‹ 
>
‹‹ 

Activities
‹‹ '
=
‹‹( )

activities
‹‹* 4
.
‹‹4 5
Cast
‹‹5 9
<
‹‹9 :
string
‹‹: @
>
‹‹@ A
(
‹‹A B
)
‹‹B C
.
‹‹C D
ToList
‹‹D J
(
‹‹J K
)
‹‹K L
;
‹‹L M
DateTime
 
StartPeriod
 $
=
% &
DateTime
' /
.
/ 0
Parse
0 5
(
5 6
start
6 ;
)
; <
.
< =
Date
= A
.
A B
AddDays
B I
(
I J
$num
J K
)
K L
;
L M
DateTime
 
	EndPeriod
 "
=
# $
DateTime
% -
.
- .
Parse
. 3
(
3 4
end
4 7
)
7 8
.
8 9
Date
9 =
;
= >
List
 
<
 
Helper
 
>
 
ActivityHelper
 +
=
, -
StorageHandler
. <
.
< =#
GetActivitiesByLambda
= R
(
R S
r
S T
=>
U W
r
X Y
.
Y Z
To
Z \
>=
] _
StartPeriod
` k
&&
l n
r
o p
.
p q
From
q u
<=
v x
	EndPeriody ‚
&&ƒ …

Activities† 
. ‘
Contains‘ ™
(™ 
r ›
.› 
Name  
)  ΅
)΅ Ά
.Ά £
Select£ ©
(© 
aa ¬
=>­ ―
new° ³
Helper΄ Ί
{
 
Name
‘‘ 
=
‘‘ 
aa
‘‘ 
.
‘‘ 
Name
‘‘ "
,
‘‘" #
From
’’ 
=
’’ 
aa
’’ 
.
’’ 
From
’’ "
>
’’# $
StartPeriod
’’% 0
?
’’1 2
aa
’’3 5
.
’’5 6
From
’’6 :
:
’’; <
StartPeriod
’’= H
,
’’H I
To
““ 
=
““ 
(
““ 
DateTime
““ "
)
““" #
aa
““# %
.
““% &
To
““& (
>
““) *
	EndPeriod
““+ 4
?
““5 6
	EndPeriod
““7 @
:
““A B
(
““C D
DateTime
““D L
)
““L M
aa
““M O
.
““O P
To
““P R
}
”” 
)
”” 
.
”” 
ToList
”” 
(
”” 
)
”” 
;
”” 
if
—— 
(
—— 
AppStateTracker
—— #
.
——# $
CurrentActivity
——$ 3
!=
——4 6
null
——7 ;
&&
——< >
	EndPeriod
——? H
>=
——I K
DateTime
——L T
.
——T U
Today
——U Z
&&
——[ ]

Activities
——^ h
.
——h i
Contains
——i q
(
——q r
AppStateTracker——r 
.—— ‚
CurrentActivity——‚ ‘
.——‘ ’
Name——’ –
)——– —
)——— 
ActivityHelper
 "
.
" #
Add
# &
(
& '
new
' *
Helper
+ 1
{
™™ 
Name
 
=
 
AppStateTracker
 .
.
. /
CurrentActivity
/ >
.
> ?
Name
? C
,
C D
From
›› 
=
›› 
AppStateTracker
›› .
.
››. /
CurrentActivity
››/ >
.
››> ?
From
››? C
>
››D E
StartPeriod
››F Q
?
››R S
AppStateTracker
››T c
.
››c d
CurrentActivity
››d s
.
››s t
From
››t x
:
››y z
StartPeriod››{ †
,››† ‡
To
 
=
 
DateTime
 %
.
% &
Now
& )
}
 
)
 
;
 
foreach
   
(
   
Helper
   
h
    !
in
  " $
ActivityHelper
  % 3
)
  3 4
{
΅΅ 
h
ΆΆ 
.
ΆΆ 
Time
ΆΆ 
=
ΆΆ 
Math
ΆΆ !
.
ΆΆ! "
Max
ΆΆ" %
(
ΆΆ% &
Math
ΆΆ& *
.
ΆΆ* +
Round
ΆΆ+ 0
(
ΆΆ0 1
(
ΆΆ1 2
h
ΆΆ2 3
.
ΆΆ3 4
To
ΆΆ4 6
-
ΆΆ7 8
h
ΆΆ9 :
.
ΆΆ: ;
From
ΆΆ; ?
)
ΆΆ? @
.
ΆΆ@ A

TotalHours
ΆΆA K
,
ΆΆK L
$num
ΆΆM N
)
ΆΆN O
,
ΆΆO P
$num
ΆΆQ R
)
ΆΆR S
;
ΆΆS T
}
££ 

Dictionary
¥¥ 
<
¥¥ 
string
¥¥ !
,
¥¥! "

Dictionary
¥¥# -
<
¥¥- .
string
¥¥. 4
,
¥¥4 5
double
¥¥6 <
>
¥¥< =
>
¥¥= >
Grouping
¥¥? G
=
¥¥H I
ActivityHelper
¥¥J X
.
¦¦ 
GroupBy
¦¦ 
(
¦¦ 
ah
¦¦ 
=>
¦¦  "
ah
¦¦# %
.
¦¦% &
Name
¦¦& *
.
¦¦* +
Split
¦¦+ 0
(
¦¦0 1
new
¦¦1 4
string
¦¦5 ;
[
¦¦; <
]
¦¦< =
{
¦¦> ?
$str
¦¦@ E
}
¦¦F G
,
¦¦G H 
StringSplitOptions
¦¦I [
.
¦¦[ \
None
¦¦\ `
)
¦¦` a
.
¦¦a b
First
¦¦b g
(
¦¦g h
)
¦¦h i
)
¦¦i j
.
§§ 
ToDictionary
§§ !
(
§§! "
g
§§" #
=>
§§$ &
g
§§' (
.
§§( )
Key
§§) ,
,
§§, -
g
§§. /
=>
§§0 2
g
§§3 4
.
¨¨ 
GroupBy
¨¨  
(
¨¨  !
a
¨¨! "
=>
¨¨# %
a
¨¨& '
.
¨¨' (
Name
¨¨( ,
.
¨¨, -
Split
¨¨- 2
(
¨¨2 3
new
¨¨3 6
string
¨¨7 =
[
¨¨= >
]
¨¨> ?
{
¨¨@ A
$str
¨¨B G
}
¨¨H I
,
¨¨I J 
StringSplitOptions
¨¨K ]
.
¨¨] ^
None
¨¨^ b
)
¨¨b c
.
¨¨c d
Last
¨¨d h
(
¨¨h i
)
¨¨i j
)
¨¨j k
.
©© 
ToDictionary
©© %
(
©©% &
gg
©©& (
=>
©©) +
gg
©©, .
.
©©. /
Key
©©/ 2
,
©©2 3
gg
©©4 6
=>
©©7 9
gg
©©: <
.
©©< =
Sum
©©= @
(
©©@ A
h
©©A B
=>
©©C E
h
©©F G
.
©©G H
Time
©©H L
)
©©L M
)
©©M N
)
 
;
 
List
­­ 
<
­­ 
Bardata
­­ 
>
­­ 
Bardata
­­ %
=
­­& '
Grouping
­­( 0
.
®® 
OrderBy
®® 
(
®® 
g
®® 
=>
®® !
g
®®" #
.
®®# $
Key
®®$ '
)
®®' (
.
―― 
Select
―― 
(
―― 
g
―― 
=>
――  
new
――! $
Bardata
――% ,
{
°° 
Label
±± 
=
±± 
g
±±  !
.
±±! "
Key
±±" %
,
±±% &
Datasets
²²  
=
²²! "
g
²²# $
.
²²$ %
Value
²²% *
.
³³ 
Where
³³ 
(
³³ 
d
³³  
=>
³³! #
AppStateTracker
³³$ 3
.
³³3 4
ColorAssingments
³³4 D
.
³³D E
ContainsKey
³³E P
(
³³P Q
g
³³Q R
.
³³R S
Key
³³S V
+
³³W X
$str
³³Y ^
+
³³_ `
d
³³a b
.
³³b c
Key
³³c f
)
³³f g
)
³³g h
.
΄΄ 
Select
΄΄ 
(
΄΄  
d
΄΄  !
=>
΄΄" $
new
΄΄% (
Dataset
΄΄) 0
{
µµ 
Title
¶¶ !
=
¶¶" #
d
¶¶$ %
.
¶¶% &
Key
¶¶& )
,
¶¶) *
Value
·· !
=
··" #
d
··$ %
.
··% &
Value
··& +
,
··+ ,
Color
ΈΈ !
=
ΈΈ" #
AppStateTracker
ΈΈ$ 3
.
ΈΈ3 4
ColorAssingments
ΈΈ4 D
[
ΈΈD E
g
ΈΈE F
.
ΈΈF G
Key
ΈΈG J
+
ΈΈK L
$str
ΈΈM R
+
ΈΈS T
d
ΈΈU V
.
ΈΈV W
Key
ΈΈW Z
]
ΈΈZ [
}
ΉΉ 
)
ΉΉ 
.
ΉΉ 
OrderBy
ΉΉ "
(
ΉΉ" #
d
ΉΉ# $
=>
ΉΉ% '
d
ΉΉ( )
.
ΉΉ) *
Title
ΉΉ* /
)
ΉΉ/ 0
.
ΉΉ0 1
ToList
ΉΉ1 7
(
ΉΉ7 8
)
ΉΉ8 9
}
ΊΊ 
)
ΊΊ 
.
ΊΊ 
OrderBy
ΊΊ 
(
ΊΊ 
d
ΊΊ  
=>
ΊΊ! #
d
ΊΊ$ %
.
ΊΊ% &
Label
ΊΊ& +
)
ΊΊ+ ,
.
ΊΊ, -
ToList
ΊΊ- 3
(
ΊΊ3 4
)
ΊΊ4 5
;
ΊΊ5 6
Json
ΌΌ 
=
ΌΌ 
JsonConvert
ΌΌ "
.
ΌΌ" #
SerializeObject
ΌΌ# 2
(
ΌΌ2 3
new
ΌΌ3 6
{
ΌΌ7 8
value
ΌΌ9 >
=
ΌΌ? @
Bardata
ΌΌA H
,
ΌΌH I
counter
ΌΌJ Q
}
ΌΌR S
)
ΌΌS T
;
ΌΌT U
}
½½ 
)
½½ 
;
½½ "
GetReportData2Thread
ΏΏ  
=
ΏΏ! "
null
ΏΏ# '
;
ΏΏ' (
tcs
ΐΐ 
.
ΐΐ 
	SetResult
ΐΐ 
(
ΐΐ 
Json
ΐΐ 
)
ΐΐ 
;
ΐΐ  
return
ΑΑ 
tcs
ΑΑ 
.
ΑΑ 
Task
ΑΑ 
.
ΑΑ 
Result
ΑΑ "
;
ΑΑ" #
}
ΒΒ 	
public
ΔΔ 
string
ΔΔ 
GetReportData2
ΔΔ $
(
ΔΔ$ %
List
ΔΔ% )
<
ΔΔ) *
Object
ΔΔ* 0
>
ΔΔ0 1

activities
ΔΔ2 <
,
ΔΔ< =
string
ΔΔ> D
start
ΔΔE J
,
ΔΔJ K
string
ΔΔL R
end
ΔΔS V
,
ΔΔV W
int
ΔΔX [
counter
ΔΔ\ c
)
ΔΔc d
{
ΕΕ 	
if
ΖΖ 
(
ΖΖ "
GetReportData2Thread
ΖΖ $
!=
ΖΖ% '
null
ΖΖ( ,
)
ΖΖ, -
{
ΗΗ "
GetReportData2Thread
ΘΘ $
.
ΘΘ$ %
Abort
ΘΘ% *
(
ΘΘ* +
)
ΘΘ+ ,
;
ΘΘ, -"
GetReportData2Thread
ΙΙ $
=
ΙΙ% &
null
ΙΙ' +
;
ΙΙ+ ,
}
ΚΚ 
var
ΜΜ 
task
ΜΜ 
=
ΜΜ !
GetReportData2Async
ΜΜ *
(
ΜΜ* +

activities
ΜΜ+ 5
,
ΜΜ5 6
start
ΜΜ7 <
,
ΜΜ< =
end
ΜΜ> A
,
ΜΜA B
counter
ΜΜC J
)
ΜΜJ K
;
ΜΜK L
return
ΞΞ 
task
ΞΞ 
.
ΞΞ 
Result
ΞΞ 
;
ΞΞ 
}
ΟΟ 	
private
ΡΡ 
Thread
ΡΡ "
GetReportData3Thread
ΡΡ +
=
ΡΡ, -
null
ΡΡ. 2
;
ΡΡ2 3
private
 
async
 
Task
 
<
 
string
 !
>
! "!
GetReportData3Async
# 6
(
6 7
List
7 ;
<
; <
Object
< B
>
B C

activities
D N
,
N O
string
P V
start
W \
,
\ ]
string
^ d
end
e h
,
h i
int
j m
counter
n u
)
u v
{
ΣΣ 	"
TaskCompletionSource
ΤΤ  
<
ΤΤ  !
string
ΤΤ! '
>
ΤΤ' (
tcs
ΤΤ) ,
=
ΤΤ- .
new
ΤΤ/ 2"
TaskCompletionSource
ΤΤ3 G
<
ΤΤG H
string
ΤΤH N
>
ΤΤN O
(
ΤΤO P
)
ΤΤP Q
;
ΤΤQ R
string
ΥΥ 
Json
ΥΥ 
=
ΥΥ 
$str
ΥΥ 
;
ΥΥ 
await
ΦΦ 
Task
ΦΦ 
.
ΦΦ 
Factory
ΦΦ 
.
ΦΦ 
StartNew
ΦΦ '
(
ΦΦ' (
(
ΦΦ( )
)
ΦΦ) *
=>
ΦΦ+ -
{
ΧΧ "
GetReportData3Thread
ΨΨ $
=
ΨΨ% &
Thread
ΨΨ' -
.
ΨΨ- .
CurrentThread
ΨΨ. ;
;
ΨΨ; <
List
ΪΪ 
<
ΪΪ 
string
ΪΪ 
>
ΪΪ 

Activities
ΪΪ '
=
ΪΪ( )

activities
ΪΪ* 4
.
ΪΪ4 5
Cast
ΪΪ5 9
<
ΪΪ9 :
string
ΪΪ: @
>
ΪΪ@ A
(
ΪΪA B
)
ΪΪB C
.
ΪΪC D
ToList
ΪΪD J
(
ΪΪJ K
)
ΪΪK L
;
ΪΪL M
DateTime
ΫΫ 
StartPeriod
ΫΫ $
=
ΫΫ% &
DateTime
ΫΫ' /
.
ΫΫ/ 0
Parse
ΫΫ0 5
(
ΫΫ5 6
start
ΫΫ6 ;
)
ΫΫ; <
.
ΫΫ< =
Date
ΫΫ= A
.
ΫΫA B
AddDays
ΫΫB I
(
ΫΫI J
$num
ΫΫJ K
)
ΫΫK L
;
ΫΫL M
DateTime
άά 
	EndPeriod
άά "
=
άά# $
DateTime
άά% -
.
άά- .
Parse
άά. 3
(
άά3 4
end
άά4 7
)
άά7 8
.
άά8 9
Date
άά9 =
;
άά= >
List
ήή 
<
ήή 
Window
ήή 
>
ήή 
Windows
ήή $
=
ήή% &
StorageHandler
ήή' 5
.
ήή5 6 
GetWindowsByLambda
ήή6 H
(
ήήH I
r
ήήI J
=>
ήήK M
r
ήήN O
.
ήήO P
To
ήήP R
>=
ήήS U
StartPeriod
ήήV a
&&
ήήb d
r
ήήe f
.
ήήf g
From
ήήg k
<=
ήήl n
	EndPeriod
ήήo x
)
ήήx y
;
ήήy z
List
αα 
<
αα 
Helper
αα 
>
αα 
ActivityHelper
αα +
=
αα, -
StorageHandler
αα. <
.
αα< =#
GetActivitiesByLambda
αα= R
(
ααR S
r
ααS T
=>
ααU W
r
ααX Y
.
ααY Z
To
ααZ \
>=
αα] _
StartPeriod
αα` k
&&
ααl n
r
ααo p
.
ααp q
From
ααq u
<=
ααv x
	EndPeriodααy ‚
&&ααƒ …

Activitiesαα† 
.αα ‘
Containsαα‘ ™
(αα™ 
rαα ›
.αα› 
Nameαα  
)αα  ΅
)αα΅ Ά
.ααΆ £
Selectαα£ ©
(αα© 
aaαα ¬
=>αα­ ―
newαα° ³
Helperαα΄ Ί
{
ββ 
Name
γγ 
=
γγ 
aa
γγ 
.
γγ 
Name
γγ "
,
γγ" #
From
δδ 
=
δδ 
aa
δδ 
.
δδ 
From
δδ "
>
δδ# $
StartPeriod
δδ% 0
?
δδ1 2
aa
δδ3 5
.
δδ5 6
From
δδ6 :
:
δδ; <
StartPeriod
δδ= H
,
δδH I
To
εε 
=
εε 
(
εε 
DateTime
εε "
)
εε" #
aa
εε# %
.
εε% &
To
εε& (
>
εε) *
	EndPeriod
εε+ 4
?
εε5 6
	EndPeriod
εε7 @
:
εεA B
(
εεC D
DateTime
εεD L
)
εεL M
aa
εεM O
.
εεO P
To
εεP R
}
ζζ 
)
ζζ 
.
ζζ 
ToList
ζζ 
(
ζζ 
)
ζζ 
;
ζζ 
if
ιι 
(
ιι 
AppStateTracker
ιι #
.
ιι# $
CurrentActivity
ιι$ 3
!=
ιι4 6
null
ιι7 ;
&&
ιι< >
	EndPeriod
ιι? H
>=
ιιI K
DateTime
ιιL T
.
ιιT U
Today
ιιU Z
&&
ιι[ ]

Activities
ιι^ h
.
ιιh i
Contains
ιιi q
(
ιιq r
AppStateTrackerιιr 
.ιι ‚
CurrentActivityιι‚ ‘
.ιι‘ ’
Nameιι’ –
)ιι– —
)ιι— 
ActivityHelper
κκ "
.
κκ" #
Add
κκ# &
(
κκ& '
new
κκ' *
Helper
κκ+ 1
{
λλ 
Name
μμ 
=
μμ 
AppStateTracker
μμ .
.
μμ. /
CurrentActivity
μμ/ >
.
μμ> ?
Name
μμ? C
,
μμC D
From
νν 
=
νν 
AppStateTracker
νν .
.
νν. /
CurrentActivity
νν/ >
.
νν> ?
From
νν? C
>
ννD E
StartPeriod
ννF Q
?
ννR S
AppStateTracker
ννT c
.
ννc d
CurrentActivity
ννd s
.
ννs t
From
ννt x
:
ννy z
StartPeriodνν{ †
,νν† ‡
To
ξξ 
=
ξξ 
DateTime
ξξ %
.
ξξ% &
Now
ξξ& )
}
οο 
)
οο 
;
οο 
List
ρρ 
<
ρρ 
Helper
ρρ 
>
ρρ 
WindowHelper
ρρ )
=
ρρ* +
new
ρρ, /
List
ρρ0 4
<
ρρ4 5
Helper
ρρ5 ;
>
ρρ; <
(
ρρ< =
)
ρρ= >
;
ρρ> ?
foreach
σσ 
(
σσ 
Helper
σσ 
h
σσ  !
in
σσ" $
ActivityHelper
σσ% 3
)
σσ3 4
{
ττ 
WindowHelper
υυ  
.
υυ  !
AddRange
υυ! )
(
υυ) *
Windows
φφ 
.
χχ 
Where
χχ 
(
χχ 
r
χχ  
=>
χχ! #
r
χχ$ %
.
χχ% &
To
χχ& (
>=
χχ) +
h
χχ, -
.
χχ- .
From
χχ. 2
&&
χχ3 5
r
χχ6 7
.
χχ7 8
From
χχ8 <
<=
χχ= ?
h
χχ@ A
.
χχA B
To
χχB D
)
χχD E
.
ψψ 
Select
ψψ 
(
ψψ  
r
ψψ  !
=>
ψψ" $
new
ψψ% (
Helper
ψψ) /
{
ωω 
Name
ϊϊ  
=
ϊϊ! "
r
ϊϊ# $
.
ϊϊ$ %
Name
ϊϊ% )
,
ϊϊ) *
From
ϋϋ  
=
ϋϋ! "
r
ϋϋ# $
.
ϋϋ$ %
From
ϋϋ% )
>
ϋϋ* +
h
ϋϋ, -
.
ϋϋ- .
From
ϋϋ. 2
?
ϋϋ3 4
r
ϋϋ5 6
.
ϋϋ6 7
From
ϋϋ7 ;
:
ϋϋ< =
h
ϋϋ> ?
.
ϋϋ? @
From
ϋϋ@ D
,
ϋϋD E
To
όό 
=
όό  
(
όό! "
DateTime
όό" *
)
όό* +
(
όό+ ,
r
όό, -
.
όό- .
To
όό. 0
>
όό1 2
h
όό3 4
.
όό4 5
To
όό5 7
?
όό8 9
h
όό: ;
.
όό; <
To
όό< >
:
όό? @
r
όόA B
.
όόB C
To
όόC E
)
όόE F
}
ύύ 
)
ύύ 
)
ύύ 
;
ύύ 
if
€€ 
(
€€ 
AppStateTracker
€€ '
.
€€' (
CurrentWindow
€€( 5
!=
€€6 8
null
€€9 =
)
€€= >
WindowHelper
 $
.
$ %
Add
% (
(
( )
new
) ,
Helper
- 3
{
‚‚ 
Name
ƒƒ  
=
ƒƒ! "
AppStateTracker
ƒƒ# 2
.
ƒƒ2 3
CurrentWindow
ƒƒ3 @
.
ƒƒ@ A
Name
ƒƒA E
,
ƒƒE F
From
„„  
=
„„! "
AppStateTracker
„„# 2
.
„„2 3
CurrentWindow
„„3 @
.
„„@ A
From
„„A E
<
„„F G
h
„„H I
.
„„I J
From
„„J N
?
„„O P
h
„„Q R
.
„„R S
From
„„S W
:
„„X Y
AppStateTracker
„„Z i
.
„„i j
CurrentWindow
„„j w
.
„„w x
From
„„x |
,
„„| }
To
…… 
=
……  
h
……! "
.
……" #
To
……# %
}
†† 
)
†† 
;
†† 
}
‡‡ 
foreach
 
(
 
Helper
 
h
  !
in
" $
WindowHelper
% 1
)
1 2
{
‹‹ 
h
 
.
 
Time
 
=
 
Math
 !
.
! "
Max
" %
(
% &
Math
& *
.
* +
Round
+ 0
(
0 1
(
1 2
h
2 3
.
3 4
To
4 6
-
7 8
h
9 :
.
: ;
From
; ?
)
? @
.
@ A

TotalHours
A K
,
K L
$num
M N
)
N O
,
O P
$num
Q R
)
R S
;
S T
}
 
List
 
<
 
Piedata
 
>
 
PiedataHelper
 +
=
, -
WindowHelper
. :
.
‘‘ 
GroupBy
‘‘ 
(
‘‘ 
h
‘‘ 
=>
‘‘ !
h
‘‘" #
.
‘‘# $
Name
‘‘$ (
)
‘‘( )
.
’’ 
Select
’’ 
(
’’ 
g
’’ 
=>
’’  
new
’’! $
Piedata
’’% ,
{
““ 
Label
”” 
=
”” 
g
””  !
.
””! "
Key
””" %
,
””% &
Value
•• 
=
•• 
g
••  !
.
••! "
Sum
••" %
(
••% &
h
••& '
=>
••( *
h
••+ ,
.
••, -
Time
••- 1
)
••1 2
}
–– 
)
–– 
.
—— 
OrderByDescending
—— &
(
——& '
p
——' (
=>
——) +
p
——, -
.
——- .
Value
——. 3
)
——3 4
.
 
ToList
 
(
 
)
 
;
 
Piedata
 
Others
 
=
  
new
! $
Piedata
% ,
{
›› 
Label
 
=
 
$str
 $
,
$ %
Value
 
=
 
$num
 
}
 
;
 
List
 
<
 
Piedata
 
>
 
Piedata
 %
=
& '
new
( +
List
, 0
<
0 1
Piedata
1 8
>
8 9
(
9 :
)
: ;
;
; <
for
΅΅ 
(
΅΅ 
int
΅΅ 
i
΅΅ 
=
΅΅ 
$num
΅΅ 
;
΅΅ 
i
΅΅  !
<
΅΅" #
PiedataHelper
΅΅$ 1
.
΅΅1 2
Count
΅΅2 7
;
΅΅7 8
i
΅΅9 :
++
΅΅: <
)
΅΅< =
{
ΆΆ 
if
££ 
(
££ 
i
££ 
<
££ 
$num
££ 
)
££ 
{
¤¤ 
Piedata
¥¥ 
.
¥¥  
Add
¥¥  #
(
¥¥# $
PiedataHelper
¥¥$ 1
[
¥¥1 2
i
¥¥2 3
]
¥¥3 4
)
¥¥4 5
;
¥¥5 6
}
¦¦ 
else
¦¦ 
{
§§ 
Others
¨¨ 
.
¨¨ 
Value
¨¨ $
+=
¨¨% '
PiedataHelper
¨¨( 5
[
¨¨5 6
i
¨¨6 7
]
¨¨7 8
.
¨¨8 9
Value
¨¨9 >
;
¨¨> ?
}
©© 
}
 
Piedata
¬¬ 
.
¬¬ 
Add
¬¬ 
(
¬¬ 
Others
¬¬ "
)
¬¬" #
;
¬¬# $
Json
®® 
=
®® 
JsonConvert
®® "
.
®®" #
SerializeObject
®®# 2
(
®®2 3
new
®®3 6
{
®®7 8
value
®®9 >
=
®®? @
Piedata
®®A H
,
®®H I
counter
®®J Q
}
®®R S
)
®®S T
;
®®T U
}
―― 
)
―― 
;
―― "
GetReportData3Thread
±±  
=
±±! "
null
±±# '
;
±±' (
tcs
²² 
.
²² 
	SetResult
²² 
(
²² 
Json
²² 
)
²² 
;
²²  
return
³³ 
tcs
³³ 
.
³³ 
Task
³³ 
.
³³ 
Result
³³ "
;
³³" #
}
΄΄ 	
public
¶¶ 
string
¶¶ 
GetReportData3
¶¶ $
(
¶¶$ %
List
¶¶% )
<
¶¶) *
Object
¶¶* 0
>
¶¶0 1

activities
¶¶2 <
,
¶¶< =
string
¶¶> D
start
¶¶E J
,
¶¶J K
string
¶¶L R
end
¶¶S V
,
¶¶V W
int
¶¶X [
counter
¶¶\ c
)
¶¶c d
{
·· 	
if
ΈΈ 
(
ΈΈ "
GetReportData3Thread
ΈΈ $
!=
ΈΈ% '
null
ΈΈ( ,
)
ΈΈ, -
{
ΉΉ "
GetReportData3Thread
ΊΊ $
.
ΊΊ$ %
Abort
ΊΊ% *
(
ΊΊ* +
)
ΊΊ+ ,
;
ΊΊ, -"
GetReportData3Thread
»» $
=
»»% &
null
»»' +
;
»»+ ,
}
ΌΌ 
var
ΎΎ 
task
ΎΎ 
=
ΎΎ !
GetReportData3Async
ΎΎ *
(
ΎΎ* +

activities
ΎΎ+ 5
,
ΎΎ5 6
start
ΎΎ7 <
,
ΎΎ< =
end
ΎΎ> A
,
ΎΎA B
counter
ΎΎC J
)
ΎΎJ K
;
ΎΎK L
return
ΐΐ 
task
ΐΐ 
.
ΐΐ 
Result
ΐΐ 
;
ΐΐ 
}
ΑΑ 	
private
ΓΓ 
IEnumerable
ΓΓ 
<
ΓΓ 
DateTime
ΓΓ $
>
ΓΓ$ %
EachDay
ΓΓ& -
(
ΓΓ- .
DateTime
ΓΓ. 6
from
ΓΓ7 ;
,
ΓΓ; <
DateTime
ΓΓ= E
thru
ΓΓF J
)
ΓΓJ K
{
ΔΔ 	
for
ΕΕ 
(
ΕΕ 
var
ΕΕ 
day
ΕΕ 
=
ΕΕ 
from
ΕΕ 
.
ΕΕ  
Date
ΕΕ  $
;
ΕΕ$ %
day
ΕΕ& )
.
ΕΕ) *
Date
ΕΕ* .
<=
ΕΕ/ 1
thru
ΕΕ2 6
.
ΕΕ6 7
Date
ΕΕ7 ;
;
ΕΕ; <
day
ΕΕ= @
=
ΕΕA B
day
ΕΕC F
.
ΕΕF G
AddDays
ΕΕG N
(
ΕΕN O
$num
ΕΕO P
)
ΕΕP Q
)
ΕΕQ R
yield
ΖΖ 
return
ΖΖ 
day
ΖΖ  
;
ΖΖ  !
}
ΗΗ 	
}
ΘΘ 
}ΚΚ ύ
SC:\Users\robin\source\repos\WindowsTimeTracker\TimeTracker\Helper\Models\Piedata.cs
	namespace 	
TimeTracker
 
. 
Helper 
. 
Models #
{		 
class

 	
Piedata


 
{ 
[ 	
JsonProperty	 
( 
PropertyName "
=# $
$str% ,
), -
]- .
public 
string 
Label 
{ 
get !
;! "
set# &
;& '
}( )
[ 	
JsonProperty	 
( 
PropertyName "
=# $
$str% ,
), -
]- .
public 
double 
Value 
{ 
get !
;! "
set# &
;& '
}( )
} 
} ™
\C:\Users\robin\source\repos\WindowsTimeTracker\TimeTracker\Helper\Models\TrackingSettings.cs
	namespace 	
TimeTracker
 
. 
Helper 
. 
Models #
{		 
class

 	
TrackingSettings


 
{ 
[ 	
JsonProperty	 
( 
PropertyName "
=# $
$str% 0
)0 1
]1 2
public 
List 
< 
string 
> 
	Blacklist %
{& '
get( +
;+ ,
set- 0
;0 1
}2 3
} 
} §	
SC:\Users\robin\source\repos\WindowsTimeTracker\TimeTracker\Helper\Models\Dataset.cs
	namespace 	
TimeTracker
 
. 
Helper 
. 
Models #
{		 
class

 	
Dataset


 
{ 
[ 	
JsonProperty	 
( 
PropertyName "
=# $
$str% ,
), -
]- .
public 
string 
Title 
{ 
get !
;! "
set# &
;& '
}( )
[ 	
JsonProperty	 
( 
PropertyName "
=# $
$str% ,
), -
]- .
public 
double 
Value 
{ 
get !
;! "
set# &
;& '
}( )
[ 	
JsonProperty	 
( 
PropertyName "
=# $
$str% ,
), -
]- .
public 
string 
Color 
{ 
get !
;! "
set# &
;& '
}( )
} 
} ±
SC:\Users\robin\source\repos\WindowsTimeTracker\TimeTracker\Helper\Models\Bardata.cs
	namespace 	
TimeTracker
 
. 
Helper 
. 
Models #
{		 
class

 	
Bardata


 
{ 
[ 	
JsonProperty	 
( 
PropertyName "
=# $
$str% ,
), -
]- .
public 
string 
Label 
{ 
get !
;! "
set# &
;& '
}( )
[ 	
JsonProperty	 
( 
PropertyName "
=# $
$str% /
)/ 0
]0 1
public 
List 
< 
Dataset 
> 
Datasets %
{& '
get( +
;+ ,
set- 0
;0 1
}2 3
} 
} ά
TC:\Users\robin\source\repos\WindowsTimeTracker\TimeTracker\Helper\Models\Settings.cs
	namespace 	
TimeTracker
 
. 
Helper 
. 
Models #
{		 
public

 

class

 
Settings

 
{ 
[ 	
JsonProperty	 
( 
PropertyName "
=# $
$str% 6
)6 7
]7 8
public 
bool 
OfflineTracking #
{$ %
get& )
;) *
set+ .
;. /
}0 1
[ 	
JsonProperty	 
( 
PropertyName "
=# $
$str% >
)> ?
]? @
public 
long #
TimeNotificationVisible +
{, -
get. 1
;1 2
set3 6
;6 7
}8 9
[ 	
JsonProperty	 
( 
PropertyName "
=# $
$str% <
)< =
]= >
public 
bool !
PlayNotificationSound )
{* +
get, /
;/ 0
set1 4
;4 5
}6 7
[ 	
JsonProperty	 
( 
PropertyName "
=# $
$str% ;
); <
]< =
public 
long  
TimeSinceAppLastUsed (
{) *
get+ .
;. /
set0 3
;3 4
}5 6
[ 	
JsonProperty	 
( 
PropertyName "
=# $
$str% <
)< =
]= >
public 
long !
TimeBeforeAskingAgain )
{* +
get, /
;/ 0
set1 4
;4 5
}6 7
[ 	
JsonProperty	 
( 
PropertyName "
=# $
$str% .
). /
]/ 0
public 
List 
< 
int 
> 
Hotkeys  
{! "
get# &
;& '
set( +
;+ ,
}- .
[ 	
JsonProperty	 
( 
PropertyName "
=# $
$str% 5
)5 6
]6 7
public 
bool 
HotkeyDisabled "
{# $
get% (
;( )
set* -
;- .
}/ 0
}   
}!! ’

TC:\Users\robin\source\repos\WindowsTimeTracker\TimeTracker\Helper\Models\Timeline.cs
	namespace 	
TimeTracker
 
. 
Helper 
. 
Models #
{		 
class

 	
Timeline


 
{ 
[ 	
JsonProperty	 
( 
PropertyName "
=# $
$str% ,
), -
]- .
public 
string 
Label 
{ 
get !
;! "
set# &
;& '
}( )
[ 	
JsonProperty	 
( 
PropertyName "
=# $
$str% -
)- .
]. /
public 
List 
< 
TimelineValue !
>! "
Values# )
{* +
get, /
;/ 0
set1 4
;4 5
}6 7
[ 	
JsonProperty	 
( 
PropertyName "
=# $
$str% -
)- .
]. /
public 
List 
< 
string 
> 
Colors "
{# $
get% (
;( )
set* -
;- .
}/ 0
} 
} ΄	
YC:\Users\robin\source\repos\WindowsTimeTracker\TimeTracker\Helper\Models\TimelineValue.cs
	namespace 	
TimeTracker
 
. 
Helper 
. 
Models #
{		 
class

 	
TimelineValue


 
{ 
[ 	
JsonProperty	 
( 
PropertyName "
=# $
$str% ,
), -
]- .
public 
double 
Start 
{ 
get !
;! "
set# &
;& '
}( )
[ 	
JsonProperty	 
( 
PropertyName "
=# $
$str% -
)- .
]. /
public 
double 
Length 
{ 
get "
;" #
set$ '
;' (
}) *
[ 	
JsonProperty	 
( 
PropertyName "
=# $
$str% ,
), -
]- .
public 
string 
Title 
{ 
get !
;! "
set# &
;& '
}( )
} 
} §
QC:\Users\robin\source\repos\WindowsTimeTracker\TimeTracker\HTMLDataWindow.xaml.cs
	namespace 	
TimeTracker
 
{		 
public 

partial 
class 
HTMLDataWindow '
:( )
System* 0
.0 1
Windows1 8
.8 9
Window9 ?
{ 
public 
ChromiumWebBrowser !
ChromeBrowser" /
;/ 0
public 
HTMLDataWindow 
( 
StorageHandler ,
storageHandler- ;
,; <
AppStateTracker= L
appStateTrackerM \
)\ ]
{ 	
InitializeComponent 
(  
)  !
;! "
InitializeChromium 
( 
storageHandler -
,- .
appStateTracker/ >
)> ?
;? @
} 	
public 
void 
InitializeChromium &
(& '
StorageHandler' 5
storageHandler6 D
,D E
AppStateTrackerF U
appStateTrackerV e
)e f
{ 	
string 
CurrentDirectory #
=$ %
	AppDomain& /
./ 0
CurrentDomain0 =
.= >
BaseDirectory> K
;K L
if 
( 
! 
Cef 
. 
IsInitialized "
)" #
{ 
CefSettings 
Settings $
=% &
new' *
CefSettings+ 6
(6 7
)7 8
;8 9
Settings 
. #
IgnoreCertificateErrors 0
=1 2
true3 7
;7 8
Settings 
. !
BrowserSubprocessPath .
=/ 0
String1 7
.7 8
Format8 >
(> ?
$str? b
,b c
CurrentDirectoryd t
)t u
;u v
Cef!! 
.!! 

Initialize!! 
(!! 
Settings!! '
,!!' ("
performDependencyCheck!!) ?
:!!? @
false!!A F
,!!F G!
browserProcessHandler!!H ]
:!!] ^
null!!_ c
)!!c d
;!!d e
}"" 
String$$ 
Page$$ 
=$$ 
string$$  
.$$  !
Format$$! '
($$' (
$str$$( 9
,$$9 :
CurrentDirectory$$; K
)$$K L
;$$L M
ChromeBrowser%% 
=%% 
new%% 
ChromiumWebBrowser%%  2
(%%2 3
Page%%3 7
)%%7 8
;%%8 9
ChromeBrowser(( 
.(( 
Dock(( 
=((  
	DockStyle((! *
.((* +
Fill((+ /
;((/ 0
BrowserSettings++ 
BrowserSettings++ +
=++, -
new++. 1
BrowserSettings++2 A
(++A B
)++B C
;++C D
BrowserSettings,, 
.,, "
FileAccessFromFileUrls,, 2
=,,3 4
CefState,,5 =
.,,= >
Enabled,,> E
;,,E F
BrowserSettings-- 
.-- '
UniversalAccessFromFileUrls-- 7
=--8 9
CefState--: B
.--B C
Enabled--C J
;--J K
ChromeBrowser.. 
... 
BrowserSettings.. )
=..* +
BrowserSettings.., ;
;..; <
ChromeBrowser// 
.// &
JavascriptObjectRepository// 4
.//4 5
Register//5 =
(//= >
$str//> J
,//J K
new//L O
MyScriptingClass//P `
(//` a
storageHandler//a o
,//o p
appStateTracker	//q €
)
//€ 
,
// ‚
true
//ƒ ‡
)
//‡ 
;
// ‰
WindowsFormsHost33 
.33 
Child33 "
=33# $
ChromeBrowser33% 2
;332 3
}44 	
}55 
}66 ›£
SC:\Users\robin\source\repos\WindowsTimeTracker\TimeTracker\Logic\AppStateTracker.cs
	namespace 	
TimeTracker
 
{		 
public 

class 
AppStateTracker  
{ 
public 
delegate 
void 
CustomEventDelegate 0
(0 1
object1 7
sender8 >
,> ?
CustomEventArgs@ O
argsP T
)T U
;U V
public 
event 
CustomEventDelegate (
ChangeContextMenu) :
;: ;
public 
const 
string 
Version #
=$ %
$str& /
;/ 0
public 
IDictionary 
< 
string !
,! "
DateTime# +
>+ ,
WindowsLastSeen- <
{= >
get? B
;B C
setD G
;G H
}I J
public 
Nullable 
< 
DateTime  
>  !
LastConfirmed" /
{0 1
get2 5
;5 6
set7 :
;: ;
}< =
public 
Window 
CurrentWindow #
{$ %
get& )
;) *
set+ .
;. /
}0 1
public 
Activity 
CurrentActivity '
{( )
get* -
;- .
set/ 2
;2 3
}4 5
public 
DateTime 
? 

LastLocked #
{$ %
get& )
;) *
set+ .
;. /
}0 1
public 
bool 
Paused 
{ 
get  
;  !
set" %
;% &
}' (
public 
bool 
Disturb 
{ 
get !
;! "
set# &
;& '
}( )
private!! 

Dictionary!! 
<!! 
string!! !
,!!! "
List!!# '
<!!' (
string!!( .
>!!. /
>!!/ 0
Colors!!1 7
{!!8 9
get!!: =
;!!= >
set!!? B
;!!B C
}!!D E
public"" 

Dictionary"" 
<"" 
string""  
,""  !
string""" (
>""( )
ColorAssingments""* :
{""; <
get""= @
;""@ A
set""B E
;""E F
}""G H
private$$ 
StorageHandler$$ 
StorageHandler$$ -
;$$- .
public,, 
AppStateTracker,, 
(,, 
StorageHandler,, -
storageHandler,,. <
),,< =
{-- 	
WindowsLastSeen.. 
=.. 
new.. !

Dictionary.." ,
<.., -
string..- 3
,..3 4
DateTime..5 =
>..= >
(..> ?
)..? @
;..@ A
LastConfirmed// 
=// 
null//  
;//  !
CurrentWindow00 
=00 
null00  
;00  !
CurrentActivity11 
=11 
null11 "
;11" #

LastLocked22 
=22 
null22 
;22 
Paused33 
=33 
false33 
;33 
Disturb44 
=44 
true44 
;44 
StorageHandler55 
=55 
storageHandler55 +
;55+ ,
Colors77 
=77 
new77 

Dictionary77 #
<77# $
string77$ *
,77* +
List77, 0
<770 1
string771 7
>777 8
>778 9
(779 :
)77: ;
;77; <
Colors:: 
.:: 
Add:: 
(:: 
$str::  
,::  !
new::" %
List::& *
<::* +
string::+ 1
>::1 2
{;; 
$str<< 
,<< 
$str== 
,== 
$str>> 
,>> 
$str?? 
,?? 
}@@ 
)@@ 
;@@ 
ColorsCC 
.CC 
AddCC 
(CC 
$strCC  
,CC  !
newCC" %
ListCC& *
<CC* +
stringCC+ 1
>CC1 2
{DD 
$strEE 
,EE 
$strFF 
,FF 
$strGG 
,GG 
$strHH 
}II 
)II 
;II 
ColorsLL 
.LL 
AddLL 
(LL 
$strLL  
,LL  !
newLL" %
ListLL& *
<LL* +
stringLL+ 1
>LL1 2
{MM 
$strNN 
,NN 
$strOO 
,OO 
$strPP 
,PP 
$strQQ 
}RR 
)RR 
;RR 
ColorsUU 
.UU 
AddUU 
(UU 
$strUU  
,UU  !
newUU" %
ListUU& *
<UU* +
stringUU+ 1
>UU1 2
{VV 
$strWW 
,WW 
$strXX 
,XX 
$strYY 
,YY 
$strZZ 
}[[ 
)[[ 
;[[ 
Colors^^ 
.^^ 
Add^^ 
(^^ 
$str^^  
,^^  !
new^^" %
List^^& *
<^^* +
string^^+ 1
>^^1 2
{__ 
$str`` 
,`` 
$straa 
,aa 
$strbb 
,bb 
$strcc 
}dd 
)dd 
;dd 
Colorsgg 
.gg 
Addgg 
(gg 
$strgg  
,gg  !
newgg" %
Listgg& *
<gg* +
stringgg+ 1
>gg1 2
{hh 
$strii 
,ii 
$strjj 
,jj 
$strkk 
,kk 
$strll 
}mm 
)mm 
;mm 
Colorspp 
.pp 
Addpp 
(pp 
$strpp  
,pp  !
newpp" %
Listpp& *
<pp* +
stringpp+ 1
>pp1 2
{qq 
$strrr 
,rr 
$strss 
,ss 
$strtt 
,tt 
$struu 
}vv 
)vv 
;vv 
Colorsyy 
.yy 
Addyy 
(yy 
$stryy  
,yy  !
newyy" %
Listyy& *
<yy* +
stringyy+ 1
>yy1 2
{zz 
$str{{ 
,{{ 
$str|| 
,|| 
$str}} 
,}} 
$str~~ 
} 
) 
; 
Colors
‚‚ 
.
‚‚ 
Add
‚‚ 
(
‚‚ 
$str
‚‚  
,
‚‚  !
new
‚‚" %
List
‚‚& *
<
‚‚* +
string
‚‚+ 1
>
‚‚1 2
{
ƒƒ 
$str
„„ 
,
„„ 
$str
…… 
,
…… 
$str
†† 
,
†† 
$str
‡‡ 
}
 
)
 
;
 
Colors
‹‹ 
.
‹‹ 
Add
‹‹ 
(
‹‹ 
$str
‹‹  
,
‹‹  !
new
‹‹" %
List
‹‹& *
<
‹‹* +
string
‹‹+ 1
>
‹‹1 2
{
 
$str
 
,
 
$str
 
,
 
$str
 
,
 
$str
 
}
‘‘ 
)
‘‘ 
;
‘‘ 
Colors
”” 
.
”” 
Add
”” 
(
”” 
$str
””  
,
””  !
new
””" %
List
””& *
<
””* +
string
””+ 1
>
””1 2
{
•• 
$str
–– 
,
–– 
$str
—— 
,
—— 
$str
 
,
 
$str
™™ 
}
 
)
 
;
 
Colors
 
.
 
Add
 
(
 
$str
  
,
  !
new
" %
List
& *
<
* +
string
+ 1
>
1 2
{
 
$str
 
,
 
$str
   
,
   
$str
΅΅ 
,
΅΅ 
$str
ΆΆ 
}
££ 
)
££ 
;
££ 
AssignColors
¥¥ 
(
¥¥ 
)
¥¥ 
;
¥¥ 
}
¦¦ 	
public
®® 
void
®® 
Pause
®® 
(
®® 
bool
®® 
?
®® 
setPause
®®  (
)
®®( )
{
―― 	
if
°° 
(
°° 
setPause
°° 
!=
°° 
null
°°  
)
°°  !
{
±± 
if
²² 
(
²² 
setPause
²² 
==
²² 
true
²²  $
)
²²$ %
{
³³ 
SaveCurrentWindow
΄΄ %
(
΄΄% &
)
΄΄& '
;
΄΄' (!
SaveCurrentActivity
µµ '
(
µµ' (
)
µµ( )
;
µµ) *
ChangeContextMenu
¶¶ %
?
¶¶% &
.
¶¶& '
Invoke
¶¶' -
(
¶¶- .
this
¶¶. 2
,
¶¶2 3
new
¶¶4 7
CustomEventArgs
¶¶8 G
(
¶¶G H
true
¶¶H L
)
¶¶L M
)
¶¶M N
;
¶¶N O
Paused
·· 
=
·· 
true
·· !
;
··! "
}
ΈΈ 
else
ΉΉ 
{
ΊΊ 
ChangeContextMenu
»» %
?
»»% &
.
»»& '
Invoke
»»' -
(
»»- .
this
»». 2
,
»»2 3
new
»»4 7
CustomEventArgs
»»8 G
(
»»G H
false
»»H M
)
»»M N
)
»»N O
;
»»O P
Paused
ΌΌ 
=
ΌΌ 
false
ΌΌ "
;
ΌΌ" #
}
½½ 
}
ΎΎ 
else
ΏΏ 
{
ΐΐ 
if
ΑΑ 
(
ΑΑ 
Paused
ΑΑ 
)
ΑΑ 
{
ΒΒ 
ChangeContextMenu
ΓΓ %
?
ΓΓ% &
.
ΓΓ& '
Invoke
ΓΓ' -
(
ΓΓ- .
this
ΓΓ. 2
,
ΓΓ2 3
new
ΓΓ4 7
CustomEventArgs
ΓΓ8 G
(
ΓΓG H
false
ΓΓH M
)
ΓΓM N
)
ΓΓN O
;
ΓΓO P
Paused
ΔΔ 
=
ΔΔ 
false
ΔΔ "
;
ΔΔ" #
}
ΕΕ 
else
ΖΖ 
{
ΗΗ 
SaveCurrentWindow
ΘΘ %
(
ΘΘ% &
)
ΘΘ& '
;
ΘΘ' (!
SaveCurrentActivity
ΙΙ '
(
ΙΙ' (
)
ΙΙ( )
;
ΙΙ) *
ChangeContextMenu
ΚΚ %
?
ΚΚ% &
.
ΚΚ& '
Invoke
ΚΚ' -
(
ΚΚ- .
this
ΚΚ. 2
,
ΚΚ2 3
new
ΚΚ4 7
CustomEventArgs
ΚΚ8 G
(
ΚΚG H
true
ΚΚH L
)
ΚΚL M
)
ΚΚM N
;
ΚΚN O
Paused
ΛΛ 
=
ΛΛ 
true
ΛΛ !
;
ΛΛ! "
}
ΜΜ 
}
ΝΝ 
}
ΞΞ 	
public
ΧΧ 
Window
ΧΧ !
CreateCurrentWindow
ΧΧ )
(
ΧΧ) *
string
ΧΧ* 0
name
ΧΧ1 5
,
ΧΧ5 6
string
ΧΧ7 =
details
ΧΧ> E
)
ΧΧE F
{
ΨΨ 	
Window
ΩΩ 
Window
ΩΩ 
=
ΩΩ 
new
ΩΩ 
Window
ΩΩ  &
(
ΩΩ& '
)
ΩΩ' (
;
ΩΩ( )
Window
ΪΪ 
.
ΪΪ 
Name
ΪΪ 
=
ΪΪ 
name
ΪΪ 
;
ΪΪ 
Window
ΫΫ 
.
ΫΫ 
Details
ΫΫ 
=
ΫΫ 
details
ΫΫ $
;
ΫΫ$ %
Window
άά 
.
άά 
From
άά 
=
άά 
DateTime
άά "
.
άά" #
Now
άά# &
;
άά& '
CurrentWindow
ήή 
=
ήή 
Window
ήή "
;
ήή" #
return
ΰΰ 
Window
ΰΰ 
;
ΰΰ 
}
αα 	
public
κκ 
Activity
κκ #
CreateCurrentActivity
κκ -
(
κκ- .
string
κκ. 4
name
κκ5 9
=
κκ: ;
null
κκ< @
,
κκ@ A
DateTime
κκB J
?
κκJ K
from
κκL P
=
κκQ R
null
κκS W
)
κκW X
{
λλ 	
Activity
μμ 
Activity
μμ 
=
μμ 
new
μμ  #
Activity
μμ$ ,
(
μμ, -
)
μμ- .
;
μμ. /
Activity
νν 
.
νν 
From
νν 
=
νν 
from
νν  
??
νν! #
DateTime
νν$ ,
.
νν, -
Now
νν- 0
;
νν0 1
if
οο 
(
οο 
name
οο 
==
οο 
null
οο 
)
οο 
Activity
ππ 
.
ππ 
Name
ππ 
=
ππ 
StorageHandler
ππ  .
.
ππ. /
GetLastActivity
ππ/ >
(
ππ> ?
)
ππ? @
?
ππ@ A
.
ππA B
Name
ππB F
??
ππG I
$str
ππJ L
;
ππL M
else
ρρ 
Activity
ςς 
.
ςς 
Name
ςς 
=
ςς 
name
ςς  $
;
ςς$ %
CurrentActivity
ττ 
=
ττ 
Activity
ττ &
;
ττ& '
return
φφ 
Activity
φφ 
;
φφ 
}
χχ 	
public
ώώ 
void
ώώ 
SaveCurrentWindow
ώώ %
(
ώώ% &
DateTime
ώώ& .
?
ώώ. /
to
ώώ0 2
=
ώώ3 4
null
ώώ5 9
)
ώώ9 :
{
 	
if
€€ 
(
€€ 
CurrentWindow
€€ 
==
€€  
null
€€! %
)
€€% &
return
 
;
 
CurrentWindow
ƒƒ 
.
ƒƒ 
To
ƒƒ 
=
ƒƒ 
to
ƒƒ !
??
ƒƒ" $
DateTime
ƒƒ% -
.
ƒƒ- .
Now
ƒƒ. 1
;
ƒƒ1 2
WindowsLastSeen
„„ 
[
„„ 
CurrentWindow
„„ )
.
„„) *
Name
„„* .
]
„„. /
=
„„0 1
(
„„2 3
DateTime
„„3 ;
)
„„; <
CurrentWindow
„„< I
.
„„I J
To
„„J L
;
„„L M
if
…… 
(
…… 
CurrentWindow
…… 
.
…… 
From
…… "
<=
……# %
CurrentWindow
……& 3
.
……3 4
To
……4 6
)
……6 7
StorageHandler
†† 
.
†† 
WriteWindow
†† *
(
††* +
CurrentWindow
††+ 8
)
††8 9
;
††9 :
CurrentWindow
 
=
 
null
  
;
  !
}
‰‰ 	
public
 
void
 !
SaveCurrentActivity
 '
(
' (
DateTime
( 0
?
0 1
to
2 4
=
5 6
null
7 ;
)
; <
{
‘‘ 	
if
’’ 
(
’’ 
CurrentActivity
’’ 
==
’’  "
null
’’# '
)
’’' (
return
““ 
;
““ 
CurrentActivity
•• 
.
•• 
To
•• 
=
••  
to
••! #
??
••$ &
DateTime
••' /
.
••/ 0
Now
••0 3
;
••3 4
if
—— 
(
—— 
CurrentActivity
—— 
.
——  
From
——  $
<=
——% '
CurrentActivity
——( 7
.
——7 8
To
——8 :
&&
——; =
(
——> ?
(
——? @
DateTime
——@ H
)
——H I
CurrentActivity
——I X
.
——X Y
To
——Y [
)
——[ \
.
——\ ]
Subtract
——] e
(
——e f
CurrentActivity
——f u
.
——u v
From
——v z
)
——z {
.
——{ |
TotalSeconds——| 
>=——‰ ‹
$num—— 
)—— 
StorageHandler
 
.
 
WriteActivity
 ,
(
, -
CurrentActivity
- <
)
< =
;
= >
CurrentActivity
 
=
 
null
 "
;
" #
AssignColors
 
(
 
)
 
;
 
}
 	
public
ΆΆ 
void
ΆΆ 
AssignColors
ΆΆ  
(
ΆΆ  !
)
ΆΆ! "
{
££ 	
List
¤¤ 
<
¤¤ 
string
¤¤ 
>
¤¤ 

ColorsList
¤¤ #
=
¤¤$ %
Colors
¤¤& ,
.
¤¤, -
Keys
¤¤- 1
.
¤¤1 2
ToList
¤¤2 8
(
¤¤8 9
)
¤¤9 :
;
¤¤: ;
int
¦¦ 
Counter
¦¦ 
=
¦¦ 
$num
¦¦ 
;
¦¦ 

Dictionary
§§ 
<
§§ 
string
§§ 
,
§§ 
int
§§ "
>
§§" #
Helper
§§$ *
=
§§+ ,
new
§§- 0

Dictionary
§§1 ;
<
§§; <
string
§§< B
,
§§B C
int
§§D G
>
§§G H
(
§§H I
)
§§I J
;
§§J K

Dictionary
¨¨ 
<
¨¨ 
string
¨¨ 
,
¨¨ 
string
¨¨ %
>
¨¨% &
Result
¨¨' -
=
¨¨. /
new
¨¨0 3

Dictionary
¨¨4 >
<
¨¨> ?
string
¨¨? E
,
¨¨E F
string
¨¨G M
>
¨¨M N
(
¨¨N O
)
¨¨O P
;
¨¨P Q
StorageHandler
 
.
 #
GetActivitiesByLambda
 0
(
0 1
a
1 2
=>
3 5
true
6 :
)
: ;
.
«« 
GroupBy
«« 
(
«« 
a
«« 
=>
«« 
a
«« 
.
««  
Name
««  $
)
««$ %
.
¬¬ 
Select
¬¬ 
(
¬¬ 
g
¬¬ 
=>
¬¬ 
g
¬¬ 
.
¬¬ 
Key
¬¬ "
)
¬¬" #
.
­­ 
ToList
­­ 
(
­­ 
)
­­ 
.
®® 
ForEach
®® 
(
®® 
name
®® 
=>
®®  
{
―― 
string
°° 
ActivityCategory
°° +
=
°°, -
name
°°. 2
.
°°2 3
Split
°°3 8
(
°°8 9
new
°°9 <
string
°°= C
[
°°C D
]
°°D E
{
°°F G
$str
°°H M
}
°°N O
,
°°O P 
StringSplitOptions
°°Q c
.
°°c d
None
°°d h
)
°°h i
.
°°i j
First
°°j o
(
°°o p
)
°°p q
;
°°q r
string
²² 
Color
²²  
;
²²  !
if
΄΄ 
(
΄΄ 
!
΄΄ 
Result
΄΄ 
.
΄΄  
ContainsKey
΄΄  +
(
΄΄+ ,
ActivityCategory
΄΄, <
)
΄΄< =
)
΄΄= >
{
µµ 
Color
¶¶ 
=
¶¶ 

ColorsList
¶¶  *
[
¶¶* +
Counter
¶¶+ 2
%
¶¶3 4

ColorsList
¶¶5 ?
.
¶¶? @
Count
¶¶@ E
]
¶¶E F
;
¶¶F G
Counter
·· 
=
··  !
Counter
··" )
+
··* +
$num
··, -
;
··- .
Helper
ΈΈ 
.
ΈΈ 
Add
ΈΈ "
(
ΈΈ" #
ActivityCategory
ΈΈ# 3
,
ΈΈ3 4
$num
ΈΈ5 6
)
ΈΈ6 7
;
ΈΈ7 8
Result
ΉΉ 
.
ΉΉ 
Add
ΉΉ "
(
ΉΉ" #
ActivityCategory
ΉΉ# 3
,
ΉΉ3 4
Color
ΉΉ5 :
)
ΉΉ: ;
;
ΉΉ; <
}
ΊΊ 
else
»» 
{
ΌΌ 
Color
½½ 
=
½½ 
Result
½½  &
[
½½& '
ActivityCategory
½½' 7
]
½½7 8
;
½½8 9
}
ΎΎ 
if
ΐΐ 
(
ΐΐ 
!
ΐΐ 
Result
ΐΐ 
.
ΐΐ  
ContainsKey
ΐΐ  +
(
ΐΐ+ ,
name
ΐΐ, 0
)
ΐΐ0 1
)
ΐΐ1 2
{
ΑΑ 
int
ΒΒ 
Index
ΒΒ !
=
ΒΒ" #
Helper
ΒΒ$ *
[
ΒΒ* +
ActivityCategory
ΒΒ+ ;
]
ΒΒ; <
;
ΒΒ< =
Result
ΓΓ 
.
ΓΓ 
Add
ΓΓ "
(
ΓΓ" #
name
ΓΓ# '
,
ΓΓ' (
Colors
ΓΓ) /
[
ΓΓ/ 0
Color
ΓΓ0 5
]
ΓΓ5 6
[
ΓΓ6 7
Index
ΓΓ7 <
%
ΓΓ= >
Colors
ΓΓ? E
.
ΓΓE F
Min
ΓΓF I
(
ΓΓI J
c
ΓΓJ K
=>
ΓΓL N
c
ΓΓO P
.
ΓΓP Q
Value
ΓΓQ V
.
ΓΓV W
Count
ΓΓW \
)
ΓΓ\ ]
]
ΓΓ] ^
)
ΓΓ^ _
;
ΓΓ_ `
Helper
ΔΔ 
[
ΔΔ 
ActivityCategory
ΔΔ /
]
ΔΔ/ 0
=
ΔΔ1 2
Index
ΔΔ3 8
+
ΔΔ9 :
$num
ΔΔ; <
;
ΔΔ< =
}
ΕΕ 
}
ΖΖ 
)
ΖΖ 
;
ΖΖ 
ColorAssingments
ΘΘ 
=
ΘΘ 
Result
ΘΘ %
;
ΘΘ% &
}
ΙΙ 	
}
ΚΚ 
}ΛΛ S
HC:\Users\robin\source\repos\WindowsTimeTracker\TimeTracker\Logic\ASDL.cs
	namespace 	
TimeTracker
 
{		 
public 

class 
ASDL 
{ 
public 
delegate 
void 
CustomEventDelegate 0
(0 1
object1 7
sender8 >
,> ?
CustomEventArgs@ O
argsP T
)T U
;U V
public 
event 
CustomEventDelegate (
ShowActivityDialog) ;
;; <
public 
event 
CustomEventDelegate ( 
ShowAwayFromPCDialog) =
;= >
private 
AppStateTracker 
AppStateTracker  /
;/ 0
public!! 
ASDL!! 
(!! 
AppStateTracker!! #
appStateTracker!!$ 3
,!!3 4!
ProgramSwitchListener!!5 J!
programSwitchListener!!K `
,!!` a 
MachineStateListener!!b v!
machineStateListener	!!w ‹
,
!!‹ 
HotkeyListener
!! ›
hotkeyListener
!! 
)
!! «
{"" 	
AppStateTracker## 
=## 
appStateTracker## -
;##- .!
programSwitchListener%% !
.%%! "
ProgramChanged%%" 0
+=%%1 3
ListenerEvent%%4 A
;%%A B 
machineStateListener&&  
.&&  !
StateChanged&&! -
+=&&. 0
ListenerEvent&&1 >
;&&> ?
hotkeyListener'' 
.'' !
KeyCombinationPressed'' 0
+=''1 3
ListenerEvent''4 A
;''A B
}(( 	
public00 
void00 "
ReattachHotkeyListener00 *
(00* +
HotkeyListener00+ 9
hotkeyListener00: H
)00H I
{11 	
hotkeyListener22 
.22 !
KeyCombinationPressed22 0
+=221 3
ListenerEvent224 A
;22A B
}33 	
private:: 
void:: 
ListenerEvent:: "
(::" #
object::# )
sender::* 0
,::0 1
CustomEventArgs::2 A
e::B C
)::C D
{;; 	
switch<< 
(<< 
sender<< 
.<< 
GetType<< "
(<<" #
)<<# $
.<<$ %
Name<<% )
)<<) *
{== 
case>> 
$str>> ,
:>>, -
if?? 
(?? 
ActivitySwitched?? (
(??( )
(??) *
string??* 0
)??0 1
e??1 2
.??2 3
Value??3 8
)??8 9
)??9 :
ChangeActivity@@ &
(@@& '
)@@' (
;@@( )
breakAA 
;AA 
caseBB 
$strBB +
:BB+ ,
ifCC 
(CC 
(CC 
boolCC 
)CC 
eCC 
.CC  
ValueCC  %
)CC% &
{DD 
ifEE 
(EE 
SettingsEE $
.EE$ %
DefaultEE% ,
.EE, -
OfflineTrackingEE- <
&&EE= ?
AppStateTrackerEE@ O
.EEO P

LastLockedEEP Z
!=EE[ ]
nullEE^ b
)EEb c
{FF  
ShowAwayFromPCDialogGG 0
?GG0 1
.GG1 2
InvokeGG2 8
(GG8 9
thisGG9 =
,GG= >
newGG? B
CustomEventArgsGGC R
(GGR S
AppStateTrackerGGS b
.GGb c

LastLockedGGc m
)GGm n
)GGn o
;GGo p
AppStateTrackerHH +
.HH+ ,

LastLockedHH, 6
=HH7 8
nullHH9 =
;HH= >
}II 
AppStateTrackerJJ '
.JJ' (
PauseJJ( -
(JJ- .
falseJJ. 3
)JJ3 4
;JJ4 5
}KK 
elseLL 
{MM 
AppStateTrackerNN '
.NN' (
PauseNN( -
(NN- .
trueNN. 2
)NN2 3
;NN3 4
AppStateTrackerOO '
.OO' (

LastLockedOO( 2
=OO3 4
DateTimeOO5 =
.OO= >
NowOO> A
;OOA B
}PP 
breakQQ 
;QQ 
caseRR 
$strRR %
:RR% &
ChangeActivitySS "
(SS" #
trueSS# '
)SS' (
;SS( )
breakTT 
;TT 
}UU 
}VV 	
private__ 
bool__ 
ActivitySwitched__ %
(__% &
string__& ,
windowTitle__- 8
)__8 9
{`` 	
ifaa 
(aa 
AppStateTrackeraa 
.aa  
Pausedaa  &
)aa& '
returnbb 
falsebb 
;bb 
stringdd 
[dd 
]dd 
SplitWindowTitledd %
=dd& '
windowTitledd( 3
.dd3 4
Splitdd4 9
(dd9 :
newdd: =
stringdd> D
[ddD E
]ddE F
{ddG H
$strddI M
}ddN O
,ddO P
StringSplitOptionsddQ c
.ddc d
Noneddd h
)ddh i
;ddi j
ifff 
(ff 
SplitWindowTitleff  
.ff  !
Lengthff! '
<ff( )
$numff* +
)ff+ ,
returngg 
falsegg 
;gg 
stringii 
ProgramTitleii 
=ii  !
SplitWindowTitleii" 2
.ii2 3
Lastii3 7
(ii7 8
)ii8 9
;ii9 :
stringjj 
WindowDetailsjj  
=jj! "
SplitWindowTitlejj# 3
.jj3 4
Lengthjj4 :
>jj; <
$numjj= >
?jj? @
stringjjA G
.jjG H
JoinjjH L
(jjL M
$strjjM Q
,jjQ R
SplitWindowTitlejjS c
.jjc d
Takejjd h
(jjh i
SplitWindowTitlejji y
.jjy z
Length	jjz €
-
jj ‚
$num
jjƒ „
)
jj„ …
)
jj… †
:
jj‡ 
$str
jj‰ ‹
;
jj‹ 
boolll 
HasBeenSeenll 
=ll 
falsell $
;ll$ %
DateTimemm 
LastSeenmm 
;mm 
longpp 
TimeNotUsedpp 
=pp 
Settingspp '
.pp' (
Defaultpp( /
.pp/ 0 
TimeSinceAppLastUsedpp0 D
*ppE F
$numppG I
*ppJ K
$numppL P
;ppP Q
longqq 
Timeout2qq 
=qq 
Settingsqq $
.qq$ %
Defaultqq% ,
.qq, -!
TimeBeforeAskingAgainqq- B
;qqB C
iftt 
(tt 
Settingstt 
.tt 
Defaulttt  
.tt  !
	Blacklisttt! *
.tt* +
Containstt+ 3
(tt3 4
ProgramTitlett4 @
)tt@ A
||ttB D
ProgramTitlettE Q
.ttQ R
ContainsttR Z
(ttZ [
$strtt[ _
)tt_ `
)tt` a
{uu 
ifvv 
(vv 
!vv 
windowTitlevv  
.vv  !
Equalsvv! '
(vv' (
$strvv( K
)vvK L
)vvL M
AppStateTrackerww #
.ww# $
SaveCurrentWindowww$ 5
(ww5 6
)ww6 7
;ww7 8
returnxx 
falsexx 
;xx 
}yy 
if|| 
(|| 
AppStateTracker|| 
.||  
WindowsLastSeen||  /
.||/ 0
TryGetValue||0 ;
(||; <
ProgramTitle||< H
,||H I
out||J M
LastSeen||N V
)||V W
)||W X
HasBeenSeen}} 
=}} 
TimeNotUsed}} )
>}}* +
DateTime}}, 4
.}}4 5
Now}}5 8
.}}8 9
Subtract}}9 A
(}}A B
LastSeen}}B J
)}}J K
.}}K L
TotalMilliseconds}}L ]
;}}] ^
if
€€ 
(
€€ 
AppStateTracker
€€ 
.
€€  
CurrentWindow
€€  -
!=
€€. 0
null
€€1 5
&&
€€6 8
AppStateTracker
€€9 H
.
€€H I
CurrentWindow
€€I V
.
€€V W
Name
€€W [
.
€€[ \
Equals
€€\ b
(
€€b c
ProgramTitle
€€c o
)
€€o p
)
€€p q
return
 
false
 
;
 
AppStateTracker
ƒƒ 
.
ƒƒ 
SaveCurrentWindow
ƒƒ -
(
ƒƒ- .
)
ƒƒ. /
;
ƒƒ/ 0
AppStateTracker
„„ 
.
„„ !
CreateCurrentWindow
„„ /
(
„„/ 0
ProgramTitle
„„0 <
,
„„< =
WindowDetails
„„> K
)
„„K L
;
„„L M
if
‡‡ 
(
‡‡ 
(
‡‡ 
AppStateTracker
‡‡  
.
‡‡  !
LastConfirmed
‡‡! .
==
‡‡/ 1
null
‡‡2 6
||
‡‡7 9
DateTime
‡‡: B
.
‡‡B C
Now
‡‡C F
.
‡‡F G
Subtract
‡‡G O
(
‡‡O P
(
‡‡P Q
DateTime
‡‡Q Y
)
‡‡Y Z
AppStateTracker
‡‡Z i
.
‡‡i j
LastConfirmed
‡‡j w
)
‡‡w x
.
‡‡x y
TotalSeconds‡‡y …
>‡‡† ‡
Timeout2‡‡ 
)‡‡ ‘
&&‡‡’ ”
!‡‡• –
HasBeenSeen‡‡– ΅
&&‡‡Ά ¤
AppStateTracker‡‡¥ ΄
.‡‡΄ µ
Disturb‡‡µ Ό
)‡‡Ό ½
{
 
return
‰‰ 
true
‰‰ 
;
‰‰ 
}
 
else
 
if
 
(
 
AppStateTracker
 $
.
$ %
CurrentActivity
% 4
==
5 7
null
8 <
)
< =
{
 
AppStateTracker
 
.
  #
CreateCurrentActivity
  5
(
5 6
)
6 7
;
7 8
}
 
return
‘‘ 
false
‘‘ 
;
‘‘ 
}
’’ 	
public
 
void
 
ChangeActivity
 "
(
" #
bool
# '

focusToast
( 2
=
3 4
false
5 :
)
: ;
{
™™ 	
AppStateTracker
 
.
 
Pause
 !
(
! "
false
" '
)
' (
;
( ) 
ShowActivityDialog
›› 
.
›› 
Invoke
›› %
(
››% &
this
››& *
,
››* +
new
››, /
CustomEventArgs
››0 ?
(
››? @

focusToast
››@ J
)
››J K
)
››K L
;
››L M
}
 	
}
 
} δ
LC:\Users\robin\source\repos\WindowsTimeTracker\TimeTracker\Blacklist.xaml.cs
	namespace 	
TimeTracker
 
{ 
public 

partial 
class 
	Blacklist "
:# $
UserControl% 0
{ 
public 
	Blacklist 
( 
) 
{ 	
InitializeComponent 
(  
)  !
;! "
} 	
} 
} δ
TC:\Users\robin\source\repos\WindowsTimeTracker\TimeTracker\Helper\CustomEventArgs.cs
	namespace 	
TimeTracker
 
{ 
public 

class 
CustomEventArgs  
:! "
	EventArgs# ,
{		 
public

 
object

 
Value

 
{

 
get

 !
;

! "
}

# $
public 
CustomEventArgs 
( 
)  
{ 	
} 	
public 
CustomEventArgs 
( 
object %
value& +
)+ ,
{ 	
Value 
= 
value 
; 
} 	
} 
} φ
UC:\Users\robin\source\repos\WindowsTimeTracker\TimeTracker\Helper\Storage\Activity.cs
	namespace		 	
TimeTracker		
 
.		 
Helper		 
{

 
public 

class 
Activity 
{ 
public 
string 
Name 
{ 
get  
;  !
set" %
;% &
}' (
public 
DateTime 
From 
{ 
get "
;" #
set$ '
;' (
}) *
public 
DateTime 
? 
To 
{ 
get !
;! "
set# &
;& '
}( )
} 
} ‰H
\C:\Users\robin\source\repos\WindowsTimeTracker\TimeTracker\Logic\Listeners\HotkeyListener.cs
	namespace		 	
TimeTracker		
 
{

 
public 

class 
HotkeyListener 
:  !
IDisposable" -
{ 
private 
delegate 
IntPtr  
LowLevelKeyboardProc  4
(4 5
int5 8
nCode9 >
,> ?
IntPtr@ F
wParamG M
,M N
IntPtrO U
lParamV \
)\ ]
;] ^
public 
delegate 
void 
CustomEventDelegate 0
(0 1
object1 7
sender8 >
,> ?
CustomEventArgs@ O
argsP T
)T U
;U V
[ 	
	DllImport	 
( 
$str 
,  
CharSet! (
=) *
CharSet+ 2
.2 3
Auto3 7
,7 8
SetLastError9 E
=F G
trueH L
)L M
]M N
private 
static 
extern 
IntPtr $
SetWindowsHookEx% 5
(5 6
int6 9
idHook: @
,@ A 
LowLevelKeyboardProcB V
lpfnW [
,[ \
IntPtr] c
hModd h
,h i
uintj n

dwThreadIdo y
)y z
;z {
[ 	
	DllImport	 
( 
$str 
,  
CharSet! (
=) *
CharSet+ 2
.2 3
Auto3 7
,7 8
SetLastError9 E
=F G
trueH L
)L M
]M N
[ 	
return	 
: 
	MarshalAs 
( 
UnmanagedType (
.( )
Bool) -
)- .
]. /
private 
static 
extern 
bool "
UnhookWindowsHookEx# 6
(6 7
IntPtr7 =
hhk> A
)A B
;B C
[ 	
	DllImport	 
( 
$str 
,  
CharSet! (
=) *
CharSet+ 2
.2 3
Auto3 7
,7 8
SetLastError9 E
=F G
trueH L
)L M
]M N
private 
static 
extern 
IntPtr $
CallNextHookEx% 3
(3 4
IntPtr4 :
hhk; >
,> ?
int@ C
nCodeD I
,I J
IntPtrK Q
wParamR X
,X Y
IntPtrZ `
lParama g
)g h
;h i
[!! 	
	DllImport!!	 
(!! 
$str!! !
,!!! "
CharSet!!# *
=!!+ ,
CharSet!!- 4
.!!4 5
Auto!!5 9
,!!9 :
SetLastError!!; G
=!!H I
true!!J N
)!!N O
]!!O P
private"" 
static"" 
extern"" 
IntPtr"" $
GetModuleHandle""% 4
(""4 5
string""5 ;
lpModuleName""< H
)""H I
;""I J
public%% 
event%% 
CustomEventDelegate%% (!
KeyCombinationPressed%%) >
;%%> ?
private(( 
const(( 
int(( 
WH_KEYBOARD_LL(( (
=(() *
$num((+ -
;((- .
private)) 
const)) 
int)) 

WM_KEYDOWN)) $
=))% &
$num))' -
;))- .
private** 
const** 
int** 
WM_KEYUP** "
=**# $
$num**% +
;**+ ,
private,, 
const,, 
UInt32,, 

SWP_NOSIZE,, '
=,,( )
$num,,* 0
;,,0 1
private-- 
const-- 
UInt32-- 

SWP_NOMOVE-- '
=--( )
$num--* 0
;--0 1
private.. 
const.. 
UInt32.. 
SWP_SHOWWINDOW.. +
=.., -
$num... 4
;..4 5
private11  
LowLevelKeyboardProc11 $
KeyboardProc11% 1
;111 2
private22 
IntPtr22 
HookId22 
=22 
IntPtr22  &
.22& '
Zero22' +
;22+ ,
private33 
HashSet33 
<33 
Key33 
>33 
PressedKeys33 (
=33) *
new33+ .
HashSet33/ 6
<336 7
Key337 :
>33: ;
(33; <
)33< =
;33= >
public:: 
HotkeyListener:: 
(:: 
):: 
{;; 	
KeyboardProc<< 
=<< 
HookCallback<< '
;<<' (
HookId== 
=== 
SetHook== 
(== 
KeyboardProc== )
)==) *
;==* +
}>> 	
publicCC 
voidCC 
DisposeCC 
(CC 
)CC 
{DD 	
UnhookWindowsHookExEE 
(EE  
HookIdEE  &
)EE& '
;EE' (
}FF 	
publicLL 
voidLL #
OnKeyCombinationPressedLL +
(LL+ ,
	EventArgsLL, 5
eLL6 7
)LL7 8
{MM 	!
KeyCombinationPressedNN !
?NN! "
.NN" #
InvokeNN# )
(NN) *
thisNN* .
,NN. /
newNN0 3
CustomEventArgsNN4 C
(NNC D
)NND E
)NNE F
;NNF G
}OO 	
privateVV 
IntPtrVV 
SetHookVV 
(VV  
LowLevelKeyboardProcVV 3
procVV4 8
)VV8 9
{WW 	
usingXX 
(XX 
ProcessXX 

curProcessXX %
=XX& '
ProcessXX( /
.XX/ 0
GetCurrentProcessXX0 A
(XXA B
)XXB C
)XXC D
usingYY 
(YY 
ProcessModuleYY  
	curModuleYY! *
=YY+ ,

curProcessYY- 7
.YY7 8

MainModuleYY8 B
)YYB C
{ZZ 
return[[ 
SetWindowsHookEx[[ '
([[' (
WH_KEYBOARD_LL[[( 6
,[[6 7
proc[[8 <
,[[< =
GetModuleHandle\\( 7
(\\7 8
	curModule\\8 A
.\\A B

ModuleName\\B L
)\\L M
,\\M N
$num\\O P
)\\P Q
;\\Q R
}]] 
}^^ 	
privatehh 
IntPtrhh 
HookCallbackhh #
(hh# $
inthh$ '
nCodehh( -
,hh- .
IntPtrhh/ 5
wParamhh6 <
,hh< =
IntPtrhh> D
lParamhhE K
)hhK L
{ii 	
ifjj 
(jj 
nCodejj 
>=jj 
$numjj 
&&jj 
wParamjj $
==jj% '
(jj( )
IntPtrjj) /
)jj/ 0

WM_KEYDOWNjj0 :
)jj: ;
{kk 
intll 
VKCodell 
=ll 
Marshalll $
.ll$ %
	ReadInt32ll% .
(ll. /
lParamll/ 5
)ll5 6
;ll6 7
Keymm 

KeyPressedmm 
=mm  

KeyInteropmm! +
.mm+ ,
KeyFromVirtualKeymm, =
(mm= >
VKCodemm> D
)mmD E
;mmE F
PressedKeysnn 
.nn 
Addnn 
(nn  

KeyPressednn  *
)nn* +
;nn+ ,
ifpp 
(pp 
!pp 
Settingspp 
.pp 
Defaultpp %
.pp% &
HotkeyDisabledpp& 4
&&pp5 7
Settingspp8 @
.pp@ A
DefaultppA H
.ppH I
HotkeysppI P
!=ppQ S
nullppT X
&&ppY [
Settingspp\ d
.ppd e
Defaultppe l
.ppl m
Hotkeysppm t
.ppt u
SequenceEqual	ppu ‚
(
pp‚ ƒ
PressedKeys
ppƒ 
)
pp 
)
pp 
{qq #
OnKeyCombinationPressedrr +
(rr+ ,
newrr, /
	EventArgsrr0 9
(rr9 :
)rr: ;
)rr; <
;rr< =
}ss 
}tt 
elseuu 
ifuu 
(uu 
nCodeuu 
>=uu 
$numuu 
&&uu  "
wParamuu# )
==uu* ,
(uu- .
IntPtruu. 4
)uu4 5
WM_KEYUPuu5 =
)uu= >
{vv 
intww 
VKCodeww 
=ww 
Marshalww $
.ww$ %
	ReadInt32ww% .
(ww. /
lParamww/ 5
)ww5 6
;ww6 7
varxx 
KeyReleasedxx 
=xx  !

KeyInteropxx" ,
.xx, -
KeyFromVirtualKeyxx- >
(xx> ?
VKCodexx? E
)xxE F
;xxF G
PressedKeysyy 
.yy 
Removeyy "
(yy" #
KeyReleasedyy# .
)yy. /
;yy/ 0
}zz 
return|| 
CallNextHookEx|| !
(||! "
HookId||" (
,||( )
nCode||* /
,||/ 0
wParam||1 7
,||7 8
lParam||9 ?
)||? @
;||@ A
}}} 	
}~~ 
} Ί
bC:\Users\robin\source\repos\WindowsTimeTracker\TimeTracker\Logic\Listeners\MachineStateListener.cs
	namespace 	
TimeTracker
 
{ 
public		 

class		  
MachineStateListener		 %
{

 
public 
delegate 
void 
CustomEventDelegate 0
(0 1
object1 7
sender8 >
,> ?
CustomEventArgs@ O
argsP T
)T U
;U V
public 
event 
CustomEventDelegate (
StateChanged) 5
;5 6
public  
MachineStateListener #
(# $
)$ %
{ 	
SystemEvents 
. 
SessionSwitch &
+=' )
new* -%
SessionSwitchEventHandler. G
(G H
OnSessionSwitchH W
)W X
;X Y
} 	
private 
void 
OnSessionSwitch $
($ %
object% +
s, -
,- ."
SessionSwitchEventArgs/ E
eF G
)G H
{ 	
switch   
(   
e   
.   
Reason   
)   
{!! 
case"" 
SessionSwitchReason"" (
.""( )
SessionLock"") 4
:""4 5
StateChanged##  
?##  !
.##! "
Invoke##" (
(##( )
this##) -
,##- .
new##/ 2
CustomEventArgs##3 B
(##B C
false##C H
)##H I
)##I J
;##J K
break$$ 
;$$ 
case%% 
SessionSwitchReason%% (
.%%( )
SessionLogoff%%) 6
:%%6 7
StateChanged&&  
?&&  !
.&&! "
Invoke&&" (
(&&( )
this&&) -
,&&- .
new&&/ 2
CustomEventArgs&&3 B
(&&B C
false&&C H
)&&H I
)&&I J
;&&J K
break'' 
;'' 
case(( 
SessionSwitchReason(( (
.((( )
SessionLogon(() 5
:((5 6
StateChanged))  
?))  !
.))! "
Invoke))" (
())( )
this))) -
,))- .
new))/ 2
CustomEventArgs))3 B
())B C
true))C G
)))G H
)))H I
;))I J
break** 
;** 
case++ 
SessionSwitchReason++ (
.++( )
SessionUnlock++) 6
:++6 7
StateChanged,,  
?,,  !
.,,! "
Invoke,," (
(,,( )
this,,) -
,,,- .
new,,/ 2
CustomEventArgs,,3 B
(,,B C
true,,C G
),,G H
),,H I
;,,I J
break-- 
;-- 
}.. 
}// 	
}11 
}22 ΰ9
SC:\Users\robin\source\repos\WindowsTimeTracker\TimeTracker\AwayFromPCDialog.xaml.cs
	namespace 	
TimeTracker
 
{ 
public 

partial 
class 
AwayFromPCDialog )
:* +
System, 2
.2 3
Windows3 :
.: ;
Window; A
{ 
private 
List 
< 
CustomComboBoxItem '
>' (

Activities) 3
;3 4
private 
DateTime 
FromDate !
;! "
private 
DateTime 
ToDate 
;  
private 
string 
DefaultName "
;" #
private   
StorageHandler   
StorageHandler   -
;  - .
private!! 
AppStateTracker!! 
AppStateTracker!!  /
;!!/ 0
public)) 
AwayFromPCDialog)) 
())  
StorageHandler))  .
storageHandler))/ =
,))= >
AppStateTracker))? N
appStateTracker))O ^
,))^ _
DateTime))` h

lastLocked))i s
)))s t
{** 	
InitializeComponent++ 
(++  
)++  !
;++! "
FromDate-- 
=-- 

lastLocked-- !
;--! "
ToDate.. 
=.. 
DateTime.. 
... 
Now.. !
;..! "
StorageHandler00 
=00 
storageHandler00 +
;00+ ,
AppStateTracker11 
=11 
appStateTracker11 -
;11- .
Label33 
.33 
Content33 
=33 
$str33 8
+339 :
FromDate33; C
.33C D
ToShortTimeString33D U
(33U V
)33V W
+33X Y
$str33Z ]
;33] ^
TimeElapsed44 
.44 
Content44 
=44  !
(44" #
ToDate44# )
-44* +
FromDate44, 4
)444 5
.445 6
ToString446 >
(44> ?
)44? @
.44@ A
	Substring44A J
(44J K
$num44K L
,44L M
$num44N O
)44O P
;44P Q

Activities77 
=77 
StorageHandler77 '
.77' ($
GetLastActivitiesGrouped77( @
(77@ A
)77A B
.77B C
Select77C I
(77I J
rg77J L
=>77M O
new77P S
CustomComboBoxItem77T f
(77f g
)77g h
{88 
Name99 
=99 
rg99 
.99 
Key99 
,99 

Selectable:: 
=:: 
true:: !
};; 
);; 
.;; 
ToList;; 
(;; 
);; 
;;; 
DefaultName== 
=== 
AppStateTracker== )
.==) *
CurrentActivity==* 9
?==9 :
.==: ;
Name==; ?
??==@ B

Activities==C M
.==M N
FirstOrDefault==N \
(==\ ]
)==] ^
?==^ _
.==_ `
Name==` d
??==e g
$str==h j
;==j k
if?? 
(?? 
AppStateTracker?? 
.??  
CurrentActivity??  /
!=??0 2
null??3 7
&&??8 :
!??; <

Activities??< F
.??F G
Any??G J
(??J K
a??K L
=>??M O
a??P Q
.??Q R
Name??R V
.??V W
Equals??W ]
(??] ^
DefaultName??^ i
)??i j
)??j k
)??k l

Activities@@ 
.@@ 
Insert@@ !
(@@! "
$num@@" #
,@@# $
new@@% (
CustomComboBoxItem@@) ;
(@@; <
)@@< =
{AA 
NameBB 
=BB 
DefaultNameBB &
,BB& '

SelectableCC 
=CC  
trueCC! %
}DD 
)DD 
;DD 
forGG 
(GG 
intGG 
iGG 
=GG 
$numGG 
;GG 
iGG 
<GG 

ActivitiesGG  *
.GG* +
CountGG+ 0
(GG0 1
)GG1 2
;GG2 3
iGG4 5
++GG5 7
)GG7 8
{HH 

ActivitiesII 
[II 
iII 
]II 
.II 
VisibleII %
=II& '
iII( )
<II* +
$numII, -
?II. /
$strII0 9
:II: ;
$strII< G
;IIG H
}JJ 

ActivitiesNN 
.NN 
InsertNN 
(NN 
$numNN 
,NN  
newNN! $
CustomComboBoxItemNN% 7
(NN7 8
)NN8 9
{OO 
NamePP 
=PP 
$strPP /
,PP/ 0

SelectableQQ 
=QQ 
falseQQ "
}RR 
)RR 
;RR 
ComboBoxTT 
.TT 
ItemsSourceTT  
=TT! "

ActivitiesTT# -
;TT- .
ComboBoxUU 
.UU 
SelectedItemUU !
=UU" #

ActivitiesUU$ .
.UU. /
WhereUU/ 4
(UU4 5
aUU5 6
=>UU7 9
aUU: ;
.UU; <
NameUU< @
.UU@ A
EqualsUUA G
(UUG H
DefaultNameUUH S
)UUS T
)UUT U
.UUU V
FirstOrDefaultUUV d
(UUd e
)UUe f
;UUf g
}VV 	
private]] 
void]] 
SetNewActivity]] #
(]]# $
string]]$ *
name]]+ /
)]]/ 0
{^^ 	
AppStateTracker__ 
.__ !
CreateCurrentActivity__ 1
(__1 2
name__2 6
,__6 7
FromDate__8 @
)__@ A
;__A B
AppStateTracker`` 
.`` 
SaveCurrentActivity`` /
(``/ 0
ToDate``0 6
)``6 7
;``7 8
Closeaa 
(aa 
)aa 
;aa 
}bb 	
privateff 
voidff 
ConfirmButton_Clickff (
(ff( )
objectff) /
senderff0 6
,ff6 7
RoutedEventArgsff8 G
effH I
)ffI J
{gg 	
SetNewActivityhh 
(hh 
ComboBoxhh #
.hh# $
Texthh$ (
)hh( )
;hh) *
}ii 	
privatekk 
voidkk 
ComboBox_OnKeyUpkk %
(kk% &
objectkk& ,
senderkk- 3
,kk3 4
Systemkk5 ;
.kk; <
Windowskk< C
.kkC D
InputkkD I
.kkI J
KeyEventArgskkJ V
ekkW X
)kkX Y
{ll 	
ifmm 
(mm 
emm 
.mm 
Keymm 
==mm 
Keymm 
.mm 
Entermm "
)mm" #
{nn 
SetNewActivityoo 
(oo 
ComboBoxoo '
.oo' (
Textoo( ,
)oo, -
;oo- .
}pp 
}qq 	
privatess 
voidss 
Button_Clickss !
(ss! "
objectss" (
senderss) /
,ss/ 0
RoutedEventArgsss1 @
essA B
)ssB C
{tt 	
Closeuu 
(uu 
)uu 
;uu 
}vv 	
}ww 
}xx θ9
cC:\Users\robin\source\repos\WindowsTimeTracker\TimeTracker\Logic\Listeners\ProgramSwitchListener.cs
	namespace 	
TimeTracker
 
{ 
public 

class !
ProgramSwitchListener &
{ 
private 
delegate 
void 
WinEventDelegate .
(. /
IntPtr/ 5
hWinEventHook6 C
,C D
uintE I
	eventTypeJ S
,S T
IntPtrU [
hwnd\ `
,` a
intb e
idObjectf n
,n o
intp s
idChildt {
,{ |
uint	} 
dwEventThread
‚ 
,
 
uint
‘ •
dwmsEventTime
– £
)
£ ¤
;
¤ ¥
public 
delegate 
void 
CustomEventDelegate 0
(0 1
object1 7
sender8 >
,> ?
CustomEventArgs@ O
argsP T
)T U
;U V
[ 	
	DllImport	 
( 
$str 
)  
]  !
private 
static 
extern 
IntPtr $
SetWinEventHook% 4
(4 5
uint5 9
eventMin: B
,B C
uintD H
eventMaxI Q
,Q R
IntPtrS Y
hmodWinEventProcZ j
,j k
WinEventDelegatel |
lpfnWinEventProc	} 
,
 
uint
 “
	idProcess
” 
,
 
uint
 £
idThread
¤ ¬
,
¬ ­
uint
® ²
dwFlags
³ Ί
)
Ί »
;
» Ό
[ 	
	DllImport	 
( 
$str 
)  
]  !
private 
static 
extern 
IntPtr $
GetForegroundWindow% 8
(8 9
)9 :
;: ;
[ 	
	DllImport	 
( 
$str 
,  
SetLastError! -
=. /
true0 4
,4 5
CharSet6 =
=> ?
CharSet@ G
.G H
AutoH L
)L M
]M N
private 
static 
extern 
long "
GetWindowText# 0
(0 1
IntPtr1 7
hwnd8 <
,< =
StringBuilder> K
lpStringL T
,T U
longV Z
cch[ ^
)^ _
;_ `
[ 	
	DllImport	 
( 
$str 
)  
]  !
private 
static 
extern 
IntPtr $
	GetParent% .
(. /
IntPtr/ 5
hwnd6 :
): ;
;; <
public 
event 
CustomEventDelegate (
ProgramChanged) 7
;7 8
private"" 
const"" 
uint"" !
WINEVENT_OUTOFCONTEXT"" 0
=""1 2
$num""3 4
;""4 5
private## 
const## 
uint## #
EVENT_SYSTEM_FOREGROUND## 2
=##3 4
$num##5 6
;##6 7
private&& 
WinEventDelegate&&  
WindowChanged&&! .
;&&. /
public-- !
ProgramSwitchListener-- $
(--$ %
)--% &
{.. 	
WindowChanged00 
=00 
new00 
WinEventDelegate00  0
(000 1
WinEventProc001 =
)00= >
;00> ?
IntPtr11 
m_hhook11 
=11 
SetWinEventHook11 ,
(11, -#
EVENT_SYSTEM_FOREGROUND22 '
,22' (#
EVENT_SYSTEM_FOREGROUND33 '
,33' (
IntPtr44 
.44 
Zero44 
,44 
WindowChanged55 
,55 
$num66 
,66 
$num77 
,77 !
WINEVENT_OUTOFCONTEXT88 %
)88% &
;88& '
}99 	
private@@ 
string@@  
GetActiveWindowTitle@@ +
(@@+ ,
IntPtr@@, 2
handle@@3 9
)@@9 :
{AA 	
constBB 
intBB 
NCharsBB 
=BB 
$numBB "
;BB" #
StringBuilderCC 
BuffCC 
=CC  
newCC! $
StringBuilderCC% 2
(CC2 3
NCharsCC3 9
)CC9 :
;CC: ;
ifDD 
(DD 
handleDD 
.DD 
ToInt64DD 
(DD 
)DD  
==DD! #
$numDD$ %
)DD% &
handleEE 
=EE 
GetForegroundWindowEE ,
(EE, -
)EE- .
;EE. /
ifGG 
(GG 
GetWindowTextGG 
(GG 
handleGG $
,GG$ %
BuffGG& *
,GG* +
NCharsGG, 2
)GG2 3
>GG4 5
$numGG6 7
)GG7 8
{HH 
returnII 
BuffII 
.II 
ToStringII $
(II$ %
)II% &
;II& '
}JJ 
returnKK 
nullKK 
;KK 
}LL 	
publicZZ 
voidZZ 
WinEventProcZZ  
(ZZ  !
IntPtrZZ! '
hWinEventHookZZ( 5
,ZZ5 6
uintZZ7 ;
	eventTypeZZ< E
,ZZE F
IntPtrZZG M
hwndZZN R
,ZZR S
intZZT W
idObjectZZX `
,ZZ` a
intZZb e
idChildZZf m
,ZZm n
uintZZo s
dwEventThread	ZZt 
,
ZZ ‚
uint
ZZƒ ‡
dwmsEventTime
ZZ •
)
ZZ• –
{[[ 	
IntPtr\\ 
Handle\\ 
;\\ 
long]] 

HandleLong]] 
;]] 
IntPtr`` 
	NewParent`` 
=`` 
	GetParent`` (
(``( )
hwnd``) -
)``- .
;``. /
IntPtraa 
	OldParentaa 
=aa 
hwndaa #
;aa# $
whilebb 
(bb 
	NewParentbb 
.bb 
ToInt64bb $
(bb$ %
)bb% &
>bb' (
$numbb) *
)bb* +
{cc 
	OldParentdd 
=dd 
	NewParentdd %
;dd% &
	NewParentee 
=ee 
	GetParentee %
(ee% &
	OldParentee& /
)ee/ 0
;ee0 1
}ff 
Handlehh 
=hh 
	OldParenthh 
;hh 

HandleLongii 
=ii 
hwndii 
.ii 
ToInt64ii %
(ii% &
)ii& '
;ii' (
ifkk 
(kk 

HandleLongkk 
<=kk 
$numkk 
)kk  
returnll 
;ll 
stringnn 
windowTitlenn 
=nn   
GetActiveWindowTitlenn! 5
(nn5 6
Handlenn6 <
)nn< =
;nn= >
ifoo 
(oo 
windowTitleoo 
==oo 
nulloo #
)oo# $
returnpp 
;pp 
ProgramChangedrr 
?rr 
.rr 
Invokerr "
(rr" #
thisrr# '
,rr' (
newrr) ,
CustomEventArgsrr- <
(rr< =
windowTitlerr= H
)rrH I
)rrI J
;rrJ K
}ss 	
}tt 
}uu έφ
RC:\Users\robin\source\repos\WindowsTimeTracker\TimeTracker\Logic\StorageHandler.cs
	namespace

 	
TimeTracker


 
{ 
public 

class 
StorageHandler 
{ 
public 
string 
ActivityPath "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
string 

WindowPath  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
StorageHandler 
( 
) 
{ 	
string 
Path 
= 
Environment %
.% &
GetFolderPath& 3
(3 4
Environment4 ?
.? @
SpecialFolder@ M
.M N
MyDocumentsN Y
)Y Z
+[ \
$str] l
;l m

WindowPath 
= 
Path 
+ 
$str  /
;/ 0
ActivityPath 
= 
Path 
+  !
$str" 4
;4 5"
CreateFilesIfNoneExist "
(" #
Path# '
)' (
;( )
}   	
private%% 
void%%  
RestoreActivitiesCsv%% )
(%%) *
)%%* +
{&& 	
List'' 
<'' 
Activity'' 
>'' 
Good'' 
;''  
using** 
(** 
StreamReader** 
Reader**  &
=**' (
new**) ,
StreamReader**- 9
(**9 :
ActivityPath**: F
)**F G
)**G H
using++ 
(++ 
	CsvReader++ 
Csv++  
=++! "
new++# &
	CsvReader++' 0
(++0 1
Reader++1 7
)++7 8
)++8 9
{,, 
Good-- 
=-- 
new-- 
List-- 
<--  
Activity--  (
>--( )
(--) *
)--* +
;--+ ,
Csv.. 
... 
Configuration.. !
...! "
	Delimiter.." +
=.., -
$str... 1
;..1 2
Csv// 
.// 
Configuration// !
.//! "
BadDataFound//" .
=/// 0
null//1 5
;//5 6
while11 
(11 
Csv11 
.11 
Read11 
(11  
)11  !
)11! "
{22 
try33 
{44 
Activity55  
Record55! '
=55( )
Csv55* -
.55- .
	GetRecord55. 7
<557 8
Activity558 @
>55@ A
(55A B
)55B C
;55C D
Good66 
.66 
Add66  
(66  !
Record66! '
)66' (
;66( )
}77 
catch88 
(88 
	Exception88 $
ignore88% +
)88+ ,
{99 
}:: 
};; 
}<< 
WriteActivities>> 
(>> 
Good>>  
)>>  !
;>>! "
}?? 	
privateDD 
voidDD 
RestoreWindowsCsvDD &
(DD& '
)DD' (
{EE 	
ListFF 
<FF 
WindowFF 
>FF 
GoodFF 
;FF 
usingII 
(II 
StreamReaderII 
ReaderII  &
=II' (
newII) ,
StreamReaderII- 9
(II9 :

WindowPathII: D
)IID E
)IIE F
usingJJ 
(JJ 
	CsvReaderJJ 
CsvJJ  
=JJ! "
newJJ# &
	CsvReaderJJ' 0
(JJ0 1
ReaderJJ1 7
)JJ7 8
)JJ8 9
{KK 
GoodLL 
=LL 
newLL 
ListLL 
<LL  
WindowLL  &
>LL& '
(LL' (
)LL( )
;LL) *
CsvMM 
.MM 
ConfigurationMM !
.MM! "
	DelimiterMM" +
=MM, -
$strMM. 1
;MM1 2
CsvNN 
.NN 
ConfigurationNN !
.NN! "
BadDataFoundNN" .
=NN/ 0
nullNN1 5
;NN5 6
whileOO 
(OO 
CsvOO 
.OO 
ReadOO 
(OO  
)OO  !
)OO! "
{PP 
tryQQ 
{RR 
WindowSS 
RecordSS %
=SS& '
CsvSS( +
.SS+ ,
	GetRecordSS, 5
<SS5 6
WindowSS6 <
>SS< =
(SS= >
)SS> ?
;SS? @
GoodTT 
.TT 
AddTT  
(TT  !
RecordTT! '
)TT' (
;TT( )
}UU 
catchVV 
(VV 
	ExceptionVV $
ignoreVV% +
)VV+ ,
{WW 
}XX 
}YY 
}ZZ 
WriteWindows\\ 
(\\ 
Good\\ 
)\\ 
;\\ 
}]] 	
publiccc 
Activitycc 
GetLastActivitycc '
(cc' (
)cc( )
{dd 	
tryee 
{ff 
usinggg 
(gg 

TextReadergg !
trgg" $
=gg% &
newgg' *
StreamReadergg+ 7
(gg7 8
ActivityPathgg8 D
)ggD E
)ggE F
{hh 
	CsvReaderii 
Csvii !
=ii" #
newii$ '
	CsvReaderii( 1
(ii1 2
trii2 4
)ii4 5
;ii5 6
Csvjj 
.jj 
Configurationjj %
.jj% &
	Delimiterjj& /
=jj0 1
$strjj2 5
;jj5 6
IEnumerablekk 
<kk  
Activitykk  (
>kk( )
Recordskk* 1
=kk2 3
Csvkk4 7
.kk7 8

GetRecordskk8 B
<kkB C
ActivitykkC K
>kkK L
(kkL M
)kkM N
;kkN O
returnll 
Recordsll "
.ll" #
OrderByll# *
(ll* +
rll+ ,
=>ll- /
rll0 1
.ll1 2
Toll2 4
)ll4 5
.ll5 6
LastOrDefaultll6 C
(llC D
)llD E
;llE F
}mm 
}nn 
catchoo 
(oo 
	Exceptionoo 
exoo 
)oo  
{pp 
ifqq 
(qq 
exqq 
isqq 
	CsvHelperqq #
.qq# $!
MissingFieldExceptionqq$ 9
||qq: <
exqq= ?
isqq@ B
CsvHelperExceptionqqC U
)qqU V
{rr  
RestoreActivitiesCsvss (
(ss( )
)ss) *
;ss* +
returntt 
GetLastActivitytt *
(tt* +
)tt+ ,
;tt, -
}uu 
returnvv 
nullvv 
;vv 
}ww 
}xx 	
public~~ 
List~~ 
<~~ 
Activity~~ 
>~~ 
GetLastActivities~~ /
(~~/ 0
)~~0 1
{ 	
try
€€ 
{
 
using
‚‚ 
(
‚‚ 

TextReader
‚‚ !
tr
‚‚" $
=
‚‚% &
new
‚‚' *
StreamReader
‚‚+ 7
(
‚‚7 8
ActivityPath
‚‚8 D
)
‚‚D E
)
‚‚E F
{
ƒƒ 
	CsvReader
„„ 
Csv
„„ !
=
„„" #
new
„„$ '
	CsvReader
„„( 1
(
„„1 2
tr
„„2 4
)
„„4 5
;
„„5 6
Csv
…… 
.
…… 
Configuration
…… %
.
……% &
	Delimiter
……& /
=
……0 1
$str
……2 5
;
……5 6
IEnumerable
†† 
<
††  
Activity
††  (
>
††( )
Records
††* 1
=
††2 3
Csv
††4 7
.
††7 8

GetRecords
††8 B
<
††B C
Activity
††C K
>
††K L
(
††L M
)
††M N
;
††N O
return
‡‡ 
Records
‡‡ "
.
‡‡" #
OrderByDescending
‡‡# 4
(
‡‡4 5
aa
‡‡5 7
=>
‡‡8 :
aa
‡‡; =
.
‡‡= >
To
‡‡> @
)
‡‡@ A
.
‡‡A B
ToList
‡‡B H
(
‡‡H I
)
‡‡I J
;
‡‡J K
}
 
}
‰‰ 
catch
 
(
 
	Exception
 
ex
 
)
  
{
‹‹ 
if
 
(
 
ex
 
is
 
	CsvHelper
 #
.
# $#
MissingFieldException
$ 9
||
: <
ex
= ?
is
@ B 
CsvHelperException
C U
)
U V
{
 "
RestoreActivitiesCsv
 (
(
( )
)
) *
;
* +
return
 
GetLastActivities
 ,
(
, -
)
- .
;
. /
}
 
return
‘‘ 
new
‘‘ 
List
‘‘ 
<
‘‘  
Activity
‘‘  (
>
‘‘( )
(
‘‘) *
)
‘‘* +
;
‘‘+ ,
}
’’ 
}
““ 	
public
™™ 
List
™™ 
<
™™ 
	IGrouping
™™ 
<
™™ 
string
™™ $
,
™™$ %
Activity
™™& .
>
™™. /
>
™™/ 0&
GetLastActivitiesGrouped
™™1 I
(
™™I J
)
™™J K
{
 	
try
›› 
{
 
using
 
(
 

TextReader
 !
tr
" $
=
% &
new
' *
StreamReader
+ 7
(
7 8
ActivityPath
8 D
)
D E
)
E F
{
 
	CsvReader
 
Csv
 !
=
" #
new
$ '
	CsvReader
( 1
(
1 2
tr
2 4
)
4 5
;
5 6
Csv
   
.
   
Configuration
   %
.
  % &
	Delimiter
  & /
=
  0 1
$str
  2 5
;
  5 6
IEnumerable
΅΅ 
<
΅΅  
Activity
΅΅  (
>
΅΅( )
Records
΅΅* 1
=
΅΅2 3
Csv
΅΅4 7
.
΅΅7 8

GetRecords
΅΅8 B
<
΅΅B C
Activity
΅΅C K
>
΅΅K L
(
΅΅L M
)
΅΅M N
;
΅΅N O
return
ΆΆ 
Records
ΆΆ "
.
ΆΆ" #
GroupBy
ΆΆ# *
(
ΆΆ* +
r
ΆΆ+ ,
=>
ΆΆ- /
r
ΆΆ0 1
.
ΆΆ1 2
Name
ΆΆ2 6
)
ΆΆ6 7
.
ΆΆ7 8
OrderByDescending
ΆΆ8 I
(
ΆΆI J
rg
ΆΆJ L
=>
ΆΆM O
rg
ΆΆP R
.
ΆΆR S
Max
ΆΆS V
(
ΆΆV W
r
ΆΆW X
=>
ΆΆY [
r
ΆΆ\ ]
.
ΆΆ] ^
From
ΆΆ^ b
)
ΆΆb c
)
ΆΆc d
.
ΆΆd e
ToList
ΆΆe k
(
ΆΆk l
)
ΆΆl m
;
ΆΆm n
}
££ 
}
¤¤ 
catch
¥¥ 
(
¥¥ 
	Exception
¥¥ 
ex
¥¥ 
)
¥¥  
{
¦¦ 
if
§§ 
(
§§ 
ex
§§ 
is
§§ 
	CsvHelper
§§ #
.
§§# $#
MissingFieldException
§§$ 9
||
§§: <
ex
§§= ?
is
§§@ B 
CsvHelperException
§§C U
)
§§U V
{
¨¨ "
RestoreActivitiesCsv
©© (
(
©©( )
)
©©) *
;
©©* +
return
 &
GetLastActivitiesGrouped
 3
(
3 4
)
4 5
;
5 6
}
«« 
return
¬¬ 
new
¬¬ 
List
¬¬ 
<
¬¬  
	IGrouping
¬¬  )
<
¬¬) *
string
¬¬* 0
,
¬¬0 1
Activity
¬¬2 :
>
¬¬: ;
>
¬¬; <
(
¬¬< =
)
¬¬= >
;
¬¬> ?
}
­­ 
}
®® 	
public
΄΄ 
List
΄΄ 
<
΄΄ 
	IGrouping
΄΄ 
<
΄΄ 
string
΄΄ $
,
΄΄$ %
Activity
΄΄& .
>
΄΄. /
>
΄΄/ 0*
GetEarliestActivitiesGrouped
΄΄1 M
(
΄΄M N
)
΄΄N O
{
µµ 	
try
¶¶ 
{
·· 
using
ΈΈ 
(
ΈΈ 

TextReader
ΈΈ !
tr
ΈΈ" $
=
ΈΈ% &
new
ΈΈ' *
StreamReader
ΈΈ+ 7
(
ΈΈ7 8
ActivityPath
ΈΈ8 D
)
ΈΈD E
)
ΈΈE F
{
ΉΉ 
	CsvReader
ΊΊ 
Csv
ΊΊ !
=
ΊΊ" #
new
ΊΊ$ '
	CsvReader
ΊΊ( 1
(
ΊΊ1 2
tr
ΊΊ2 4
)
ΊΊ4 5
;
ΊΊ5 6
Csv
»» 
.
»» 
Configuration
»» %
.
»»% &
	Delimiter
»»& /
=
»»0 1
$str
»»2 5
;
»»5 6
IEnumerable
ΌΌ 
<
ΌΌ  
Activity
ΌΌ  (
>
ΌΌ( )
Records
ΌΌ* 1
=
ΌΌ2 3
Csv
ΌΌ4 7
.
ΌΌ7 8

GetRecords
ΌΌ8 B
<
ΌΌB C
Activity
ΌΌC K
>
ΌΌK L
(
ΌΌL M
)
ΌΌM N
;
ΌΌN O
return
½½ 
Records
½½ "
.
½½" #
GroupBy
½½# *
(
½½* +
r
½½+ ,
=>
½½- /
r
½½0 1
.
½½1 2
Name
½½2 6
)
½½6 7
.
½½7 8
OrderBy
½½8 ?
(
½½? @
rg
½½@ B
=>
½½C E
rg
½½F H
.
½½H I
Min
½½I L
(
½½L M
r
½½M N
=>
½½O Q
r
½½R S
.
½½S T
From
½½T X
)
½½X Y
)
½½Y Z
.
½½Z [
ToList
½½[ a
(
½½a b
)
½½b c
;
½½c d
}
ΎΎ 
}
ΏΏ 
catch
ΐΐ 
(
ΐΐ 
	Exception
ΐΐ 
ex
ΐΐ 
)
ΐΐ  
{
ΑΑ 
if
ΒΒ 
(
ΒΒ 
ex
ΒΒ 
is
ΒΒ 
	CsvHelper
ΒΒ #
.
ΒΒ# $#
MissingFieldException
ΒΒ$ 9
||
ΒΒ: <
ex
ΒΒ= ?
is
ΒΒ@ B 
CsvHelperException
ΒΒC U
)
ΒΒU V
{
ΓΓ "
RestoreActivitiesCsv
ΔΔ (
(
ΔΔ( )
)
ΔΔ) *
;
ΔΔ* +
return
ΕΕ *
GetEarliestActivitiesGrouped
ΕΕ 7
(
ΕΕ7 8
)
ΕΕ8 9
;
ΕΕ9 :
}
ΖΖ 
return
ΗΗ 
new
ΗΗ 
List
ΗΗ 
<
ΗΗ  
	IGrouping
ΗΗ  )
<
ΗΗ) *
string
ΗΗ* 0
,
ΗΗ0 1
Activity
ΗΗ2 :
>
ΗΗ: ;
>
ΗΗ; <
(
ΗΗ< =
)
ΗΗ= >
;
ΗΗ> ?
}
ΘΘ 
}
ΙΙ 	
public
ΠΠ 
List
ΠΠ 
<
ΠΠ 
Activity
ΠΠ 
>
ΠΠ #
GetActivitiesByLambda
ΠΠ 3
(
ΠΠ3 4
Func
ΠΠ4 8
<
ΠΠ8 9
Activity
ΠΠ9 A
,
ΠΠA B
bool
ΠΠC G
>
ΠΠG H
filter
ΠΠI O
)
ΠΠO P
{
ΡΡ 	
try
 
{
ΣΣ 
using
ΤΤ 
(
ΤΤ 

TextReader
ΤΤ !
tr
ΤΤ" $
=
ΤΤ% &
new
ΤΤ' *
StreamReader
ΤΤ+ 7
(
ΤΤ7 8
ActivityPath
ΤΤ8 D
)
ΤΤD E
)
ΤΤE F
{
ΥΥ 
	CsvReader
ΦΦ 
Csv
ΦΦ !
=
ΦΦ" #
new
ΦΦ$ '
	CsvReader
ΦΦ( 1
(
ΦΦ1 2
tr
ΦΦ2 4
)
ΦΦ4 5
;
ΦΦ5 6
Csv
ΧΧ 
.
ΧΧ 
Configuration
ΧΧ %
.
ΧΧ% &
	Delimiter
ΧΧ& /
=
ΧΧ0 1
$str
ΧΧ2 5
;
ΧΧ5 6
IEnumerable
ΨΨ 
<
ΨΨ  
Activity
ΨΨ  (
>
ΨΨ( )
Records
ΨΨ* 1
=
ΨΨ2 3
Csv
ΨΨ4 7
.
ΨΨ7 8

GetRecords
ΨΨ8 B
<
ΨΨB C
Activity
ΨΨC K
>
ΨΨK L
(
ΨΨL M
)
ΨΨM N
;
ΨΨN O
return
ΩΩ 
Records
ΩΩ "
.
ΩΩ" #
Where
ΩΩ# (
(
ΩΩ( )
filter
ΩΩ) /
)
ΩΩ/ 0
.
ΩΩ0 1
ToList
ΩΩ1 7
(
ΩΩ7 8
)
ΩΩ8 9
;
ΩΩ9 :
}
ΪΪ 
}
ΫΫ 
catch
άά 
(
άά 
	Exception
άά 
ex
άά 
)
άά  
{
έέ 
if
ήή 
(
ήή 
ex
ήή 
is
ήή 
	CsvHelper
ήή #
.
ήή# $#
MissingFieldException
ήή$ 9
||
ήή: <
ex
ήή= ?
is
ήή@ B 
CsvHelperException
ήήC U
)
ήήU V
{
ίί "
RestoreActivitiesCsv
ΰΰ (
(
ΰΰ( )
)
ΰΰ) *
;
ΰΰ* +
return
αα #
GetActivitiesByLambda
αα 0
(
αα0 1
filter
αα1 7
)
αα7 8
;
αα8 9
}
ββ 
return
γγ 
new
γγ 
List
γγ 
<
γγ  
Activity
γγ  (
>
γγ( )
(
γγ) *
)
γγ* +
;
γγ+ ,
}
δδ 
}
εε 	
public
λλ 
List
λλ 
<
λλ 
	IGrouping
λλ 
<
λλ 
string
λλ $
,
λλ$ %
Window
λλ& ,
>
λλ, -
>
λλ- .&
GetLastestWindowsGrouped
λλ/ G
(
λλG H
)
λλH I
{
μμ 	
try
νν 
{
ξξ 
using
οο 
(
οο 

TextReader
οο !
tr
οο" $
=
οο% &
new
οο' *
StreamReader
οο+ 7
(
οο7 8

WindowPath
οο8 B
)
οοB C
)
οοC D
{
ππ 
	CsvReader
ρρ 
Csv
ρρ !
=
ρρ" #
new
ρρ$ '
	CsvReader
ρρ( 1
(
ρρ1 2
tr
ρρ2 4
)
ρρ4 5
;
ρρ5 6
Csv
ςς 
.
ςς 
Configuration
ςς %
.
ςς% &
	Delimiter
ςς& /
=
ςς0 1
$str
ςς2 5
;
ςς5 6
IEnumerable
σσ 
<
σσ  
Window
σσ  &
>
σσ& '
Records
σσ( /
=
σσ0 1
Csv
σσ2 5
.
σσ5 6

GetRecords
σσ6 @
<
σσ@ A
Window
σσA G
>
σσG H
(
σσH I
)
σσI J
;
σσJ K
return
ττ 
Records
ττ "
.
ττ" #
GroupBy
ττ# *
(
ττ* +
r
ττ+ ,
=>
ττ- /
r
ττ0 1
.
ττ1 2
Name
ττ2 6
)
ττ6 7
.
ττ7 8
OrderByDescending
ττ8 I
(
ττI J
rg
ττJ L
=>
ττM O
rg
ττP R
.
ττR S
Max
ττS V
(
ττV W
r
ττW X
=>
ττY [
r
ττ\ ]
.
ττ] ^
From
ττ^ b
)
ττb c
)
ττc d
.
ττd e
ToList
ττe k
(
ττk l
)
ττl m
;
ττm n
}
υυ 
}
φφ 
catch
χχ 
(
χχ 
	Exception
χχ 
ex
χχ 
)
χχ  
{
ψψ 
if
ωω 
(
ωω 
ex
ωω 
is
ωω 
	CsvHelper
ωω #
.
ωω# $#
MissingFieldException
ωω$ 9
||
ωω: <
ex
ωω= ?
is
ωω@ B 
CsvHelperException
ωωC U
)
ωωU V
{
ϊϊ "
RestoreActivitiesCsv
ϋϋ (
(
ϋϋ( )
)
ϋϋ) *
;
ϋϋ* +
return
όό &
GetLastestWindowsGrouped
όό 3
(
όό3 4
)
όό4 5
;
όό5 6
}
ύύ 
return
ώώ 
new
ώώ 
List
ώώ 
<
ώώ  
	IGrouping
ώώ  )
<
ώώ) *
string
ώώ* 0
,
ώώ0 1
Window
ώώ2 8
>
ώώ8 9
>
ώώ9 :
(
ώώ: ;
)
ώώ; <
;
ώώ< =
}
 
}
€€ 	
public
‡‡ 
List
‡‡ 
<
‡‡ 
Window
‡‡ 
>
‡‡  
GetWindowsByLambda
‡‡ .
(
‡‡. /
Func
‡‡/ 3
<
‡‡3 4
Window
‡‡4 :
,
‡‡: ;
bool
‡‡< @
>
‡‡@ A
filter
‡‡B H
)
‡‡H I
{
 	
try
‰‰ 
{
 
using
‹‹ 
(
‹‹ 

TextReader
‹‹ !
tr
‹‹" $
=
‹‹% &
new
‹‹' *
StreamReader
‹‹+ 7
(
‹‹7 8

WindowPath
‹‹8 B
)
‹‹B C
)
‹‹C D
{
 
	CsvReader
 
Csv
 !
=
" #
new
$ '
	CsvReader
( 1
(
1 2
tr
2 4
)
4 5
;
5 6
Csv
 
.
 
Configuration
 %
.
% &
	Delimiter
& /
=
0 1
$str
2 5
;
5 6
IEnumerable
 
<
  
Window
  &
>
& '
Records
( /
=
0 1
Csv
2 5
.
5 6

GetRecords
6 @
<
@ A
Window
A G
>
G H
(
H I
)
I J
;
J K
return
 
Records
 "
.
" #
Where
# (
(
( )
filter
) /
)
/ 0
.
0 1
ToList
1 7
(
7 8
)
8 9
;
9 :
}
‘‘ 
}
’’ 
catch
““ 
(
““ 
	Exception
““ 
ex
““ 
)
““  
{
”” 
if
•• 
(
•• 
ex
•• 
is
•• 
	CsvHelper
•• #
.
••# $#
MissingFieldException
••$ 9
||
••: <
ex
••= ?
is
••@ B 
CsvHelperException
••C U
)
••U V
{
–– 
RestoreWindowsCsv
—— %
(
——% &
)
——& '
;
——' (
return
  
GetWindowsByLambda
 -
(
- .
filter
. 4
)
4 5
;
5 6
}
™™ 
return
 
new
 
List
 
<
  
Window
  &
>
& '
(
' (
)
( )
;
) *
}
›› 
}
 	
private
££ 
void
££ $
CreateFilesIfNoneExist
££ +
(
££+ ,
string
££, 2
path
££3 7
)
££7 8
{
¤¤ 	
if
¥¥ 
(
¥¥ 
!
¥¥ 
File
¥¥ 
.
¥¥ 
Exists
¥¥ 
(
¥¥ 
path
¥¥ !
)
¥¥! "
)
¥¥" #
	Directory
¦¦ 
.
¦¦ 
CreateDirectory
¦¦ )
(
¦¦) *
path
¦¦* .
)
¦¦. /
;
¦¦/ 0
if
¨¨ 
(
¨¨ 
!
¨¨ 
File
¨¨ 
.
¨¨ 
Exists
¨¨ 
(
¨¨ 

WindowPath
¨¨ '
)
¨¨' (
)
¨¨( )
{
©© 
using
 
(
 

TextWriter
 !
tw
" $
=
% &
new
' *
StreamWriter
+ 7
(
7 8

WindowPath
8 B
)
B C
)
C D
{
«« 
	CsvWriter
¬¬ 
Csv
¬¬ !
=
¬¬" #
new
¬¬$ '
	CsvWriter
¬¬( 1
(
¬¬1 2
tw
¬¬2 4
)
¬¬4 5
;
¬¬5 6
Csv
­­ 
.
­­ 
Configuration
­­ %
.
­­% &
	Delimiter
­­& /
=
­­0 1
$str
­­2 5
;
­­5 6
Csv
®® 
.
®® 
WriteHeader
®® #
<
®®# $
Window
®®$ *
>
®®* +
(
®®+ ,
)
®®, -
;
®®- .
Csv
―― 
.
―― 

NextRecord
―― "
(
――" #
)
――# $
;
――$ %
}
°° 
}
±± 
if
³³ 
(
³³ 
!
³³ 
File
³³ 
.
³³ 
Exists
³³ 
(
³³ 
ActivityPath
³³ )
)
³³) *
)
³³* +
{
΄΄ 
using
µµ 
(
µµ 

TextWriter
µµ !
tw
µµ" $
=
µµ% &
new
µµ' *
StreamWriter
µµ+ 7
(
µµ7 8
ActivityPath
µµ8 D
)
µµD E
)
µµE F
{
¶¶ 
	CsvWriter
·· 
Csv
·· !
=
··" #
new
··$ '
	CsvWriter
··( 1
(
··1 2
tw
··2 4
)
··4 5
;
··5 6
Csv
ΈΈ 
.
ΈΈ 
Configuration
ΈΈ %
.
ΈΈ% &
	Delimiter
ΈΈ& /
=
ΈΈ0 1
$str
ΈΈ2 5
;
ΈΈ5 6
Csv
ΉΉ 
.
ΉΉ 
WriteHeader
ΉΉ #
<
ΉΉ# $
Activity
ΉΉ$ ,
>
ΉΉ, -
(
ΉΉ- .
)
ΉΉ. /
;
ΉΉ/ 0
Csv
ΊΊ 
.
ΊΊ 

NextRecord
ΊΊ "
(
ΊΊ" #
)
ΊΊ# $
;
ΊΊ$ %
}
»» 
}
ΌΌ 
}
½½ 	
public
ΓΓ 
void
ΓΓ 
WriteActivity
ΓΓ !
(
ΓΓ! "
Activity
ΓΓ" *
activity
ΓΓ+ 3
)
ΓΓ3 4
{
ΔΔ 	
try
ΕΕ 
{
ΖΖ 
using
ΗΗ 
(
ΗΗ 

TextWriter
ΗΗ !
tw
ΗΗ" $
=
ΗΗ% &
new
ΗΗ' *
StreamWriter
ΗΗ+ 7
(
ΗΗ7 8
ActivityPath
ΗΗ8 D
,
ΗΗD E
true
ΗΗF J
)
ΗΗJ K
)
ΗΗK L
{
ΘΘ 
	CsvWriter
ΙΙ 
Csv
ΙΙ !
=
ΙΙ" #
new
ΙΙ$ '
	CsvWriter
ΙΙ( 1
(
ΙΙ1 2
tw
ΙΙ2 4
)
ΙΙ4 5
;
ΙΙ5 6
Csv
ΚΚ 
.
ΚΚ 
Configuration
ΚΚ %
.
ΚΚ% &
	Delimiter
ΚΚ& /
=
ΚΚ0 1
$str
ΚΚ2 5
;
ΚΚ5 6
Csv
ΛΛ 
.
ΛΛ 
WriteRecord
ΛΛ #
(
ΛΛ# $
activity
ΛΛ$ ,
)
ΛΛ, -
;
ΛΛ- .
Csv
ΜΜ 
.
ΜΜ 

NextRecord
ΜΜ "
(
ΜΜ" #
)
ΜΜ# $
;
ΜΜ$ %
}
ΝΝ 
}
ΞΞ 
catch
ΟΟ 
(
ΟΟ 
	Exception
ΟΟ 
ex
ΟΟ 
)
ΟΟ  
{
ΠΠ 
if
ΡΡ 
(
ΡΡ 
ex
ΡΡ 
is
ΡΡ 
	CsvHelper
ΡΡ #
.
ΡΡ# $#
MissingFieldException
ΡΡ$ 9
||
ΡΡ: <
ex
ΡΡ= ?
is
ΡΡ@ B 
CsvHelperException
ΡΡC U
)
ΡΡU V
{
 "
RestoreActivitiesCsv
ΣΣ (
(
ΣΣ( )
)
ΣΣ) *
;
ΣΣ* +
WriteActivity
ΤΤ !
(
ΤΤ! "
activity
ΤΤ" *
)
ΤΤ* +
;
ΤΤ+ ,
}
ΥΥ 
}
ΦΦ 
}
ΧΧ 	
public
έέ 
void
έέ 
WriteActivities
έέ #
(
έέ# $
List
έέ$ (
<
έέ( )
Activity
έέ) 1
>
έέ1 2

activities
έέ3 =
)
έέ= >
{
ήή 	
try
ίί 
{
ΰΰ 
using
αα 
(
αα 

TextWriter
αα !
tw
αα" $
=
αα% &
new
αα' *
StreamWriter
αα+ 7
(
αα7 8
ActivityPath
αα8 D
)
ααD E
)
ααE F
{
ββ 
	CsvWriter
γγ 
Csv
γγ !
=
γγ" #
new
γγ$ '
	CsvWriter
γγ( 1
(
γγ1 2
tw
γγ2 4
)
γγ4 5
;
γγ5 6
Csv
δδ 
.
δδ 
Configuration
δδ %
.
δδ% &
	Delimiter
δδ& /
=
δδ0 1
$str
δδ2 5
;
δδ5 6
Csv
εε 
.
εε 
WriteRecords
εε $
(
εε$ %

activities
εε% /
)
εε/ 0
;
εε0 1
Csv
ζζ 
.
ζζ 

NextRecord
ζζ "
(
ζζ" #
)
ζζ# $
;
ζζ$ %
}
ηη 
}
θθ 
catch
ιι 
(
ιι 
	Exception
ιι 
ex
ιι 
)
ιι  
{
κκ 
if
λλ 
(
λλ 
ex
λλ 
is
λλ 
	CsvHelper
λλ #
.
λλ# $#
MissingFieldException
λλ$ 9
||
λλ: <
ex
λλ= ?
is
λλ@ B 
CsvHelperException
λλC U
)
λλU V
{
μμ "
RestoreActivitiesCsv
νν (
(
νν( )
)
νν) *
;
νν* +
WriteActivities
ξξ #
(
ξξ# $

activities
ξξ$ .
)
ξξ. /
;
ξξ/ 0
}
οο 
}
ππ 
}
ρρ 	
public
χχ 
void
χχ 
WriteWindow
χχ 
(
χχ  
Window
χχ  &
window
χχ' -
)
χχ- .
{
ψψ 	
try
ωω 
{
ϊϊ 
using
ϋϋ 
(
ϋϋ 

TextWriter
ϋϋ !
tw
ϋϋ" $
=
ϋϋ% &
new
ϋϋ' *
StreamWriter
ϋϋ+ 7
(
ϋϋ7 8

WindowPath
ϋϋ8 B
,
ϋϋB C
true
ϋϋD H
)
ϋϋH I
)
ϋϋI J
{
όό 
	CsvWriter
ύύ 
Csv
ύύ !
=
ύύ" #
new
ύύ$ '
	CsvWriter
ύύ( 1
(
ύύ1 2
tw
ύύ2 4
)
ύύ4 5
;
ύύ5 6
Csv
ώώ 
.
ώώ 
Configuration
ώώ %
.
ώώ% &
	Delimiter
ώώ& /
=
ώώ0 1
$str
ώώ2 5
;
ώώ5 6
Csv
 
.
 
WriteRecord
 #
(
# $
window
$ *
)
* +
;
+ ,
Csv
€€ 
.
€€ 

NextRecord
€€ "
(
€€" #
)
€€# $
;
€€$ %
}
 
}
‚‚ 
catch
ƒƒ 
(
ƒƒ 
	Exception
ƒƒ 
ex
ƒƒ 
)
ƒƒ  
{
„„ 
if
…… 
(
…… 
ex
…… 
is
…… 
	CsvHelper
…… #
.
……# $#
MissingFieldException
……$ 9
||
……: <
ex
……= ?
is
……@ B 
CsvHelperException
……C U
)
……U V
{
†† 
RestoreWindowsCsv
‡‡ %
(
‡‡% &
)
‡‡& '
;
‡‡' (
WriteWindow
 
(
  
window
  &
)
& '
;
' (
}
‰‰ 
}
 
}
‹‹ 	
public
’’ 
void
’’ 
WriteWindows
’’  
(
’’  !
List
’’! %
<
’’% &
Window
’’& ,
>
’’, -
windows
’’. 5
)
’’5 6
{
““ 	
try
”” 
{
•• 
using
–– 
(
–– 

TextWriter
–– !
tw
––" $
=
––% &
new
––' *
StreamWriter
––+ 7
(
––7 8

WindowPath
––8 B
)
––B C
)
––C D
{
—— 
	CsvWriter
 
Csv
 !
=
" #
new
$ '
	CsvWriter
( 1
(
1 2
tw
2 4
)
4 5
;
5 6
Csv
™™ 
.
™™ 
Configuration
™™ %
.
™™% &
	Delimiter
™™& /
=
™™0 1
$str
™™2 5
;
™™5 6
Csv
 
.
 
WriteRecords
 $
(
$ %
windows
% ,
)
, -
;
- .
Csv
›› 
.
›› 

NextRecord
›› "
(
››" #
)
››# $
;
››$ %
}
 
}
 
catch
 
(
 
	Exception
 
ex
 
)
  
{
 
if
   
(
   
ex
   
is
   
	CsvHelper
   #
.
  # $#
MissingFieldException
  $ 9
||
  : <
ex
  = ?
is
  @ B 
CsvHelperException
  C U
)
  U V
{
΅΅ 
RestoreWindowsCsv
ΆΆ %
(
ΆΆ% &
)
ΆΆ& '
;
ΆΆ' (
WriteWindows
££  
(
££  !
windows
££! (
)
££( )
;
££) *
}
¤¤ 
}
¥¥ 
}
¦¦ 	
}
§§ 
}¨¨ Νq
QC:\Users\robin\source\repos\WindowsTimeTracker\TimeTracker\ActivityDialog.xaml.cs
	namespace 	
TimeTracker
 
{ 
public 

partial 
class 
ActivityDialog '
:( )
System* 0
.0 1
Windows1 8
.8 9
Window9 ?
{ 
private 
List 
< 
CustomComboBoxItem '
>' (

Activities) 3
;3 4
private 
Stack 
< 
bool 
> 
CancelClose '
=( )
new* -
Stack. 3
<3 4
bool4 8
>8 9
(9 :
): ;
;; <
private 
DateTime 
ToDate 
;  
private 
string 
DefaultName "
;" #
private   
long   
Timeout   
;   
private!! 
StorageHandler!! 
StorageHandler!! -
;!!- .
private"" 
AppStateTracker"" 
AppStateTracker""  /
;""/ 0
private## 
bool## 
DeletedSuggestion## &
;##& '
private$$ 
int$$ $
DeletedSuggestionCounter$$ ,
;$$, -
private%% 
int%% 
TextLengthCounter%% %
;%%% &
public-- 
ActivityDialog-- 
(-- 
StorageHandler-- ,
storageHandler--- ;
,--; <
AppStateTracker--= L
appStateTracker--M \
,--\ ]
bool--^ b

focusToast--c m
)--m n
{.. 	
InitializeComponent// 
(//  
)//  !
;//! "
StorageHandler11 
=11 
storageHandler11 +
;11+ ,
AppStateTracker22 
=22 
appStateTracker22 -
;22- .
ToDate33 
=33 
DateTime33 
.33 
Now33 !
;33! "
Rect66 
DesktopWorkingArea66 #
=66$ %
SystemParameters66& 6
.666 7
WorkArea667 ?
;66? @
Left77 
=77 
DesktopWorkingArea77 %
.77% &
Right77& +
-77, -
Width77. 3
-774 5
$num776 8
;778 9
Top88 
=88 
DesktopWorkingArea88 $
.88$ %
Bottom88% +
-88, -
Height88. 4
-885 6
$num887 9
;889 :

Activities;; 
=;; 
StorageHandler;; '
.;;' ($
GetLastActivitiesGrouped;;( @
(;;@ A
);;A B
.;;B C
Select;;C I
(;;I J
rg;;J L
=>;;M O
new;;P S
CustomComboBoxItem;;T f
(;;f g
);;g h
{<< 
Name== 
=== 
rg== 
.== 
Key== 
,== 

Selectable>> 
=>> 
true>> !
}?? 
)?? 
.?? 
ToList?? 
(?? 
)?? 
;?? 
DefaultNameAA 
=AA 
AppStateTrackerAA )
.AA) *
CurrentActivityAA* 9
?AA9 :
.AA: ;
NameAA; ?
??AA@ B

ActivitiesAAC M
.AAM N
FirstOrDefaultAAN \
(AA\ ]
)AA] ^
?AA^ _
.AA_ `
NameAA` d
??AAe g
$strAAh j
;AAj k
ifCC 
(CC 
AppStateTrackerCC 
.CC  
CurrentActivityCC  /
!=CC0 2
nullCC3 7
&&CC8 :
!CC; <

ActivitiesCC< F
.CCF G
AnyCCG J
(CCJ K
aCCK L
=>CCM O
aCCP Q
.CCQ R
NameCCR V
.CCV W
EqualsCCW ]
(CC] ^
DefaultNameCC^ i
)CCi j
)CCj k
)CCk l

ActivitiesDD 
.DD 
InsertDD !
(DD! "
$numDD" #
,DD# $
newDD% (
CustomComboBoxItemDD) ;
(DD; <
)DD< =
{EE 
NameFF 
=FF 
DefaultNameFF &
,FF& '

SelectableGG 
=GG  
trueGG! %
}HH 
)HH 
;HH 
forKK 
(KK 
intKK 
iKK 
=KK 
$numKK 
;KK 
iKK 
<KK 

ActivitiesKK  *
.KK* +
CountKK+ 0
(KK0 1
)KK1 2
;KK2 3
iKK4 5
++KK5 7
)KK7 8
{LL 

ActivitiesMM 
[MM 
iMM 
]MM 
.MM 
VisibleMM %
=MM& '
iMM( )
<MM* +
$numMM, -
?MM. /
$strMM0 9
:MM: ;
$strMM< G
;MMG H
}NN 

ActivitiesRR 
.RR 
InsertRR 
(RR 
$numRR 
,RR  
newRR! $
CustomComboBoxItemRR% 7
(RR7 8
)RR8 9
{SS 
NameTT 
=TT 
$strTT /
,TT/ 0

SelectableUU 
=UU 
falseUU "
}VV 
)VV 
;VV 
ComboBoxXX 
.XX 
ItemsSourceXX  
=XX! "

ActivitiesXX# -
;XX- .
ComboBoxYY 
.YY 
SelectedItemYY !
=YY" #

ActivitiesYY$ .
.YY. /
WhereYY/ 4
(YY4 5
aYY5 6
=>YY7 9
aYY: ;
.YY; <
NameYY< @
.YY@ A
EqualsYYA G
(YYG H
DefaultNameYYH S
)YYS T
)YYT U
.YYU V
FirstOrDefaultYYV d
(YYd e
)YYe f
;YYf g

TextBlock2ZZ 
.ZZ 
TextZZ 
=ZZ 
AppStateTrackerZZ -
.ZZ- .
CurrentWindowZZ. ;
?ZZ; <
.ZZ< =
NameZZ= A
.ZZA B
TrimZZB F
(ZZF G
)ZZG H
??ZZI K
$strZZL ^
;ZZ^ _
Timeout\\ 
=\\ 
Settings\\ 
.\\ 
Default\\ &
.\\& '#
TimeNotificationVisible\\' >
*\\? @
$num\\A E
;\\E F
if^^ 
(^^ 
Settings^^ 
.^^ 
Default^^  
.^^  !!
PlayNotificationSound^^! 6
)^^6 7
SystemSounds__ 
.__ 
Hand__ !
.__! "
Play__" &
(__& '
)__' (
;__( )
ifaa 
(aa 

focusToastaa 
)aa 
ComboBoxbb 
.bb 
Focusbb 
(bb 
)bb  
;bb  !
DeletedSuggestiondd 
=dd 
falsedd  %
;dd% &$
DeletedSuggestionCounteree $
=ee% &
$numee' (
;ee( )
TextLengthCounterff 
=ff 
ComboBoxff  (
.ff( )
Textff) -
.ff- .
Lengthff. 4
;ff4 5

SetupClosehh 
(hh 
)hh 
;hh 
}ii 	
privateoo 
asyncoo 
voidoo 

SetupCloseoo %
(oo% &
)oo& '
{pp 	
awaitqq 
Taskqq 
.qq 
Delayqq 
(qq 
(qq 
intqq !
)qq! "
Timeoutqq" )
)qq) *
;qq* +
iftt 
(tt 
CancelClosett 
.tt 
Counttt !
(tt! "
)tt" #
==tt$ &
$numtt' (
||tt) +
CancelClosett, 7
.tt7 8
Poptt8 ;
(tt; <
)tt< =
!=tt> @
truettA E
)ttE F
{uu 
SetNewActivityvv 
(vv 
ComboBoxvv '
.vv' (
Textvv( ,
)vv, -
;vv- .
}ww 
}xx 	
private
€€ 
void
€€ 
SetNewActivity
€€ #
(
€€# $
string
€€$ *
name
€€+ /
=
€€0 1
null
€€2 6
,
€€6 7
bool
€€8 <
confirmClicked
€€= K
=
€€L M
false
€€N S
)
€€S T
{
 	
if
‚‚ 
(
‚‚ 
AppStateTracker
‚‚ 
.
‚‚  
CurrentActivity
‚‚  /
==
‚‚0 2
null
‚‚3 7
||
‚‚8 :
!
‚‚; <
ComboBox
‚‚< D
.
‚‚D E
Text
‚‚E I
.
‚‚I J
Equals
‚‚J P
(
‚‚P Q
AppStateTracker
‚‚Q `
.
‚‚` a
CurrentActivity
‚‚a p
.
‚‚p q
Name
‚‚q u
)
‚‚u v
)
‚‚v w
{
ƒƒ 
AppStateTracker
„„ 
.
„„  !
SaveCurrentActivity
„„  3
(
„„3 4
)
„„4 5
;
„„5 6
AppStateTracker
…… 
.
……  #
CreateCurrentActivity
……  5
(
……5 6
name
……6 :
??
……; =
DefaultName
……> I
,
……I J
ToDate
……K Q
)
……Q R
;
……R S
if
‡‡ 
(
‡‡ 
confirmClicked
‡‡ "
)
‡‡" #
AppStateTracker
 #
.
# $
LastConfirmed
$ 1
=
2 3
DateTime
4 <
.
< =
Now
= @
;
@ A
}
‰‰ 
if
 
(
 
this
 
.
 
IsLoaded
 
)
 
this
‹‹ 
.
‹‹ 
Close
‹‹ 
(
‹‹ 
)
‹‹ 
;
‹‹ 
}
 	
private
 
void
 
Window_Activated
 %
(
% &
object
& ,
sender
- 3
,
3 4
	EventArgs
5 >
e
? @
)
@ A
{
‘‘ 	
ComboBox
’’ 
.
’’ !
IsTextSearchEnabled
’’ (
=
’’) *
true
’’+ /
;
’’/ 0
DeletedSuggestion
““ 
=
““ 
false
““  %
;
““% &&
DeletedSuggestionCounter
”” $
=
””% &
$num
””' (
;
””( )
TextLengthCounter
•• 
=
•• 
ComboBox
••  (
.
••( )
Text
••) -
.
••- .
Length
••. 4
;
••4 5
CancelClose
–– 
.
–– 
Push
–– 
(
–– 
true
–– !
)
––! "
;
––" #
}
—— 	
private
™™ 
void
™™  
Window_Deactivated
™™ '
(
™™' (
object
™™( .
sender
™™/ 5
,
™™5 6
	EventArgs
™™7 @
e
™™A B
)
™™B C
{
 	

SetupClose
›› 
(
›› 
)
›› 
;
›› 
}
 	
private
 
void
 
Button_Click
 !
(
! "
object
" (
sender
) /
,
/ 0
RoutedEventArgs
1 @
e
A B
)
B C
{
 	
SetNewActivity
   
(
   
)
   
;
   
}
΅΅ 	
private
££ 
void
££ 
CloseButton_Click
££ &
(
££& '
object
££' -
sender
££. 4
,
££4 5
RoutedEventArgs
££6 E
e
££F G
)
££G H
{
¤¤ 	
SetNewActivity
¥¥ 
(
¥¥ 
)
¥¥ 
;
¥¥ 
}
¦¦ 	
private
¨¨ 
void
¨¨ !
ConfirmButton_Click
¨¨ (
(
¨¨( )
object
¨¨) /
sender
¨¨0 6
,
¨¨6 7
RoutedEventArgs
¨¨8 G
e
¨¨H I
)
¨¨I J
{
©© 	
SetNewActivity
 
(
 
ComboBox
 #
.
# $
Text
$ (
,
( )
true
* .
)
. /
;
/ 0
}
«« 	
private
­­ 
void
­­ 
ComboBox_OnKeyUp
­­ %
(
­­% &
object
­­& ,
sender
­­- 3
,
­­3 4
System
­­5 ;
.
­­; <
Windows
­­< C
.
­­C D
Input
­­D I
.
­­I J
KeyEventArgs
­­J V
e
­­W X
)
­­X Y
{
®® 	
if
―― 
(
―― 
e
―― 
.
―― 
Key
―― 
==
―― 
Key
―― 
.
―― 
Enter
―― "
)
――" #
{
°° 
SetNewActivity
±± 
(
±± 
ComboBox
±± '
.
±±' (
Text
±±( ,
,
±±, -
true
±±. 2
)
±±2 3
;
±±3 4
}
²² 
else
³³ 
if
³³ 
(
³³ 
e
³³ 
.
³³ 
Key
³³ 
==
³³ 
Key
³³ !
.
³³! "
Escape
³³" (
)
³³( )
{
΄΄ 
SetNewActivity
µµ 
(
µµ 
)
µµ  
;
µµ  !
}
¶¶ 
else
¶¶ 
if
¶¶ 
(
¶¶ 
e
¶¶ 
.
¶¶ 
Key
¶¶ 
==
¶¶ 
Key
¶¶ "
.
¶¶" #
Back
¶¶# '
)
¶¶' (
{
·· 
if
ΈΈ 
(
ΈΈ 
!
ΈΈ 
DeletedSuggestion
ΈΈ &
&&
ΈΈ' )
TextLengthCounter
ΈΈ* ;
-
ΈΈ< =
ComboBox
ΈΈ> F
.
ΈΈF G
Text
ΈΈG K
.
ΈΈK L
Length
ΈΈL R
>
ΈΈS T
$num
ΈΈU V
)
ΈΈV W
{
ΉΉ 
DeletedSuggestion
ΊΊ %
=
ΊΊ& '
true
ΊΊ( ,
;
ΊΊ, -
}
»» 
else
ΌΌ 
{
½½ 
if
ΎΎ 
(
ΎΎ 
DeletedSuggestion
ΎΎ )
)
ΎΎ) *
{
ΏΏ &
DeletedSuggestionCounter
ΐΐ 0
++
ΐΐ0 2
;
ΐΐ2 3
}
ΑΑ 
if
ΓΓ 
(
ΓΓ &
DeletedSuggestionCounter
ΓΓ 0
>=
ΓΓ1 3
$num
ΓΓ4 5
)
ΓΓ5 6
{
ΔΔ 
ComboBox
ΕΕ  
.
ΕΕ  !!
IsTextSearchEnabled
ΕΕ! 4
=
ΕΕ5 6
false
ΕΕ7 <
;
ΕΕ< =
}
ΖΖ 
}
ΗΗ 
}
ΘΘ 
else
ΘΘ 
{
ΙΙ 
DeletedSuggestion
ΚΚ !
=
ΚΚ" #
false
ΚΚ$ )
;
ΚΚ) *
}
ΛΛ 
TextLengthCounter
ΜΜ 
=
ΜΜ 
ComboBox
ΜΜ  (
.
ΜΜ( )
Text
ΜΜ) -
.
ΜΜ- .
Length
ΜΜ. 4
;
ΜΜ4 5
}
ΝΝ 	
}
ΞΞ 
}ΟΟ β
MC:\Users\robin\source\repos\WindowsTimeTracker\TimeTracker\MainWindow.xaml.cs
	namespace 	
TimeTracker
 
{ 
public 

partial 
class 

MainWindow #
:$ %
Window& ,
{ 
public 

MainWindow 
( 
) 
{ 	
InitializeComponent 
(  
)  !
;! "
} 	
} 
} 
MC:\Users\robin\source\repos\WindowsTimeTracker\TimeTracker\ManualEdit.xaml.cs
	namespace 	
TimeTracker
 
{ 
public 

partial 
class 

ManualEdit #
:$ %
Window& ,
{ 
private 
List 
< 
Helper 
. 
Activity $
>$ %

Activities& 0
;0 1
private 
StorageHandler 
StorageHandler -
;- .
public   

ManualEdit   
(   
StorageHandler   (
storageHandler  ) 7
)  7 8
{!! 	
InitializeComponent"" 
(""  
)""  !
;""! "
StorageHandler## 
=## 
storageHandler## +
;##+ ,
LoadData$$ 
($$ 
)$$ 
;$$ 
}%% 	
private** 
void** 
LoadData** 
(** 
)** 
{++ 	

Activities,, 
=,, 
StorageHandler,, '
.,,' (
GetLastActivities,,( 9
(,,9 :
),,: ;
;,,; <
DataGrid-- 
.-- 
ItemsSource--  
=--! "

Activities--# -
;--- .
}.. 	
private22 
void22 
Close_Click22  
(22  !
object22! '
sender22( .
,22. /
RoutedEventArgs220 ?
e22@ A
)22A B
{33 	
Close44 
(44 
)44 
;44 
}55 	
private77 
void77 

Save_Click77 
(77  
object77  &
sender77' -
,77- .
RoutedEventArgs77/ >
e77? @
)77@ A
{88 	
StorageHandler99 
.99 
WriteActivities99 *
(99* +

Activities99+ 5
)995 6
;996 7
LoadData:: 
(:: 
):: 
;:: 
};; 	
}<< 
}== Γ
MC:\Users\robin\source\repos\WindowsTimeTracker\TimeTracker\NewVersion.xaml.cs
	namespace 	
TimeTracker
 
{ 
public 

partial 
class 

NewVersion #
:$ %
Window& ,
{ 
public 

NewVersion 
( 
) 
{ 	
InitializeComponent 
(  
)  !
;! "
} 	
private"" 
void"" %
Hyperlink_RequestNavigate"" .
("". /
object""/ 5
sender""6 <
,""< =$
RequestNavigateEventArgs""> V
e""W X
)""X Y
{## 	
Process$$ 
.$$ 
Start$$ 
($$ 
new$$ 
ProcessStartInfo$$ .
($$. /
e$$/ 0
.$$0 1
Uri$$1 4
.$$4 5
AbsoluteUri$$5 @
)$$@ A
)$$A B
;$$B C
e%% 
.%% 
Handled%% 
=%% 
true%% 
;%% 
}&& 	
}'' 
}((  
KC:\Users\robin\source\repos\WindowsTimeTracker\TimeTracker\Tutorial.xaml.cs
	namespace 	
TimeTracker
 
{ 
public 

partial 
class 
Tutorial !
:" #
Window$ *
{ 
public 
int 
Position 
= 
$num 
;  
public 
string 
[ 
] 
Images 
=  
{! "
$str" -
,- .
$str/ :
,; <
$str= H
,I J
$strK V
}W X
;X Y
public 
string 
[ 
] 
Text 
= 
{  
$str! V
,V W
$str	X ά
,
ά έ
$str
ή κ
,
κ λ
$str
μ ξ
,
ξ ο
$str
π ς
}
σ τ
;
τ υ
public 
Tutorial 
( 
) 
{ 	
InitializeComponent 
(  
)  !
;! "
	DrawImage 
( 
) 
; 
} 	
private 
void 
	DrawImage 
( 
)  
{   	
Uri!! 
	uriSource!! 
=!! 
new!! 
Uri!!  #
(!!# $
$str!!$ 0
+!!1 2
Images!!3 9
[!!9 :
Position!!: B
]!!B C
,!!C D
UriKind!!E L
.!!L M
Relative!!M U
)!!U V
;!!V W
Image## 
.## 
Source## 
=## 
new## 
BitmapImage## *
(##* +
	uriSource##+ 4
)##4 5
;##5 6
	TextBlock$$ 
.$$ 
Text$$ 
=$$ 
Text$$ !
[$$! "
Position$$" *
]$$* +
;$$+ ,
}%% 	
private'' 
void'' 
Button_Click'' !
(''! "
object''" (
sender'') /
,''/ 0
RoutedEventArgs''1 @
e''A B
)''B C
{(( 	
Position)) 
=)) 
Math)) 
.)) 
Max)) 
())  
Position))  (
-))) *
$num))+ ,
,)), -
$num)). /
)))/ 0
;))0 1
Next++ 
.++ 
Content++ 
=++ 
$str++ !
;++! "
if,, 
(,, 
Position,, 
==,, 
$num,, 
),, 
Previous-- 
.-- 
	IsEnabled-- "
=--# $
false--% *
;--* +
	DrawImage// 
(// 
)// 
;// 
}00 	
private22 
void22 
Button_Click_122 #
(22# $
object22$ *
sender22+ 1
,221 2
RoutedEventArgs223 B
e22C D
)22D E
{33 	
if44 
(44 
Position44 
==44 
Images44 "
.44" #
Length44# )
-44* +
$num44, -
)44- .
{55 
this66 
.66 
Close66 
(66 
)66 
;66 
return77 
;77 
}88 
Position:: 
=:: 
Math:: 
.:: 
Min:: 
(::  
Position::  (
+::) *
$num::+ ,
,::, -
Images::. 4
.::4 5
Length::5 ;
-::< =
$num::> ?
)::? @
;::@ A
Previous<< 
.<< 
	IsEnabled<< 
=<<  
true<<! %
;<<% &
if== 
(== 
Position== 
==== 
Images== "
.==" #
Length==# )
-==* +
$num==, -
)==- .
Next>> 
.>> 
Content>> 
=>> 
$str>> &
;>>& '
	DrawImage@@ 
(@@ 
)@@ 
;@@ 
}AA 	
}BB 
}CC 
SC:\Users\robin\source\repos\WindowsTimeTracker\TimeTracker\Helper\Storage\Window.cs
	namespace		 	
TimeTracker		
 
.		 
Helper		 
{

 
public 

class 
Window 
{ 
public 
string 
Name 
{ 
get  
;  !
set" %
;% &
}' (
public 
string 
Details 
{ 
get  #
;# $
set% (
;( )
}* +
public 
DateTime 
From 
{ 
get "
;" #
set$ '
;' (
}) *
public 
DateTime 
? 
To 
{ 
get !
;! "
set# &
;& '
}( )
} 
} ƒ£
FC:\Users\robin\source\repos\WindowsTimeTracker\TimeTracker\App.xaml.cs
	namespace 	
TimeTracker
 
{ 
public 

partial 
class 
App 
: 
System %
.% &
Windows& -
.- .
Application. 9
{ 
private!! 
System!! 
.!! 
Windows!! 
.!! 
Forms!! $
.!!$ %

NotifyIcon!!% /

NotifyIcon!!0 :
;!!: ;
private"" 
StorageHandler"" 
StorageHandler"" -
;""- .
private## 
AppStateTracker## 
AppStateTracker##  /
;##/ 0
private$$ !
ProgramSwitchListener$$ %!
ProgramSwitchListener$$& ;
;$$; <
private%%  
MachineStateListener%% $ 
MachineStateListener%%% 9
;%%9 :
private&& 
HotkeyListener&& 
HotkeyListener&& -
;&&- .
private'' 
ASDL'' 
ASDL'' 
;'' 
private)) 
Mutex)) 
_instanceMutex)) $
=))% &
null))' +
;))+ ,
	protected00 
override00 
void00 
	OnStartup00  )
(00) *
StartupEventArgs00* :
e00; <
)00< =
{11 	
bool22 

createdNew22 
;22 
_instanceMutex33 
=33 
new33  
Mutex33! &
(33& '
true33' +
,33+ ,
$str33- S
,33S T
out33U X

createdNew33Y c
)33c d
;33d e
if44 
(44 
!44 

createdNew44 
)44 
{55 
_instanceMutex66 
=66  
null66! %
;66% &
System77 
.77 
Windows77 
.77 
Application77 *
.77* +
Current77+ 2
.772 3
Shutdown773 ;
(77; <
)77< =
;77= >
return88 
;88 
}99 
base<< 
.<< 
	OnStartup<< 
(<< 
e<< 
)<< 
;<< 

MainWindow?? 
=?? 
new?? 

MainWindow?? '
(??' (
)??( )
;??) *

NotifyIconBB 
=BB 
newBB 
SystemBB #
.BB# $
WindowsBB$ +
.BB+ ,
FormsBB, 1
.BB1 2

NotifyIconBB2 <
(BB< =
)BB= >
;BB> ?

NotifyIconCC 
.CC 
IconCC 
=CC 
newCC !
IconCC" &
(CC& '
TimeTrackerCC' 2
.CC2 3

PropertiesCC3 =
.CC= >
	ResourcesCC> G
.CCG H
iconCCH L
,CCL M
SystemInformationCCN _
.CC_ `
SmallIconSizeCC` m
)CCm n
;CCn o

NotifyIconDD 
.DD 
VisibleDD 
=DD  
trueDD! %
;DD% &
CreateContextMenuEE 
(EE 
)EE 
;EE  
StorageHandlerHH 
=HH 
newHH  
StorageHandlerHH! /
(HH/ 0
)HH0 1
;HH1 2
AppStateTrackerII 
=II 
newII !
AppStateTrackerII" 1
(II1 2
StorageHandlerII2 @
)II@ A
;IIA B!
ProgramSwitchListenerJJ !
=JJ" #
newJJ$ '!
ProgramSwitchListenerJJ( =
(JJ= >
)JJ> ?
;JJ? @ 
MachineStateListenerKK  
=KK! "
newKK# & 
MachineStateListenerKK' ;
(KK; <
)KK< =
;KK= >
HotkeyListenerLL 
=LL 
newLL  
HotkeyListenerLL! /
(LL/ 0
)LL0 1
;LL1 2
ASDLMM 
=MM 
newMM 
ASDLMM 
(MM 
AppStateTrackerMM +
,MM+ ,!
ProgramSwitchListenerMM- B
,MMB C 
MachineStateListenerMMD X
,MMX Y
HotkeyListenerMMZ h
)MMh i
;MMi j

NotifyIconPP 
.PP 
DoubleClickPP "
+=PP# %
(PP& '
sPP' (
,PP( )
argsPP* .
)PP. /
=>PP0 2
ASDLPP3 7
.PP7 8
ChangeActivityPP8 F
(PPF G
)PPG H
;PPH I 
MachineStateListenerQQ  
.QQ  !
StateChangedQQ! -
+=QQ. 0
ListenerEventQQ1 >
;QQ> ?
AppStateTrackerRR 
.RR 
ChangeContextMenuRR -
+=RR. 0
(RR1 2
sRR2 3
,RR3 4
argsRR5 9
)RR9 :
=>RR; =

NotifyIconRR> H
.RRH I
ContextMenuStripRRI Y
.RRY Z
ItemsRRZ _
[RR_ `
$numRR` a
]RRa b
.RRb c
TextRRc g
=RRh i
(RRj k
(RRk l
boolRRl p
)RRp q
argsRRq u
.RRu v
ValueRRv {
)RR{ |
?RR} ~
$str	RR 
:
RR‰ 
$str
RR‹ ’
;
RR’ “
ASDLSS 
.SS 
ShowActivityDialogSS #
+=SS$ & 
CreateActivityDialogSS' ;
;SS; <
ASDLTT 
.TT  
ShowAwayFromPCDialogTT %
+=TT& ("
CreateAwayFromPCDialogTT) ?
;TT? @ 
ShowTutorialIfNeededVV  
(VV  !
)VV! "
;VV" #
CheckForUpdatesXX 
(XX 
)XX 
;XX 
}YY 	
	protected^^ 
override^^ 
void^^ 
OnExit^^  &
(^^& '
ExitEventArgs^^' 4
e^^5 6
)^^6 7
{__ 	
if`` 
(`` 
_instanceMutex`` 
!=`` !
null``" &
)``& '
_instanceMutexaa 
.aa 
ReleaseMutexaa +
(aa+ ,
)aa, -
;aa- .
basebb 
.bb 
OnExitbb 
(bb 
ebb 
)bb 
;bb 
}cc 	
privatehh 
voidhh  
ShowTutorialIfNeededhh )
(hh) *
)hh* +
{ii 	
ifkk 
(kk 
!kk 
Settingskk 
.kk 
Defaultkk !
.kk! "
TutorialViewedkk" 0
)kk0 1
{ll 
newmm 
Tutorialmm 
(mm 
)mm 
.mm 
Showmm #
(mm# $
)mm$ %
;mm% &
Settingsnn 
.nn 
Defaultnn  
.nn  !
TutorialViewednn! /
=nn0 1
truenn2 6
;nn6 7
Settingsoo 
.oo 
Defaultoo  
.oo  !
Saveoo! %
(oo% &
)oo& '
;oo' (
}pp 
}qq 	
privatevv 
voidvv 
CheckForUpdatesvv $
(vv$ %
)vv% &
{ww 	
tryxx 
{yy 
stringzz 
Urlzz 
=zz 
$strzz _
;zz_ `
string{{ 
XmlStr{{ 
;{{ 
using}} 
(}} 
var}} 
wc}} 
=}} 
new}}  #
	WebClient}}$ -
(}}- .
)}}. /
)}}/ 0
{~~ 
XmlStr 
= 
wc 
.  
DownloadString  .
(. /
Url/ 2
)2 3
;3 4
}
€€ 
System
‚‚ 
.
‚‚ 
Xml
‚‚ 
.
‚‚ 
XmlDocument
‚‚ &
XmlDoc
‚‚' -
=
‚‚. /
new
‚‚0 3
System
‚‚4 :
.
‚‚: ;
Xml
‚‚; >
.
‚‚> ?
XmlDocument
‚‚? J
(
‚‚J K
)
‚‚K L
;
‚‚L M
XmlDoc
ƒƒ 
.
ƒƒ 
LoadXml
ƒƒ 
(
ƒƒ 
XmlStr
ƒƒ %
)
ƒƒ% &
;
ƒƒ& '
XmlNode
…… 
Root
…… 
=
…… 
XmlDoc
…… %
.
……% &
DocumentElement
……& 5
;
……5 6!
XmlNamespaceManager
 #
Nsmgr
$ )
=
* +
new
, /!
XmlNamespaceManager
0 C
(
C D
XmlDoc
D J
.
J K
	NameTable
K T
)
T U
;
U V
Nsmgr
‰‰ 
.
‰‰ 
AddNamespace
‰‰ "
(
‰‰" #
$str
‰‰# &
,
‰‰& '
$str
‰‰( E
)
‰‰E F
;
‰‰F G
XmlNode
‹‹ 
Node
‹‹ 
=
‹‹ 
Root
‹‹ #
.
‹‹# $
SelectSingleNode
‹‹$ 4
(
‹‹4 5
$str
‹‹5 J
,
‹‹J K
Nsmgr
‹‹L Q
)
‹‹Q R
;
‹‹R S
if
 
(
 
!
 
Node
 
.
 

FirstChild
 $
.
$ %
InnerXml
% -
.
- .
Equals
. 4
(
4 5
$str
5 `
+
a b
AppStateTracker
c r
.
r s
Version
s z
)
z {
)
{ |
{
 
new
 

NewVersion
 "
(
" #
)
# $
.
$ %
Show
% )
(
) *
)
* +
;
+ ,
}
‘‘ 
}
’’ 
catch
““ 
(
““ 
WebException
““ 
ignore
““  &
)
““& '
{
”” 
}
–– 
}
—— 	
private
 
void
 
DoNotDisturb
 !
(
! "
)
" #
{
 	
if
 
(
 
AppStateTracker
 
.
  
Disturb
  '
)
' (
{
   

NotifyIcon
΅΅ 
.
΅΅ 
ContextMenuStrip
΅΅ +
.
΅΅+ ,
Items
΅΅, 1
[
΅΅1 2
$num
΅΅2 3
]
΅΅3 4
.
΅΅4 5
Text
΅΅5 9
=
΅΅: ;
$str
΅΅< X
;
΅΅X Y
AppStateTracker
ΆΆ 
.
ΆΆ  
Disturb
ΆΆ  '
=
ΆΆ( )
false
ΆΆ* /
;
ΆΆ/ 0
}
££ 
else
¤¤ 
{
¥¥ 

NotifyIcon
¦¦ 
.
¦¦ 
ContextMenuStrip
¦¦ +
.
¦¦+ ,
Items
¦¦, 1
[
¦¦1 2
$num
¦¦2 3
]
¦¦3 4
.
¦¦4 5
Text
¦¦5 9
=
¦¦: ;
$str
¦¦< L
;
¦¦L M
AppStateTracker
§§ 
.
§§  
Disturb
§§  '
=
§§( )
true
§§* .
;
§§. /
}
¨¨ 
}
©© 	
private
®® 
void
®® 
CreateContextMenu
®® &
(
®®& '
)
®®' (
{
―― 	

NotifyIcon
°° 
.
°° 
ContextMenuStrip
°° '
=
°°( )
new
°°* -
System
°°. 4
.
°°4 5
Windows
°°5 <
.
°°< =
Forms
°°= B
.
°°B C
ContextMenuStrip
°°C S
(
°°S T
)
°°T U
;
°°U V

NotifyIcon
±± 
.
±± 
ContextMenuStrip
±± '
.
±±' (
Items
±±( -
.
±±- .
Add
±±. 1
(
±±1 2
$str
±±2 8
)
±±8 9
.
±±9 :
Click
±±: ?
+=
±±@ B
(
±±C D
s
±±D E
,
±±E F
e
±±G H
)
±±H I
=>
±±J L
new
±±M P
HTMLDataWindow
±±Q _
(
±±_ `
StorageHandler
±±` n
,
±±n o
AppStateTracker
±±p 
)±± €
.±±€ 
Show±± …
(±±… †
)±±† ‡
;±±‡ 

NotifyIcon
²² 
.
²² 
ContextMenuStrip
²² '
.
²²' (
Items
²²( -
.
²²- .
Add
²². 1
(
²²1 2
$str
²²2 C
)
²²C D
.
²²D E
Click
²²E J
+=
²²K M
(
²²N O
s
²²O P
,
²²P Q
e
²²R S
)
²²S T
=>
²²U W
ASDL
²²X \
.
²²\ ]
ChangeActivity
²²] k
(
²²k l
)
²²l m
;
²²m n

NotifyIcon
³³ 
.
³³ 
ContextMenuStrip
³³ '
.
³³' (
Items
³³( -
.
³³- .
Add
³³. 1
(
³³1 2
$str
³³2 9
)
³³9 :
.
³³: ;
Click
³³; @
+=
³³A C
(
³³D E
s
³³E F
,
³³F G
e
³³H I
)
³³I J
=>
³³K M
AppStateTracker
³³N ]
.
³³] ^
Pause
³³^ c
(
³³c d
null
³³d h
)
³³h i
;
³³i j

NotifyIcon
΄΄ 
.
΄΄ 
ContextMenuStrip
΄΄ '
.
΄΄' (
Items
΄΄( -
.
΄΄- .
Add
΄΄. 1
(
΄΄1 2
$str
΄΄2 B
)
΄΄B C
.
΄΄C D
Click
΄΄D I
+=
΄΄J L
(
΄΄M N
s
΄΄N O
,
΄΄O P
e
΄΄Q R
)
΄΄R S
=>
΄΄T V
DoNotDisturb
΄΄W c
(
΄΄c d
)
΄΄d e
;
΄΄e f

NotifyIcon
µµ 
.
µµ 
ContextMenuStrip
µµ '
.
µµ' (
Items
µµ( -
.
µµ- .
Add
µµ. 1
(
µµ1 2
$str
µµ2 C
)
µµC D
.
µµD E
Click
µµE J
+=
µµK M
(
µµN O
s
µµO P
,
µµP Q
e
µµR S
)
µµS T
=>
µµU W
new
µµX [

ManualEdit
µµ\ f
(
µµf g
StorageHandler
µµg u
)
µµu v
.
µµv w
Show
µµw {
(
µµ{ |
)
µµ| }
;
µµ} ~

NotifyIcon
¶¶ 
.
¶¶ 
ContextMenuStrip
¶¶ '
.
¶¶' (
Items
¶¶( -
.
¶¶- .
Add
¶¶. 1
(
¶¶1 2
$str
¶¶2 8
)
¶¶8 9
.
¶¶9 :
Click
¶¶: ?
+=
¶¶@ B
(
¶¶C D
s
¶¶D E
,
¶¶E F
e
¶¶G H
)
¶¶H I
=>
¶¶J L
ExitApplication
¶¶M \
(
¶¶\ ]
)
¶¶] ^
;
¶¶^ _
ToolStripItem
ΈΈ 
Item
ΈΈ 
=
ΈΈ  

NotifyIcon
ΈΈ! +
.
ΈΈ+ ,
ContextMenuStrip
ΈΈ, <
.
ΈΈ< =
Items
ΈΈ= B
[
ΈΈB C
$num
ΈΈC D
]
ΈΈD E
;
ΈΈE F
Item
ΉΉ 
.
ΉΉ 
Font
ΉΉ 
=
ΉΉ 
new
ΉΉ 
Font
ΉΉ  
(
ΉΉ  !
Item
ΉΉ! %
.
ΉΉ% &
Font
ΉΉ& *
,
ΉΉ* +
System
ΉΉ, 2
.
ΉΉ2 3
Drawing
ΉΉ3 :
.
ΉΉ: ;
	FontStyle
ΉΉ; D
.
ΉΉD E
Bold
ΉΉE I
)
ΉΉI J
;
ΉΉJ K
}
ΊΊ 	
private
ΏΏ 
void
ΏΏ 
ExitApplication
ΏΏ $
(
ΏΏ$ %
)
ΏΏ% &
{
ΐΐ 	

MainWindow
ΑΑ 
.
ΑΑ 
Close
ΑΑ 
(
ΑΑ 
)
ΑΑ 
;
ΑΑ 

NotifyIcon
ΒΒ 
.
ΒΒ 
Dispose
ΒΒ 
(
ΒΒ 
)
ΒΒ  
;
ΒΒ  !

NotifyIcon
ΓΓ 
=
ΓΓ 
null
ΓΓ 
;
ΓΓ 
HotkeyListener
ΔΔ 
.
ΔΔ 
Dispose
ΔΔ "
(
ΔΔ" #
)
ΔΔ# $
;
ΔΔ$ %
HotkeyListener
ΕΕ 
=
ΕΕ 
null
ΕΕ !
;
ΕΕ! "
Shutdown
ΖΖ 
(
ΖΖ 
$num
ΖΖ 
)
ΖΖ 
;
ΖΖ 
}
ΗΗ 	
private
ΠΠ 
void
ΠΠ 
Application_Exit
ΠΠ %
(
ΠΠ% &
object
ΠΠ& ,
sender
ΠΠ- 3
,
ΠΠ3 4
ExitEventArgs
ΠΠ5 B
e
ΠΠC D
)
ΠΠD E
{
ΡΡ 	
if
 
(
 
AppStateTracker
 
!=
  "
null
# '
)
' (
{
ΣΣ 
AppStateTracker
ΤΤ 
.
ΤΤ  
SaveCurrentWindow
ΤΤ  1
(
ΤΤ1 2
)
ΤΤ2 3
;
ΤΤ3 4
AppStateTracker
ΥΥ 
.
ΥΥ  !
SaveCurrentActivity
ΥΥ  3
(
ΥΥ3 4
)
ΥΥ4 5
;
ΥΥ5 6
}
ΦΦ 
}
ΧΧ 	
private
ίί 
bool
ίί 
CloseAllToasts
ίί #
(
ίί# $
)
ίί$ %
{
ΰΰ 	
bool
αα "
ToastAlreadySelected
αα %
=
αα& '
false
αα( -
;
αα- .
for
ββ 
(
ββ 
int
ββ 

intCounter
ββ 
=
ββ  !
App
ββ" %
.
ββ% &
Current
ββ& -
.
ββ- .
Windows
ββ. 5
.
ββ5 6
Count
ββ6 ;
-
ββ< =
$num
ββ> ?
;
ββ? @

intCounter
ββA K
>
ββL M
$num
ββN O
;
ββO P

intCounter
ββQ [
--
ββ[ ]
)
ββ] ^
if
γγ 
(
γγ 
App
γγ 
.
γγ 
Current
γγ 
.
γγ  
Windows
γγ  '
[
γγ' (

intCounter
γγ( 2
]
γγ2 3
.
γγ3 4
GetType
γγ4 ;
(
γγ; <
)
γγ< =
.
γγ= >
Name
γγ> B
.
γγB C
Equals
γγC I
(
γγI J
$str
γγJ Z
)
γγZ [
)
γγ[ \
if
δδ 
(
δδ 
App
δδ 
.
δδ 
Current
δδ #
.
δδ# $
Windows
δδ$ +
[
δδ+ ,

intCounter
δδ, 6
]
δδ6 7
.
δδ7 8
IsActive
δδ8 @
)
δδ@ A"
ToastAlreadySelected
εε ,
=
εε- .
true
εε/ 3
;
εε3 4
else
ζζ 
App
ηη 
.
ηη 
Current
ηη #
.
ηη# $
Windows
ηη$ +
[
ηη+ ,

intCounter
ηη, 6
]
ηη6 7
.
ηη7 8
Close
ηη8 =
(
ηη= >
)
ηη> ?
;
ηη? @
return
ιι "
ToastAlreadySelected
ιι '
;
ιι' (
}
κκ 	
private
ρρ 
void
ρρ "
CreateActivityDialog
ρρ )
(
ρρ) *
object
ρρ* 0
sender
ρρ1 7
,
ρρ7 8
CustomEventArgs
ρρ9 H
e
ρρI J
)
ρρJ K
{
ςς 	
try
σσ 
{
ττ 
if
υυ 
(
υυ 
!
υυ 
CloseAllToasts
υυ #
(
υυ# $
)
υυ$ %
)
υυ% &
{
φφ 
ActivityDialog
χχ "
newToast
χχ# +
=
χχ, -
new
χχ. 1
ActivityDialog
χχ2 @
(
χχ@ A
StorageHandler
χχA O
,
χχO P
AppStateTracker
χχQ `
,
χχ` a
(
χχb c
bool
χχc g
)
χχg h
e
χχh i
.
χχi j
Value
χχj o
)
χχo p
;
χχp q
newToast
ψψ 
.
ψψ 
Show
ψψ !
(
ψψ! "
)
ψψ" #
;
ψψ# $
if
ωω 
(
ωω 
(
ωω 
bool
ωω 
)
ωω 
e
ωω 
.
ωω  
Value
ωω  %
)
ωω% &
newToast
ϊϊ  
.
ϊϊ  !
Activate
ϊϊ! )
(
ϊϊ) *
)
ϊϊ* +
;
ϊϊ+ ,
}
ϋϋ 
}
όό 
catch
όό 
(
όό 
	Exception
όό 
ignore
όό %
)
όό% &
{
ύύ 
}
 
}
€€ 	
private
‡‡ 
void
‡‡ $
CreateAwayFromPCDialog
‡‡ +
(
‡‡+ ,
object
‡‡, 2
sender
‡‡3 9
,
‡‡9 :
CustomEventArgs
‡‡; J
e
‡‡K L
)
‡‡L M
{
 	
new
‰‰ 
AwayFromPCDialog
‰‰  
(
‰‰  !
StorageHandler
‰‰! /
,
‰‰/ 0
AppStateTracker
‰‰1 @
,
‰‰@ A
(
‰‰B C
DateTime
‰‰C K
)
‰‰K L
e
‰‰L M
.
‰‰M N
Value
‰‰N S
)
‰‰S T
.
‰‰T U
Show
‰‰U Y
(
‰‰Y Z
)
‰‰Z [
;
‰‰[ \
}
 	
private
’’ 
void
’’ 
ListenerEvent
’’ "
(
’’" #
object
’’# )
sender
’’* 0
,
’’0 1
CustomEventArgs
’’2 A
e
’’B C
)
’’C D
{
““ 	
if
”” 
(
”” 
(
”” 
bool
”” 
)
”” 
e
”” 
.
”” 
Value
”” 
)
”” 
{
•• 
HotkeyListener
–– 
?
–– 
.
––  
Dispose
––  '
(
––' (
)
––( )
;
––) *
HotkeyListener
—— 
=
——  
new
——! $
HotkeyListener
——% 3
(
——3 4
)
——4 5
;
——5 6
ASDL
™™ 
.
™™ $
ReattachHotkeyListener
™™ +
(
™™+ ,
HotkeyListener
™™, :
)
™™: ;
;
™™; <
}
 
}
›› 	
}
 
} 
UC:\Users\robin\source\repos\WindowsTimeTracker\TimeTracker\Properties\AssemblyInfo.cs
[

 
assembly

 	
:

	 

AssemblyTitle

 
(

 
$str

 &
)

& '
]

' (
[ 
assembly 	
:	 

AssemblyDescription 
( 
$str !
)! "
]" #
[ 
assembly 	
:	 
!
AssemblyConfiguration  
(  !
$str! #
)# $
]$ %
[ 
assembly 	
:	 

AssemblyCompany 
( 
$str 
) 
] 
[ 
assembly 	
:	 

AssemblyProduct 
( 
$str (
)( )
]) *
[ 
assembly 	
:	 

AssemblyCopyright 
( 
$str 0
)0 1
]1 2
[ 
assembly 	
:	 

AssemblyTrademark 
( 
$str 
)  
]  !
[ 
assembly 	
:	 

AssemblyCulture 
( 
$str 
) 
] 
[ 
assembly 	
:	 


ComVisible 
( 
false 
) 
] 
["" 
assembly"" 	
:""	 

	ThemeInfo"" 
("" &
ResourceDictionaryLocation## 
.## 
None## #
,### $&
ResourceDictionaryLocation&& 
.&& 
SourceAssembly&& -
))) 
])) 
[66 
assembly66 	
:66	 

AssemblyVersion66 
(66 
$str66 $
)66$ %
]66% &
[77 
assembly77 	
:77	 

AssemblyFileVersion77 
(77 
$str77 (
)77( )
]77) *